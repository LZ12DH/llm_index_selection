[
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0009726320215153222,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004855591614108275
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0019495281191261303,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0004928198880204127
        ],
        "Hash Join": [
          0.004855591614108275
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.001944722187177517,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.005414676303684804,
          0.004850904487497975
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_current_price",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0037261132987698865,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          4.901960784309267e-05
        ],
        "Sort": [
          "[9.0000e-02 2.6000e-01 4.2000e-01 5.8000e-01 7.5000e-01 9.1000e-01\n 1.0700e+00 1.2400e+00 1.4000e+00 1.5600e+00 1.7200e+00 1.8800e+00\n 2.0400e+00 2.2100e+00 2.3800e+00 2.5400e+00 2.7100e+00 2.8700e+00\n 3.0300e+00 3.1900e+00 3.3600e+00 3.5300e+00 3.7000e+00 3.8600e+00\n 4.0200e+00 4.1800e+00 4.3500e+00 4.5100e+00 4.6800e+00 4.8400e+00\n 5.0200e+00 5.3500e+00 5.6900e+00 6.0300e+00 6.3600e+00 6.6900e+00\n 7.0200e+00 7.3500e+00 7.6800e+00 8.0200e+00 8.3400e+00 8.6700e+00\n 9.0020e+00 9.3500e+00 9.6800e+00 1.1150e+01 2.8720e+01 4.6052e+01\n 6.3996e+01 8.2158e+01 9.9990e+01]"
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_manufact_id",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0037261132987698865,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          4.901960784309267e-05
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_item_id",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_manufact",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0037261132987698865,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          4.901960784309267e-05
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "item.i_item_desc",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "catalog_sales.cs_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0009726366026086708,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004850904487497975
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "inventory.inv_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0009726320215153222,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004855591614108275
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "inventory.inv_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0009720855845688462,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.005414676303684804
        ]
      }
    }
  },
  {
    "query": "select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 62 and 62 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2002-02-08' as date) and (cast('2002-02-08' as date) +  interval '60 days')\n and i_manufact_id in (970,978,864,711)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n limit 100;\n\n-- end query 24 in stream 0 using template query37.tpl\n",
    "indexes": "inventory.inv_quantity_on_hand",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 2096981.95,
      "Total Cost": 2096988.56,
      "Plan Rows": 12,
      "Plan Width": 125,
      "Plans": [
        {
          "Node Type": "Group",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 2096981.95,
          "Total Cost": 2096988.56,
          "Plan Rows": 12,
          "Plan Width": 125,
          "Group Key": [
            "item.i_item_id",
            "item.i_item_desc",
            "item.i_current_price"
          ],
          "Plans": [
            {
              "Node Type": "Gather Merge",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 2096981.95,
              "Total Cost": 2096988.38,
              "Plan Rows": 24,
              "Plan Width": 125,
              "Workers Planned": 2,
              "Plans": [
                {
                  "Node Type": "Group",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2095981.93,
                  "Total Cost": 2095985.59,
                  "Plan Rows": 12,
                  "Plan Width": 125,
                  "Group Key": [
                    "item.i_item_id",
                    "item.i_item_desc",
                    "item.i_current_price"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Sort",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 2095981.93,
                      "Total Cost": 2095982.85,
                      "Plan Rows": 366,
                      "Plan Width": 125,
                      "Sort Key": [
                        "item.i_item_id",
                        "item.i_item_desc",
                        "item.i_current_price"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": true,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 1639762.26,
                          "Total Cost": 2095966.35,
                          "Plan Rows": 366,
                          "Plan Width": 125,
                          "Inner Unique": false,
                          "Hash Cond": "(item.i_item_sk = inventory.inv_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 7814.06,
                              "Total Cost": 464007.23,
                              "Plan Rows": 706,
                              "Plan Width": 133,
                              "Inner Unique": false,
                              "Hash Cond": "(catalog_sales.cs_item_sk = item.i_item_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "catalog_sales",
                                  "Alias": "catalog_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 433688.25,
                                  "Plan Rows": 6000525,
                                  "Plan Width": 4,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 7814.0,
                                  "Total Cost": 7814.0,
                                  "Plan Rows": 5,
                                  "Plan Width": 129,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "item",
                                      "Alias": "item",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 7814.0,
                                      "Plan Rows": 5,
                                      "Plan Width": 129,
                                      "Filter": "((i_current_price >= '62'::numeric) AND (i_current_price <= '92'::numeric) AND (i_manufact_id = ANY ('{970,978,864,711}'::integer[])))",
                                      "parent": 8,
                                      "ID": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Startup Cost": 1631727.17,
                              "Total Cost": 1631727.17,
                              "Plan Rows": 17682,
                              "Plan Width": 4,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 2050.0,
                                  "Total Cost": 1631727.17,
                                  "Plan Rows": 17682,
                                  "Plan Width": 4,
                                  "Inner Unique": false,
                                  "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "inventory",
                                      "Alias": "inventory",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 1551452.05,
                                      "Plan Rows": 20832653,
                                      "Plan Width": 8,
                                      "Filter": "((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))",
                                      "parent": 11,
                                      "ID": 12
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 2049.55,
                                      "Total Cost": 2049.55,
                                      "Plan Rows": 36,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "date_dim",
                                          "Alias": "date_dim",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 2049.55,
                                          "Plan Rows": 36,
                                          "Plan Width": 4,
                                          "Filter": "((d_date >= '2002-02-08'::date) AND (d_date <= '2002-04-09 00:00:00'::timestamp without time zone))",
                                          "parent": 13,
                                          "ID": 14
                                        }
                                      ],
                                      "parent": 11,
                                      "ID": 13,
                                      "left": 14
                                    }
                                  ],
                                  "parent": 10,
                                  "ID": 11,
                                  "left": 12,
                                  "right": 13
                                }
                              ],
                              "parent": 5,
                              "ID": 10,
                              "left": 11
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 10
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.6240562759185609,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Group",
          "Gather Merge"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Group",
          "Gather Merge"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.15650704680339567
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0027015241376563684,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0029158510041205066
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "item.i_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.011103491017578212,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0031311214554257476
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "item.i_class",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]",
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "item.i_category",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]",
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store.s_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.010060940741059834,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09673104631994725
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store.s_state",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 4.814414419358953e-07,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.9509803921568627
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.011085882491374412,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004712010901980336
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store_sales.ss_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.011103491017578212,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0031311214554257476
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store_sales.ss_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.010060940741059834,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09673104631994725
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store_sales.ss_ext_sales_price",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0.0000000e+00 8.4400000e+00 2.4240000e+01 4.1420000e+01 6.0240000e+01\n 8.0840000e+01 1.0340000e+02 1.2826000e+02 1.5540000e+02 1.8480000e+02\n 2.1648000e+02 2.5050000e+02 2.8692000e+02 3.2589000e+02 3.6750000e+02\n 4.1178000e+02 4.5907000e+02 5.0928000e+02 5.6253000e+02 6.1920000e+02\n 6.7925000e+02 7.4292000e+02 8.1069000e+02 8.8260000e+02 9.5897000e+02\n 1.0400000e+03 1.1262500e+03 1.2175800e+03 1.3154400e+03 1.4196000e+03\n 1.5306600e+03 1.6495800e+03 1.7771100e+03 1.9142200e+03 2.0608500e+03\n 2.2194200e+03 2.3910800e+03 2.5773300e+03 2.7802400e+03 3.0025600e+03\n 3.2476800e+03 3.5208900e+03 3.8278800e+03 4.1760500e+03 4.5770000e+03\n 5.0488000e+03 5.6174592e+03 6.3379500e+03 7.3200000e+03 8.8974900e+03\n 1.9562400e+04]"
        ]
      }
    }
  },
  {
    "query": "select  \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('TN','TN','TN','TN',\n                 'TN','TN','TN','TN')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when grouping(i_category)+grouping(i_class) = 0 then i_category end\n  ,rank_within_parent\n  limit 100;\n\n-- end query 23 in stream 3 using template query36.tpl\n",
    "indexes": "store_sales.ss_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 716801.44,
      "Total Cost": 716801.69,
      "Plan Rows": 100,
      "Plan Width": 210,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 716801.44,
          "Total Cost": 716803.94,
          "Plan Rows": 1001,
          "Plan Width": 210,
          "Sort Key": [
            "((GROUPING(item.i_category) + GROUPING(item.i_class))) DESC",
            "(CASE WHEN (((GROUPING(item.i_category) + GROUPING(item.i_class))) = 0) THEN item.i_category ELSE NULL::bpchar END)",
            "(rank() OVER (?))"
          ],
          "Plans": [
            {
              "Node Type": "WindowAgg",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 716715.64,
              "Total Cost": 716763.18,
              "Plan Rows": 1001,
              "Plan Width": 210,
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 716715.64,
                  "Total Cost": 716718.14,
                  "Plan Rows": 1001,
                  "Plan Width": 178,
                  "Sort Key": [
                    "((GROUPING(item.i_category) + GROUPING(item.i_class)))",
                    "(CASE WHEN (GROUPING(item.i_class) = 0) THEN item.i_category ELSE NULL::bpchar END)",
                    "((sum(store_sales.ss_net_profit) / sum(store_sales.ss_ext_sales_price)))"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Mixed",
                      "Partial Mode": "Simple",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 13906.04,
                      "Total Cost": 716665.75,
                      "Plan Rows": 1001,
                      "Plan Width": 178,
                      "Grouping Sets": [
                        {
                          "Hash Keys": [
                            [
                              "item.i_category",
                              "item.i_class"
                            ]
                          ]
                        },
                        {
                          "Hash Keys": [
                            [
                              "item.i_category"
                            ]
                          ]
                        },
                        {
                          "Group Keys": [
                            []
                          ]
                        }
                      ],
                      "Planned Partitions": 0,
                      "Plans": [
                        {
                          "Node Type": "Hash Join",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 13906.04,
                          "Total Cost": 713849.13,
                          "Plan Rows": 123626,
                          "Plan Width": 114,
                          "Inner Unique": false,
                          "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 2953.04,
                              "Total Cost": 698294.27,
                              "Plan Rows": 123626,
                              "Plan Width": 16,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 1953.04,
                                  "Total Cost": 684931.67,
                                  "Plan Rows": 51511,
                                  "Plan Width": 16,
                                  "Inner Unique": false,
                                  "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 1944.79,
                                      "Total Cost": 684195.48,
                                      "Plan Rows": 56754,
                                      "Plan Width": 20,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_sold_date_sk = d1.d_date_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Relation Name": "store_sales",
                                          "Alias": "store_sales",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 636914.37,
                                          "Plan Rows": 12000637,
                                          "Plan Width": 24,
                                          "parent": 8,
                                          "ID": 9
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 1942.12,
                                          "Total Cost": 1942.12,
                                          "Plan Rows": 213,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "date_dim",
                                              "Alias": "d1",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 1942.12,
                                              "Plan Rows": 213,
                                              "Plan Width": 4,
                                              "Filter": "(d_year = 2002)",
                                              "parent": 10,
                                              "ID": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 10
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 7.04,
                                      "Total Cost": 7.04,
                                      "Plan Rows": 97,
                                      "Plan Width": 4,
                                      "Plans": [
                                        {
                                          "Node Type": "Seq Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Relation Name": "store",
                                          "Alias": "store",
                                          "Startup Cost": 0.0,
                                          "Total Cost": 7.04,
                                          "Plan Rows": 97,
                                          "Plan Width": 4,
                                          "Filter": "(s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))",
                                          "parent": 12,
                                          "ID": 13
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 12,
                                      "left": 13
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 12
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Hash",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 7984.0,
                              "Total Cost": 7984.0,
                              "Plan Rows": 102000,
                              "Plan Width": 106,
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Relation Name": "item",
                                  "Alias": "item",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 7984.0,
                                  "Plan Rows": 102000,
                                  "Plan Width": 106,
                                  "parent": 14,
                                  "ID": 15
                                }
                              ],
                              "parent": 5,
                              "ID": 14,
                              "left": 15
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 14
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Aggregate",
          "Sort",
          "WindowAgg"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[-9993.     -5679.29   -4677.75   -4023.16   -3531.5084 -3137.09\n -2808.36   -2528.18   -2283.45   -2067.96   -1876.05   -1703.66\n -1547.68   -1406.21   -1276.88   -1158.51   -1049.6     -949.26\n  -856.76    -771.26    -692.25    -618.96    -551.2     -488.25\n  -430.08    -376.      -326.27    -280.28    -238.      -199.08\n  -163.73    -131.56    -102.3      -76.2      -53.2      -32.8\n   -14.96       0.        20.91      53.12      97.76     157.\n   233.92     332.88     460.75     627.27     851.1284  1163.82\n  1636.68    2491.47    9776.48  ]"
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_returns.sr_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_returns.sr_ticket_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_returns.sr_return_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_returns.sr_return_amt",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.03934060198283086,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.002614563655130797
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0038558233180083323,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0002464099440101508,
          0.0002464099440101508,
          0.0002464099440101508
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "date_dim.d_moy",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0038558233180083323,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0002464099440101508,
          0.0002464099440101508,
          0.0002464099440101508
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0038385147894165073,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004773926290689254,
          0.004762785321110934,
          0.004665995800319548
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0038385147894165073,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004773926290689254,
          0.004762785321110934,
          0.004665995800319548
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_returns.cr_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_returns.cr_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_returns.cr_return_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_returns.cr_return_amount",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.022648115572470633,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.003917349482444488
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.253080099547641,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.15713644798188153
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_net_paid",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.253080099547641,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.15713644798188153
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "catalog_sales.cs_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.253080099547641,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.15713644798188153
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_ticket_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.41326304411767995,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.09364969420670277
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_net_paid",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.41326304411767995,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.09364969420670277
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "store_sales.ss_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.41326304411767995,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.09364969420670277
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_returns.wr_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_returns.wr_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_returns.wr_return_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_returns.wr_return_amt",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.010639732574645075,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0038500202303338726
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.12654646943201503,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.16019596069004438
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_net_paid",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.12654646943201503,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.16019596069004438
        ]
      }
    }
  },
  {
    "query": "select  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1998\n                         and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) as alias123 \n order by 1,4,5,2\n limit 100;\n\n-- end query 34 in stream 4 using template query49.tpl\n",
    "indexes": "web_sales.ws_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 1594247.03,
      "Total Cost": 1594247.04,
      "Plan Rows": 3,
      "Plan Width": 84,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 1594247.03,
          "Total Cost": 1594247.04,
          "Plan Rows": 3,
          "Plan Width": 84,
          "Sort Key": [
            "('web'::text)",
            "web.return_rank",
            "web.currency_rank",
            "web.item"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Hashed",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 1594246.95,
              "Total Cost": 1594246.98,
              "Plan Rows": 3,
              "Plan Width": 84,
              "Group Key": [
                "('web'::text)",
                "web.item",
                "web.return_ratio",
                "web.return_rank",
                "web.currency_rank"
              ],
              "Planned Partitions": 0,
              "Plans": [
                {
                  "Node Type": "Append",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 264662.74,
                  "Total Cost": 1594246.91,
                  "Plan Rows": 3,
                  "Plan Width": 84,
                  "Subplans Removed": 0,
                  "Plans": [
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "web",
                      "Startup Cost": 264662.74,
                      "Total Cost": 264662.78,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((web.return_rank <= 10) OR (web.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 264662.74,
                          "Total Cost": 264662.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 264662.74,
                              "Total Cost": 264662.75,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_web.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 264662.71,
                                  "Total Cost": 264662.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 264662.71,
                                      "Total Cost": 264662.72,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_web.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_web",
                                          "Startup Cost": 264662.52,
                                          "Total Cost": 264662.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 264662.52,
                                              "Total Cost": 264662.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "ws.ws_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 264662.52,
                                                  "Total Cost": 264662.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 263662.5,
                                                      "Total Cost": 263662.51,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "ws.ws_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 246613.79,
                                                          "Total Cost": 263662.49,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_returns",
                                                              "Alias": "wr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 17027.92,
                                                              "Plan Rows": 2769,
                                                              "Plan Width": 18,
                                                              "Filter": "(wr_return_amt > '10000'::numeric)",
                                                              "parent": 13,
                                                              "ID": 14
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 246606.7,
                                                              "Total Cost": 246606.7,
                                                              "Plan Rows": 473,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 246606.7,
                                                                  "Plan Rows": 473,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(ws.ws_sold_date_sk = date_dim.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "web_sales",
                                                                      "Alias": "ws",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 240230.25,
                                                                      "Plan Rows": 1153021,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))",
                                                                      "parent": 16,
                                                                      "ID": 17
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 18,
                                                                          "ID": 19
                                                                        }
                                                                      ],
                                                                      "parent": 16,
                                                                      "ID": 18,
                                                                      "left": 19
                                                                    }
                                                                  ],
                                                                  "parent": 15,
                                                                  "ID": 16,
                                                                  "left": 17,
                                                                  "right": 18
                                                                }
                                                              ],
                                                              "parent": 13,
                                                              "ID": 15,
                                                              "left": 16
                                                            }
                                                          ],
                                                          "parent": 12,
                                                          "ID": 13,
                                                          "left": 14,
                                                          "right": 15
                                                        }
                                                      ],
                                                      "parent": 11,
                                                      "ID": 12,
                                                      "left": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 11,
                                                  "left": 12
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "catalog",
                      "Startup Cost": 526538.74,
                      "Total Cost": 526538.77,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 526538.74,
                          "Total Cost": 526538.76,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 526538.74,
                              "Total Cost": 526538.74,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_cat.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 526538.71,
                                  "Total Cost": 526538.73,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 526538.71,
                                      "Total Cost": 526538.71,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_cat.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_cat",
                                          "Startup Cost": 526538.52,
                                          "Total Cost": 526538.7,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 526538.52,
                                              "Total Cost": 526538.69,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "cs.cs_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Gather Merge",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 526538.52,
                                                  "Total Cost": 526538.64,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Workers Planned": 2,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Sort",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 525538.49,
                                                      "Total Cost": 525538.5,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Sort Key": [
                                                        "cs.cs_item_sk"
                                                      ],
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 489247.48,
                                                          "Total Cost": 525538.48,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "catalog_returns",
                                                              "Alias": "cr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 36248.69,
                                                              "Plan Rows": 5640,
                                                              "Plan Width": 18,
                                                              "Filter": "(cr_return_amount > '10000'::numeric)",
                                                              "parent": 29,
                                                              "ID": 30
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 489233.62,
                                                              "Total Cost": 489233.62,
                                                              "Plan Rows": 924,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 489233.62,
                                                                  "Plan Rows": 924,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(cs.cs_sold_date_sk = date_dim_1.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "catalog_sales",
                                                                      "Alias": "cs",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 478692.19,
                                                                      "Plan Rows": 2262963,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))",
                                                                      "parent": 32,
                                                                      "ID": 33
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_1",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 34,
                                                                          "ID": 35
                                                                        }
                                                                      ],
                                                                      "parent": 32,
                                                                      "ID": 34,
                                                                      "left": 35
                                                                    }
                                                                  ],
                                                                  "parent": 31,
                                                                  "ID": 32,
                                                                  "left": 33,
                                                                  "right": 34
                                                                }
                                                              ],
                                                              "parent": 29,
                                                              "ID": 31,
                                                              "left": 32
                                                            }
                                                          ],
                                                          "parent": 28,
                                                          "ID": 29,
                                                          "left": 30,
                                                          "right": 31
                                                        }
                                                      ],
                                                      "parent": 27,
                                                      "ID": 28,
                                                      "left": 29
                                                    }
                                                  ],
                                                  "parent": 26,
                                                  "ID": 27,
                                                  "left": 28
                                                }
                                              ],
                                              "parent": 25,
                                              "ID": 26,
                                              "left": 27
                                            }
                                          ],
                                          "parent": 24,
                                          "ID": 25,
                                          "left": 26
                                        }
                                      ],
                                      "parent": 23,
                                      "ID": 24,
                                      "left": 25
                                    }
                                  ],
                                  "parent": 22,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 21,
                              "ID": 22,
                              "left": 23
                            }
                          ],
                          "parent": 20,
                          "ID": 21,
                          "left": 22
                        }
                      ],
                      "parent": 3,
                      "ID": 20,
                      "left": 21
                    },
                    {
                      "Node Type": "Subquery Scan",
                      "Parent Relationship": "Member",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Alias": "store",
                      "Startup Cost": 803045.29,
                      "Total Cost": 803045.32,
                      "Plan Rows": 1,
                      "Plan Width": 84,
                      "Filter": "((store.return_rank <= 10) OR (store.currency_rank <= 10))",
                      "Plans": [
                        {
                          "Node Type": "WindowAgg",
                          "Parent Relationship": "Subquery",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 803045.29,
                          "Total Cost": 803045.31,
                          "Plan Rows": 1,
                          "Plan Width": 84,
                          "Plans": [
                            {
                              "Node Type": "Sort",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 803045.29,
                              "Total Cost": 803045.29,
                              "Plan Rows": 1,
                              "Plan Width": 76,
                              "Sort Key": [
                                "in_store.return_ratio"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "WindowAgg",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 803045.26,
                                  "Total Cost": 803045.28,
                                  "Plan Rows": 1,
                                  "Plan Width": 76,
                                  "Plans": [
                                    {
                                      "Node Type": "Sort",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 803045.26,
                                      "Total Cost": 803045.26,
                                      "Plan Rows": 1,
                                      "Plan Width": 68,
                                      "Sort Key": [
                                        "in_store.currency_ratio"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Subquery Scan",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Alias": "in_store",
                                          "Startup Cost": 803045.18,
                                          "Total Cost": 803045.25,
                                          "Plan Rows": 1,
                                          "Plan Width": 68,
                                          "Plans": [
                                            {
                                              "Node Type": "Aggregate",
                                              "Strategy": "Sorted",
                                              "Partial Mode": "Simple",
                                              "Parent Relationship": "Subquery",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Startup Cost": 803045.18,
                                              "Total Cost": 803045.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 68,
                                              "Group Key": [
                                                "sts.ss_item_sk"
                                              ],
                                              "Plans": [
                                                {
                                                  "Node Type": "Sort",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": false,
                                                  "Async Capable": false,
                                                  "Startup Cost": 803045.18,
                                                  "Total Cost": 803045.19,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 24,
                                                  "Sort Key": [
                                                    "sts.ss_item_sk"
                                                  ],
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Gather",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Startup Cost": 740105.63,
                                                      "Total Cost": 803045.17,
                                                      "Plan Rows": 1,
                                                      "Plan Width": 24,
                                                      "Workers Planned": 2,
                                                      "Single Copy": false,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 739105.63,
                                                          "Total Cost": 802045.07,
                                                          "Plan Rows": 1,
                                                          "Plan Width": 24,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "store_returns",
                                                              "Alias": "sr",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 62883.05,
                                                              "Plan Rows": 7518,
                                                              "Plan Width": 18,
                                                              "Filter": "(sr_return_amt > '10000'::numeric)",
                                                              "parent": 45,
                                                              "ID": 46
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 739089.77,
                                                              "Total Cost": 739089.77,
                                                              "Plan Rows": 1057,
                                                              "Plan Width": 18,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Hash Join",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Join Type": "Inner",
                                                                  "Startup Cost": 2049.78,
                                                                  "Total Cost": 739089.77,
                                                                  "Plan Rows": 1057,
                                                                  "Plan Width": 18,
                                                                  "Inner Unique": false,
                                                                  "Hash Cond": "(sts.ss_sold_date_sk = date_dim_2.d_date_sk)",
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "store_sales",
                                                                      "Alias": "sts",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 726919.14,
                                                                      "Plan Rows": 2697204,
                                                                      "Plan Width": 22,
                                                                      "Filter": "((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))",
                                                                      "parent": 48,
                                                                      "ID": 49
                                                                    },
                                                                    {
                                                                      "Node Type": "Hash",
                                                                      "Parent Relationship": "Inner",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Startup Cost": 2049.55,
                                                                      "Total Cost": 2049.55,
                                                                      "Plan Rows": 18,
                                                                      "Plan Width": 4,
                                                                      "Plans": [
                                                                        {
                                                                          "Node Type": "Seq Scan",
                                                                          "Parent Relationship": "Outer",
                                                                          "Parallel Aware": true,
                                                                          "Async Capable": false,
                                                                          "Relation Name": "date_dim",
                                                                          "Alias": "date_dim_2",
                                                                          "Startup Cost": 0.0,
                                                                          "Total Cost": 2049.55,
                                                                          "Plan Rows": 18,
                                                                          "Plan Width": 4,
                                                                          "Filter": "((d_year = 1998) AND (d_moy = 12))",
                                                                          "parent": 50,
                                                                          "ID": 51
                                                                        }
                                                                      ],
                                                                      "parent": 48,
                                                                      "ID": 50,
                                                                      "left": 51
                                                                    }
                                                                  ],
                                                                  "parent": 47,
                                                                  "ID": 48,
                                                                  "left": 49,
                                                                  "right": 50
                                                                }
                                                              ],
                                                              "parent": 45,
                                                              "ID": 47,
                                                              "left": 48
                                                            }
                                                          ],
                                                          "parent": 44,
                                                          "ID": 45,
                                                          "left": 46,
                                                          "right": 47
                                                        }
                                                      ],
                                                      "parent": 43,
                                                      "ID": 44,
                                                      "left": 45
                                                    }
                                                  ],
                                                  "parent": 42,
                                                  "ID": 43,
                                                  "left": 44
                                                }
                                              ],
                                              "parent": 41,
                                              "ID": 42,
                                              "left": 43
                                            }
                                          ],
                                          "parent": 40,
                                          "ID": 41,
                                          "left": 42
                                        }
                                      ],
                                      "parent": 39,
                                      "ID": 40,
                                      "left": 41
                                    }
                                  ],
                                  "parent": 38,
                                  "ID": 39,
                                  "left": 40
                                }
                              ],
                              "parent": 37,
                              "ID": 38,
                              "left": 39
                            }
                          ],
                          "parent": 36,
                          "ID": 37,
                          "left": 38
                        }
                      ],
                      "parent": 3,
                      "ID": 36,
                      "left": 37
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 20
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.12654646943201503,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Sort",
          "Aggregate",
          "Subquery Scan",
          "WindowAgg",
          "Append"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.16019596069004438
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer.c_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025322612083013077,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.001414213562373095
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer.c_current_addr_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025307796553158807,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0019984573000459242
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer.c_last_name",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer.c_first_name",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer_address.ca_address_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025281680372769542,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.003028337094723881
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "customer_address.ca_city",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]",
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0028246658175195187,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0024914783227696358
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "date_dim.d_dow",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0028246658175195187,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0024914783227696358
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025238852026190278,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047172536255490685
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025238852026190278,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047172536255490685
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "household_demographics.hd_demo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025066558504192968,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.01151157095733846
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "household_demographics.hd_dep_count",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.00016257158383618664,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.25
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "household_demographics.hd_vehicle_count",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.00016257158383618664,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.25
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store.s_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.02290546648955856,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09673325985433133
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store.s_city",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 2.5493505218301538e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.7156862745098039
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025238852026190278,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047172536255490685
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Sort": [
          "[1.0000000e+00 9.9890000e+03 1.9976000e+04 3.0023000e+04 4.0125000e+04\n 5.0109000e+04 6.0125000e+04 7.0139000e+04 8.0160000e+04 9.0166000e+04\n 1.0016800e+05 1.1013100e+05 1.2016700e+05 1.3015900e+05 1.4014100e+05\n 1.5005700e+05 1.6008600e+05 1.7011600e+05 1.8008200e+05 1.9011800e+05\n 2.0002000e+05 2.0994900e+05 2.1992500e+05 2.2991500e+05 2.3995100e+05\n 2.4993000e+05 2.5989700e+05 2.6988500e+05 2.7990400e+05 2.8987800e+05\n 2.9985400e+05 3.0990600e+05 3.1990800e+05 3.2990100e+05 3.3987616e+05\n 3.4989800e+05 3.5985800e+05 3.6978000e+05 3.7982500e+05 3.8983100e+05\n 3.9984300e+05 4.0987700e+05 4.1984100e+05 4.2989700e+05 4.3992700e+05\n 4.4992600e+05 4.5993600e+05 4.6996700e+05 4.8001200e+05 4.8997826e+05\n 5.0000000e+05]"
        ],
        "Aggregate": [
          "[1.0000000e+00 9.9890000e+03 1.9976000e+04 3.0023000e+04 4.0125000e+04\n 5.0109000e+04 6.0125000e+04 7.0139000e+04 8.0160000e+04 9.0166000e+04\n 1.0016800e+05 1.1013100e+05 1.2016700e+05 1.3015900e+05 1.4014100e+05\n 1.5005700e+05 1.6008600e+05 1.7011600e+05 1.8008200e+05 1.9011800e+05\n 2.0002000e+05 2.0994900e+05 2.1992500e+05 2.2991500e+05 2.3995100e+05\n 2.4993000e+05 2.5989700e+05 2.6988500e+05 2.7990400e+05 2.8987800e+05\n 2.9985400e+05 3.0990600e+05 3.1990800e+05 3.2990100e+05 3.3987616e+05\n 3.4989800e+05 3.5985800e+05 3.6978000e+05 3.7982500e+05 3.8983100e+05\n 3.9984300e+05 4.0987700e+05 4.1984100e+05 4.2989700e+05 4.3992700e+05\n 4.4992600e+05 4.5993600e+05 4.6996700e+05 4.8001200e+05 4.8997826e+05\n 5.0000000e+05]",
          "[1.0000000e+00 9.9890000e+03 1.9976000e+04 3.0023000e+04 4.0125000e+04\n 5.0109000e+04 6.0125000e+04 7.0139000e+04 8.0160000e+04 9.0166000e+04\n 1.0016800e+05 1.1013100e+05 1.2016700e+05 1.3015900e+05 1.4014100e+05\n 1.5005700e+05 1.6008600e+05 1.7011600e+05 1.8008200e+05 1.9011800e+05\n 2.0002000e+05 2.0994900e+05 2.1992500e+05 2.2991500e+05 2.3995100e+05\n 2.4993000e+05 2.5989700e+05 2.6988500e+05 2.7990400e+05 2.8987800e+05\n 2.9985400e+05 3.0990600e+05 3.1990800e+05 3.2990100e+05 3.3987616e+05\n 3.4989800e+05 3.5985800e+05 3.6978000e+05 3.7982500e+05 3.8983100e+05\n 3.9984300e+05 4.0987700e+05 4.1984100e+05 4.2989700e+05 4.3992700e+05\n 4.4992600e+05 4.5993600e+05 4.6996700e+05 4.8001200e+05 4.8997826e+05\n 5.0000000e+05]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_hdemo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025066558504192968,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.01151157095733846
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_addr_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.025281680372769542,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.003028337094723881
        ],
        "Sort": [
          "[1.00000e+00 5.01100e+03 1.00060e+04 1.50140e+04 2.00220e+04 2.50190e+04\n 3.00090e+04 3.50190e+04 4.00150e+04 4.50030e+04 4.99580e+04 5.49190e+04\n 5.99290e+04 6.49480e+04 6.99730e+04 7.49750e+04 7.99580e+04 8.49660e+04\n 8.99890e+04 9.50030e+04 1.00009e+05 1.05035e+05 1.10035e+05 1.15078e+05\n 1.20052e+05 1.25095e+05 1.30087e+05 1.35083e+05 1.40071e+05 1.45075e+05\n 1.50050e+05 1.55032e+05 1.60032e+05 1.65010e+05 1.70024e+05 1.75022e+05\n 1.80028e+05 1.85023e+05 1.90019e+05 1.95021e+05 2.00043e+05 2.05059e+05\n 2.10042e+05 2.15038e+05 2.19994e+05 2.24980e+05 2.29997e+05 2.35044e+05\n 2.40041e+05 2.45044e+05 2.50000e+05]"
        ],
        "Aggregate": [
          "[1.00000e+00 5.01100e+03 1.00060e+04 1.50140e+04 2.00220e+04 2.50190e+04\n 3.00090e+04 3.50190e+04 4.00150e+04 4.50030e+04 4.99580e+04 5.49190e+04\n 5.99290e+04 6.49480e+04 6.99730e+04 7.49750e+04 7.99580e+04 8.49660e+04\n 8.99890e+04 9.50030e+04 1.00009e+05 1.05035e+05 1.10035e+05 1.15078e+05\n 1.20052e+05 1.25095e+05 1.30087e+05 1.35083e+05 1.40071e+05 1.45075e+05\n 1.50050e+05 1.55032e+05 1.60032e+05 1.65010e+05 1.70024e+05 1.75022e+05\n 1.80028e+05 1.85023e+05 1.90019e+05 1.95021e+05 2.00043e+05 2.05059e+05\n 2.10042e+05 2.15038e+05 2.19994e+05 2.24980e+05 2.29997e+05 2.35044e+05\n 2.40041e+05 2.45044e+05 2.50000e+05]",
          "[1.00000e+00 5.01100e+03 1.00060e+04 1.50140e+04 2.00220e+04 2.50190e+04\n 3.00090e+04 3.50190e+04 4.00150e+04 4.50030e+04 4.99580e+04 5.49190e+04\n 5.99290e+04 6.49480e+04 6.99730e+04 7.49750e+04 7.99580e+04 8.49660e+04\n 8.99890e+04 9.50030e+04 1.00009e+05 1.05035e+05 1.10035e+05 1.15078e+05\n 1.20052e+05 1.25095e+05 1.30087e+05 1.35083e+05 1.40071e+05 1.45075e+05\n 1.50050e+05 1.55032e+05 1.60032e+05 1.65010e+05 1.70024e+05 1.75022e+05\n 1.80028e+05 1.85023e+05 1.90019e+05 1.95021e+05 2.00043e+05 2.05059e+05\n 2.10042e+05 2.15038e+05 2.19994e+05 2.24980e+05 2.29997e+05 2.35044e+05\n 2.40041e+05 2.45044e+05 2.50000e+05]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.02290546648955856,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09673325985433133
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_ticket_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[1.000000e+00 4.790900e+04 9.591300e+04 1.439130e+05 1.919550e+05\n 2.399770e+05 2.879480e+05 3.359860e+05 3.839660e+05 4.320020e+05\n 4.799570e+05 5.279630e+05 5.759590e+05 6.239540e+05 6.719910e+05\n 7.200790e+05 7.681590e+05 8.161250e+05 8.641500e+05 9.121370e+05\n 9.601160e+05 1.008142e+06 1.056168e+06 1.104136e+06 1.152100e+06\n 1.200037e+06 1.248052e+06 1.296063e+06 1.344055e+06 1.391974e+06\n 1.440001e+06 1.488097e+06 1.536101e+06 1.584092e+06 1.632119e+06\n 1.680116e+06 1.728071e+06 1.776088e+06 1.824096e+06 1.872134e+06\n 1.920196e+06 1.968184e+06 2.016112e+06 2.064125e+06 2.112126e+06\n 2.160041e+06 2.208038e+06 2.256001e+06 2.304028e+06 2.352028e+06\n 2.400000e+06]"
        ],
        "Aggregate": [
          "[1.000000e+00 4.790900e+04 9.591300e+04 1.439130e+05 1.919550e+05\n 2.399770e+05 2.879480e+05 3.359860e+05 3.839660e+05 4.320020e+05\n 4.799570e+05 5.279630e+05 5.759590e+05 6.239540e+05 6.719910e+05\n 7.200790e+05 7.681590e+05 8.161250e+05 8.641500e+05 9.121370e+05\n 9.601160e+05 1.008142e+06 1.056168e+06 1.104136e+06 1.152100e+06\n 1.200037e+06 1.248052e+06 1.296063e+06 1.344055e+06 1.391974e+06\n 1.440001e+06 1.488097e+06 1.536101e+06 1.584092e+06 1.632119e+06\n 1.680116e+06 1.728071e+06 1.776088e+06 1.824096e+06 1.872134e+06\n 1.920196e+06 1.968184e+06 2.016112e+06 2.064125e+06 2.112126e+06\n 2.160041e+06 2.208038e+06 2.256001e+06 2.304028e+06 2.352028e+06\n 2.400000e+06]",
          "[1.000000e+00 4.790900e+04 9.591300e+04 1.439130e+05 1.919550e+05\n 2.399770e+05 2.879480e+05 3.359860e+05 3.839660e+05 4.320020e+05\n 4.799570e+05 5.279630e+05 5.759590e+05 6.239540e+05 6.719910e+05\n 7.200790e+05 7.681590e+05 8.161250e+05 8.641500e+05 9.121370e+05\n 9.601160e+05 1.008142e+06 1.056168e+06 1.104136e+06 1.152100e+06\n 1.200037e+06 1.248052e+06 1.296063e+06 1.344055e+06 1.391974e+06\n 1.440001e+06 1.488097e+06 1.536101e+06 1.584092e+06 1.632119e+06\n 1.680116e+06 1.728071e+06 1.776088e+06 1.824096e+06 1.872134e+06\n 1.920196e+06 1.968184e+06 2.016112e+06 2.064125e+06 2.112126e+06\n 2.160041e+06 2.208038e+06 2.256001e+06 2.304028e+06 2.352028e+06\n 2.400000e+06]"
        ]
      }
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_coupon_amt",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 0)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100;\n\n-- end query 31 in stream 0 using template query46.tpl\n",
    "indexes": "store_sales.ss_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 742749.48,
      "Total Cost": 742749.73,
      "Plan Rows": 100,
      "Plan Width": 138,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 742749.48,
          "Total Cost": 742794.81,
          "Plan Rows": 18129,
          "Plan Width": 138,
          "Sort Key": [
            "customer.c_last_name",
            "customer.c_first_name",
            "current_addr.ca_city",
            "dn.bought_city",
            "dn.ss_ticket_number"
          ],
          "Plans": [
            {
              "Node Type": "Hash Join",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Inner",
              "Startup Cost": 732957.14,
              "Total Cost": 742056.61,
              "Plan Rows": 18129,
              "Plan Width": 138,
              "Inner Unique": false,
              "Hash Cond": "(current_addr.ca_address_sk = customer.c_current_addr_sk)",
              "Join Filter": "((current_addr.ca_city)::text <> (dn.bought_city)::text)",
              "Plans": [
                {
                  "Node Type": "Seq Scan",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Relation Name": "customer_address",
                  "Alias": "current_addr",
                  "Startup Cost": 0.0,
                  "Total Cost": 7935.0,
                  "Plan Rows": 250000,
                  "Plan Width": 13,
                  "parent": 2,
                  "ID": 3
                },
                {
                  "Node Type": "Hash",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 732730.18,
                  "Total Cost": 732730.18,
                  "Plan Rows": 18157,
                  "Plan Width": 133,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 723861.76,
                      "Total Cost": 732730.18,
                      "Plan Rows": 18157,
                      "Plan Width": 133,
                      "Inner Unique": false,
                      "Hash Cond": "(dn.ss_customer_sk = customer.c_customer_sk)",
                      "Plans": [
                        {
                          "Node Type": "Subquery Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Alias": "dn",
                          "Startup Cost": 693404.76,
                          "Total Cost": 696153.52,
                          "Plan Rows": 18157,
                          "Plan Width": 81,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Finalize",
                              "Parent Relationship": "Subquery",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 693404.76,
                              "Total Cost": 695971.95,
                              "Plan Rows": 18157,
                              "Plan Width": 85,
                              "Group Key": [
                                "store_sales.ss_ticket_number",
                                "store_sales.ss_customer_sk",
                                "store_sales.ss_addr_sk",
                                "customer_address.ca_city"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Gather Merge",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 693404.76,
                                  "Total Cost": 695397.0,
                                  "Plan Rows": 15130,
                                  "Plan Width": 85,
                                  "Workers Planned": 2,
                                  "Plans": [
                                    {
                                      "Node Type": "Aggregate",
                                      "Strategy": "Sorted",
                                      "Partial Mode": "Partial",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Startup Cost": 692404.73,
                                      "Total Cost": 692650.6,
                                      "Plan Rows": 7565,
                                      "Plan Width": 85,
                                      "Group Key": [
                                        "store_sales.ss_ticket_number",
                                        "store_sales.ss_customer_sk",
                                        "store_sales.ss_addr_sk",
                                        "customer_address.ca_city"
                                      ],
                                      "Plans": [
                                        {
                                          "Node Type": "Sort",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 692404.73,
                                          "Total Cost": 692423.65,
                                          "Plan Rows": 7565,
                                          "Plan Width": 30,
                                          "Sort Key": [
                                            "store_sales.ss_ticket_number",
                                            "store_sales.ss_customer_sk",
                                            "store_sales.ss_addr_sk",
                                            "customer_address.ca_city"
                                          ],
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 685018.54,
                                              "Total Cost": 691917.35,
                                              "Plan Rows": 7565,
                                              "Plan Width": 30,
                                              "Inner Unique": false,
                                              "Hash Cond": "(customer_address.ca_address_sk = store_sales.ss_addr_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "customer_address",
                                                  "Alias": "customer_address",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 6476.67,
                                                  "Plan Rows": 104167,
                                                  "Plan Width": 13,
                                                  "parent": 11,
                                                  "ID": 12
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 684919.55,
                                                  "Total Cost": 684919.55,
                                                  "Plan Rows": 7919,
                                                  "Plan Width": 21,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": false,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 2296.61,
                                                      "Total Cost": 684919.55,
                                                      "Plan Rows": 7919,
                                                      "Plan Width": 21,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 2289.04,
                                                          "Total Cost": 684789.32,
                                                          "Plan Rows": 11593,
                                                          "Plan Width": 25,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Hash Join",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Join Type": "Inner",
                                                              "Startup Cost": 2105.54,
                                                              "Total Cost": 684307.63,
                                                              "Plan Rows": 48602,
                                                              "Plan Width": 29,
                                                              "Inner Unique": false,
                                                              "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "store_sales",
                                                                  "Alias": "store_sales",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 636914.37,
                                                                  "Plan Rows": 12000637,
                                                                  "Plan Width": 33,
                                                                  "parent": 16,
                                                                  "ID": 17
                                                                },
                                                                {
                                                                  "Node Type": "Hash",
                                                                  "Parent Relationship": "Inner",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Startup Cost": 2103.26,
                                                                  "Total Cost": 2103.26,
                                                                  "Plan Rows": 182,
                                                                  "Plan Width": 4,
                                                                  "Plans": [
                                                                    {
                                                                      "Node Type": "Seq Scan",
                                                                      "Parent Relationship": "Outer",
                                                                      "Parallel Aware": true,
                                                                      "Async Capable": false,
                                                                      "Relation Name": "date_dim",
                                                                      "Alias": "date_dim",
                                                                      "Startup Cost": 0.0,
                                                                      "Total Cost": 2103.26,
                                                                      "Plan Rows": 182,
                                                                      "Plan Width": 4,
                                                                      "Filter": "((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))",
                                                                      "parent": 18,
                                                                      "ID": 19
                                                                    }
                                                                  ],
                                                                  "parent": 16,
                                                                  "ID": 18,
                                                                  "left": 19
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 16,
                                                              "left": 17,
                                                              "right": 18
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Startup Cost": 161.0,
                                                              "Total Cost": 161.0,
                                                              "Plan Rows": 1800,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": false,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "household_demographics",
                                                                  "Alias": "household_demographics",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 161.0,
                                                                  "Plan Rows": 1800,
                                                                  "Plan Width": 4,
                                                                  "Filter": "((hd_dep_count = 9) OR (hd_vehicle_count = 0))",
                                                                  "parent": 20,
                                                                  "ID": 21
                                                                }
                                                              ],
                                                              "parent": 15,
                                                              "ID": 20,
                                                              "left": 21
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 15,
                                                          "left": 16,
                                                          "right": 20
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": false,
                                                          "Async Capable": false,
                                                          "Startup Cost": 6.66,
                                                          "Total Cost": 6.66,
                                                          "Plan Rows": 73,
                                                          "Plan Width": 4,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": false,
                                                              "Async Capable": false,
                                                              "Relation Name": "store",
                                                              "Alias": "store",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 6.66,
                                                              "Plan Rows": 73,
                                                              "Plan Width": 4,
                                                              "Filter": "((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))",
                                                              "parent": 22,
                                                              "ID": 23
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 22,
                                                          "left": 23
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 22
                                                    }
                                                  ],
                                                  "parent": 11,
                                                  "ID": 13,
                                                  "left": 14
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 11,
                                              "left": 12,
                                              "right": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 7,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 6,
                              "ID": 7,
                              "left": 8
                            }
                          ],
                          "parent": 5,
                          "ID": 6,
                          "left": 7
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 18835.0,
                          "Total Cost": 18835.0,
                          "Plan Rows": 500000,
                          "Plan Width": 60,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "customer",
                              "Alias": "customer",
                              "Startup Cost": 0.0,
                              "Total Cost": 18835.0,
                              "Plan Rows": 500000,
                              "Plan Width": 60,
                              "parent": 24,
                              "ID": 25
                            }
                          ],
                          "parent": 5,
                          "ID": 24,
                          "left": 25
                        }
                      ],
                      "parent": 4,
                      "ID": 5,
                      "left": 6,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 4,
                  "left": 5
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 4
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan",
          "Hash"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer.c_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.009510372587901578,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.007482327603191828,
          0.010646298167296914
        ],
        "Hash Join": [
          0.002140287188004221
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer.c_current_addr_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer.c_current_cdemo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031881802427379574,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0010990954799231097
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_address.ca_address_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_address.ca_state",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.007988967004405378,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.021943999999999964
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_purchase_estimate",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[  500.           500.           500.          1000.\n  1000.          1450.00000001  1500.          1500.\n  2000.          2000.          2400.00000002  2500.\n  2500.          3000.          3000.          3349.99999998\n  3500.          3500.          4000.          4000.\n  4300.00000005  4500.          4500.          5000.\n  5000.          5250.          5500.          5500.\n  6000.          6000.          6199.99999995  6500.\n  6500.          7000.          7000.          7149.99999991\n  7500.          7500.          8000.          8000.\n  8100.00000009  8500.          8500.          9000.\n  9000.          9050.00000005  9500.          9500.\n 10000.         10000.         10000.        ]"
        ],
        "Aggregate": [
          "[  500.           500.           500.          1000.\n  1000.          1450.00000001  1500.          1500.\n  2000.          2000.          2400.00000002  2500.\n  2500.          3000.          3000.          3349.99999998\n  3500.          3500.          4000.          4000.\n  4300.00000005  4500.          4500.          5000.\n  5000.          5250.          5500.          5500.\n  6000.          6000.          6199.99999995  6500.\n  6500.          7000.          7000.          7149.99999991\n  7500.          7500.          8000.          8000.\n  8100.00000009  8500.          8500.          9000.\n  9000.          9050.00000005  9500.          9500.\n 10000.         10000.         10000.        ]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_demo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031881802427379574,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0010990954799231097
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_gender",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_marital_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_education_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_credit_rating",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.008315351384641458,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0007118509493627689,
          0.0007118509493627689,
          0.0012046708373831816
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "date_dim.d_moy",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.008315351384641458,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0007118509493627689,
          0.0007118509493627689,
          0.0012046708373831816
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.00953292093389382,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00470206372588172,
          0.004812657768835067,
          0.0036894832314276482
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.00953292093389382,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00470206372588172,
          0.004812657768835067,
          0.0036894832314276482
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "catalog_sales.cs_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031799125326848325,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0036894832314276482
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "catalog_sales.cs_ship_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031678069560103893,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.007482327603191828
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031766806914561457,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00470206372588172
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "store_sales.ss_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.003184857083435983,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.002140287188004221
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "web_sales.ws_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031763277097528425,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004812657768835067
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('MT','FL','SC') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2004 and\n                d_moy between 2 and 2+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2004 and\n                  d_moy between 2 and 2+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 0 using template query69.tpl\n",
    "indexes": "web_sales.ws_bill_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747645.79,
      "Total Cost": 840733.75,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747645.79,
          "Total Cost": 2167237.2,
          "Plan Rows": 1525,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747645.79,
              "Total Cost": 2167199.07,
              "Plan Rows": 1525,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 744961.33,
                  "Total Cost": 1184008.71,
                  "Plan Rows": 1579,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741803.7,
                      "Total Cost": 741990.87,
                      "Plan Rows": 1607,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740803.68,
                          "Total Cost": 740805.36,
                          "Plan Rows": 670,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707936.86,
                              "Total Cost": 740772.23,
                              "Plan Rows": 670,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707928.2,
                                  "Total Cost": 707928.2,
                                  "Plan Rows": 693,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691264.24,
                                      "Total Cost": 707928.2,
                                      "Plan Rows": 693,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684328.37,
                                          "Total Cost": 700940.06,
                                          "Plan Rows": 13167,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684155.91,
                                              "Total Cost": 684155.91,
                                              "Plan Rows": 13797,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.62,
                                                  "Total Cost": 684155.91,
                                                  "Plan Rows": 13797,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 52,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 52,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 5486,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 5486,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{MT,FL,SC}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.62,
                      "Total Cost": 233073.27,
                      "Plan Rows": 8669,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.62,
                          "Total Cost": 233029.92,
                          "Plan Rows": 8669,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.62,
                              "Total Cost": 231163.02,
                              "Plan Rows": 3612,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 52,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 52,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.46,
                  "Total Cost": 574643.56,
                  "Plan Rows": 17251,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.46,
                      "Total Cost": 574557.31,
                      "Plan Rows": 17251,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 88,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 88,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 2) AND (d_moy <= 4) AND (d_year = 2004))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0031577085484552066,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.010646298167296914
        ]
      }
    }
  }
]