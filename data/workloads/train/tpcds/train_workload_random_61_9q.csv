,Query_id,Query_text,Plan_dump
0,56,"with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;

-- end query 40 in stream 4 using template query56.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446131.58, 'Total Cost': 1446131.83, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446131.58, 'Total Cost': 1446132.08, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445992.02, 'Total Cost': 1446123.93, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445992.02, 'Total Cost': 1446118.51, 'Plan Rows': 584, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708186.6, 'Total Cost': 708253.6, 'Plan Rows': 322, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708186.6, 'Total Cost': 708247.57, 'Plan Rows': 268, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707186.58, 'Total Cost': 707216.61, 'Plan Rows': 134, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707186.58, 'Total Cost': 707214.26, 'Plan Rows': 134, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698608.76, 'Total Cost': 698612.98, 'Plan Rows': 1689, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690962.79, 'Total Cost': 698518.21, 'Plan Rows': 1689, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690941.68, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684055.5, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8577.82, 'Total Cost': 8586.77, 'Plan Rows': 3580, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482592.63, 'Total Cost': 482636.97, 'Plan Rows': 174, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482592.63, 'Total Cost': 482633.72, 'Plan Rows': 144, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481592.6, 'Total Cost': 481617.07, 'Plan Rows': 72, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 481592.6, 'Total Cost': 481615.81, 'Plan Rows': 72, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473014.78, 'Total Cost': 473017.07, 'Plan Rows': 916, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465417.52, 'Total Cost': 472969.72, 'Plan Rows': 916, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465406.07, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458286.35, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 24, 'ID': 25, 'left': 26}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8577.82, 'Total Cost': 8586.77, 'Plan Rows': 3580, 'Plan Width': 17, 'Sort Key': ['item_3.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 36, 'ID': 37}], 'parent': 24, 'ID': 36, 'left': 37}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 36}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255212.77, 'Total Cost': 255214.53, 'Plan Rows': 88, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255212.77, 'Total Cost': 255212.99, 'Plan Rows': 88, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 247544.63, 'Total Cost': 255209.92, 'Plan Rows': 88, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 239133.38, 'Total Cost': 246794.67, 'Plan Rows': 1110, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238133.38, 'Total Cost': 245683.67, 'Plan Rows': 462, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 42, 'ID': 43}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.6, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231057.12, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 45, 'ID': 46}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 48, 'ID': 49}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 50, 'ID': 51}], 'parent': 48, 'ID': 50, 'left': 51}], 'parent': 47, 'ID': 48, 'left': 49, 'right': 50}], 'parent': 45, 'ID': 47, 'left': 48}], 'parent': 44, 'ID': 45, 'left': 46, 'right': 47}], 'parent': 42, 'ID': 44, 'left': 45}], 'parent': 41, 'ID': 42, 'left': 43, 'right': 44}], 'parent': 40, 'ID': 41, 'left': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8366.5, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 52, 'ID': 53}], 'parent': 40, 'ID': 52, 'left': 53}], 'parent': 39, 'ID': 40, 'left': 41, 'right': 52}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 3, 'ID': 38, 'left': 39}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
1,69,"select  
  cd_gender,
  cd_marital_status,
  cd_education_status,
  count(*) cnt1,
  cd_purchase_estimate,
  count(*) cnt2,
  cd_credit_rating,
  count(*) cnt3
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  ca_state in ('IN','UT','WV') and
  cd_demo_sk = c.c_current_cdemo_sk and 
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2004 and
                d_moy between 4 and 4+2) and
   (not exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2004 and
                  d_moy between 4 and 4+2) and
    not exists (select * 
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2004 and
                  d_moy between 4 and 4+2))
 group by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 order by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 limit 100;

-- end query 51 in stream 4 using template query69.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 747667.94, 'Total Cost': 838660.28, 'Plan Rows': 100, 'Plan Width': 64, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 747667.94, 'Total Cost': 2235392.72, 'Plan Rows': 1635, 'Plan Width': 64, 'Group Key': ['customer_demographics.cd_gender', 'customer_demographics.cd_marital_status', 'customer_demographics.cd_education_status', 'customer_demographics.cd_purchase_estimate', 'customer_demographics.cd_credit_rating'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Anti', 'Startup Cost': 747667.94, 'Total Cost': 2235351.85, 'Plan Rows': 1635, 'Plan Width': 40, 'Inner Unique': False, 'Join Filter': '(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Anti', 'Startup Cost': 744983.45, 'Total Cost': 1207187.45, 'Plan Rows': 1695, 'Plan Width': 44, 'Inner Unique': False, 'Join Filter': '(c.c_customer_sk = web_sales.ws_bill_customer_sk)', 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 741825.8, 'Total Cost': 742026.82, 'Plan Rows': 1726, 'Plan Width': 44, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 740825.77, 'Total Cost': 740827.57, 'Plan Rows': 719, 'Plan Width': 44, 'Sort Key': ['customer_demographics.cd_gender', 'customer_demographics.cd_marital_status', 'customer_demographics.cd_education_status', 'customer_demographics.cd_purchase_estimate', 'customer_demographics.cd_credit_rating'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 707956.07, 'Total Cost': 740791.66, 'Plan Rows': 719, 'Plan Width': 44, 'Inner Unique': False, 'Hash Cond': '(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'customer_demographics', 'Startup Cost': 0.0, 'Total Cost': 29831.33, 'Plan Rows': 800333, 'Plan Width': 44, 'parent': 6, 'ID': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 707946.76, 'Total Cost': 707946.76, 'Plan Rows': 745, 'Plan Width': 8, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 691275.92, 'Total Cost': 707946.76, 'Plan Rows': 745, 'Plan Width': 8, 'Inner Unique': False, 'Hash Cond': '(c.c_current_addr_sk = ca.ca_address_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 684337.4, 'Total Cost': 700954.09, 'Plan Rows': 13615, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(c.c_customer_sk = store_sales.ss_customer_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'c', 'Startup Cost': 0.0, 'Total Cost': 15918.33, 'Plan Rows': 208333, 'Plan Width': 12, 'parent': 10, 'ID': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 684159.07, 'Total Cost': 684159.07, 'Plan Rows': 14267, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2157.65, 'Total Cost': 684159.07, 'Plan Rows': 14267, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 8, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2156.97, 'Total Cost': 2156.97, 'Plan Rows': 54, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2156.97, 'Plan Rows': 54, 'Plan Width': 4, 'Filter': '((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2004))', 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}], 'parent': 10, 'ID': 12, 'left': 13}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 6867.29, 'Total Cost': 6867.29, 'Plan Rows': 5698, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'ca', 'Startup Cost': 0.0, 'Total Cost': 6867.29, 'Plan Rows': 5698, 'Plan Width': 4, 'Filter': ""(ca_state = ANY ('{IN,UT,WV}'::bpchar[]))"", 'parent': 17, 'ID': 18}], 'parent': 9, 'ID': 17, 'left': 18}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 17}], 'parent': 6, 'ID': 8, 'left': 9}], 'parent': 5, 'ID': 6, 'left': 7, 'right': 8}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3157.65, 'Total Cost': 233105.09, 'Plan Rows': 8964, 'Plan Width': 4, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3157.65, 'Total Cost': 233060.27, 'Plan Rows': 8964, 'Plan Width': 4, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2157.65, 'Total Cost': 231163.87, 'Plan Rows': 3735, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 8, 'parent': 21, 'ID': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2156.97, 'Total Cost': 2156.97, 'Plan Rows': 54, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2156.97, 'Plan Rows': 54, 'Plan Width': 4, 'Filter': '((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2004))', 'parent': 23, 'ID': 24}], 'parent': 21, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 21, 'left': 22, 'right': 23}], 'parent': 19, 'ID': 20, 'left': 21}], 'parent': 3, 'ID': 19, 'left': 20}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 19}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2684.49, 'Total Cost': 574652.42, 'Plan Rows': 17839, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2684.49, 'Total Cost': 574563.22, 'Plan Rows': 17839, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 517695.61, 'Plan Rows': 14401261, 'Plan Width': 8, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2683.36, 'Total Cost': 2683.36, 'Plan Rows': 91, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2683.36, 'Plan Rows': 91, 'Plan Width': 4, 'Filter': '((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2004))', 'parent': 28, 'ID': 29}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 2, 'ID': 25, 'left': 26}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 25}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
2,80,"with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-18' as date) 
                  and (cast('1999-08-18' as date) +  interval '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-18' as date)
                  and (cast('1999-08-18' as date) +  interval '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-18' as date)
                  and (cast('1999-08-18' as date) +  interval '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 61 in stream 3 using template query80.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566786.01, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566795.8, 'Plan Rows': 401, 'Plan Width': 160, 'Grouping Sets': [{'Group Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], [""('store channel'::text)""], []]}], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566783.77, 'Plan Rows': 401, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 1566765.43, 'Plan Rows': 401, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 784591.9, 'Total Cost': 784611.64, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784610.87, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784608.2, 'Plan Rows': 102, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783596.4, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783592.48, 'Plan Rows': 242, 'Plan Width': 41, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94489.35, 'Total Cost': 783582.3, 'Plan Rows': 242, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94482.05, 'Total Cost': 783571.63, 'Plan Rows': 254, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94456.65, 'Total Cost': 783542.68, 'Plan Rows': 270, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 86930.88, 'Total Cost': 775998.13, 'Plan Rows': 4703, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-18'::date) AND (d_date <= '1999-09-17 00:00:00'::timestamp without time zone))"", 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 17, 'ID': 18}], 'parent': 12, 'ID': 17, 'left': 18}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 19, 'ID': 20}], 'parent': 11, 'ID': 19, 'left': 20}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 21, 'ID': 22}], 'parent': 10, 'ID': 21, 'left': 22}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 23, 'ID': 24}], 'parent': 9, 'ID': 23, 'left': 24}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 23}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 518174.1, 'Total Cost': 518225.66, 'Plan Rows': 329, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518220.73, 'Plan Rows': 329, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518210.18, 'Plan Rows': 274, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517178.53, 'Plan Rows': 137, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517174.42, 'Plan Rows': 137, 'Plan Width': 41, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 57382.33, 'Total Cost': 517169.21, 'Plan Rows': 137, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56864.33, 'Total Cost': 516649.32, 'Plan Rows': 138, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_promo_sk = promotion_1.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56838.93, 'Total Cost': 516622.01, 'Plan Rows': 141, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item_1.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 49313.15, 'Total Cost': 509086.46, 'Plan Rows': 2450, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 34, 'ID': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-18'::date) AND (d_date <= '1999-09-17 00:00:00'::timestamp without time zone))"", 'parent': 36, 'ID': 37}], 'parent': 34, 'ID': 36, 'left': 37}], 'parent': 33, 'ID': 34, 'left': 35, 'right': 36}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 38, 'ID': 39}], 'parent': 33, 'ID': 38, 'left': 39}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 38}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 40, 'ID': 41}], 'parent': 32, 'ID': 40, 'left': 41}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 40}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_1', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 42, 'ID': 43}], 'parent': 31, 'ID': 42, 'left': 43}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 44, 'ID': 45}], 'parent': 30, 'ID': 44, 'left': 45}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 44}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 3, 'ID': 25, 'left': 26}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 263918.43, 'Total Cost': 263926.12, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263925.8, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263924.7, 'Plan Rows': 42, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262919.83, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262918.59, 'Plan Rows': 70, 'Plan Width': 41, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32134.74, 'Total Cost': 262916.27, 'Plan Rows': 70, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32130.8, 'Total Cost': 262911.36, 'Plan Rows': 70, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_promo_sk = promotion_2.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32105.4, 'Total Cost': 262884.99, 'Plan Rows': 71, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_item_sk = item_2.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 24579.62, 'Total Cost': 255354.31, 'Plan Rows': 1231, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 55, 'ID': 56}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-18'::date) AND (d_date <= '1999-09-17 00:00:00'::timestamp without time zone))"", 'parent': 57, 'ID': 58}], 'parent': 55, 'ID': 57, 'left': 58}], 'parent': 54, 'ID': 55, 'left': 56, 'right': 57}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 59, 'ID': 60}], 'parent': 54, 'ID': 59, 'left': 60}], 'parent': 53, 'ID': 54, 'left': 55, 'right': 59}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 61, 'ID': 62}], 'parent': 53, 'ID': 61, 'left': 62}], 'parent': 52, 'ID': 53, 'left': 54, 'right': 61}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_2', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 63, 'ID': 64}], 'parent': 52, 'ID': 63, 'left': 64}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 63}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 65, 'ID': 66}], 'parent': 51, 'ID': 65, 'left': 66}], 'parent': 50, 'ID': 51, 'left': 52, 'right': 65}], 'parent': 49, 'ID': 50, 'left': 51}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}], 'parent': 3, 'ID': 46, 'left': 47}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 25}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
3,5,"with ssr as
 (select s_store_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ss_store_sk as store_sk,
            ss_sold_date_sk  as date_sk,
            ss_ext_sales_price as sales_price,
            ss_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from store_sales
    union all
    select sr_store_sk as store_sk,
           sr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           sr_return_amt as return_amt,
           sr_net_loss as net_loss
    from store_returns
   ) salesreturns,
     date_dim,
     store
 where date_sk = d_date_sk
       and d_date between cast('2000-08-09' as date) 
                  and (cast('2000-08-09' as date) +  interval '14 days')
       and store_sk = s_store_sk
 group by s_store_id)
 ,
 csr as
 (select cp_catalog_page_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  cs_catalog_page_sk as page_sk,
            cs_sold_date_sk  as date_sk,
            cs_ext_sales_price as sales_price,
            cs_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from catalog_sales
    union all
    select cr_catalog_page_sk as page_sk,
           cr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           cr_return_amount as return_amt,
           cr_net_loss as net_loss
    from catalog_returns
   ) salesreturns,
     date_dim,
     catalog_page
 where date_sk = d_date_sk
       and d_date between cast('2000-08-09' as date)
                  and (cast('2000-08-09' as date) +  interval '14 days')
       and page_sk = cp_catalog_page_sk
 group by cp_catalog_page_id)
 ,
 wsr as
 (select web_site_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ws_web_site_sk as wsr_web_site_sk,
            ws_sold_date_sk  as date_sk,
            ws_ext_sales_price as sales_price,
            ws_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from web_sales
    union all
    select ws_web_site_sk as wsr_web_site_sk,
           wr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           wr_return_amt as return_amt,
           wr_net_loss as net_loss
    from web_returns left outer join web_sales on
         ( wr_item_sk = ws_item_sk
           and wr_order_number = ws_order_number)
   ) salesreturns,
     date_dim,
     web_site
 where date_sk = d_date_sk
       and d_date between cast('2000-08-09' as date)
                  and (cast('2000-08-09' as date) +  interval '14 days')
       and wsr_web_site_sk = web_site_sk
 group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || s_store_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || cp_catalog_page_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 3 in stream 4 using template query5.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1940110.71, 'Total Cost': 1940110.96, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1940110.71, 'Total Cost': 1940112.05, 'Plan Rows': 533, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.s_store_id)::text))""], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Mixed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 815460.83, 'Total Cost': 1940090.34, 'Plan Rows': 533, 'Plan Width': 160, 'Grouping Sets': [{'Hash Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.s_store_id)::text))""]]}, {'Hash Keys': [[""('store channel'::text)""]]}, {'Group Keys': [[]]}], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 815460.83, 'Total Cost': 1939981.26, 'Plan Rows': 3325, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 815460.83, 'Total Cost': 815498.56, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 815460.83, 'Total Cost': 815497.67, 'Plan Rows': 51, 'Plan Width': 145, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 815460.83, 'Total Cost': 815494.35, 'Plan Rows': 102, 'Plan Width': 145, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 814460.81, 'Total Cost': 814482.56, 'Plan Rows': 51, 'Plan Width': 145, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 814460.81, 'Total Cost': 814464.26, 'Plan Rows': 1382, 'Plan Width': 57, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2056.96, 'Total Cost': 814388.72, 'Plan Rows': 1382, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.66, 'Total Cost': 814357.44, 'Plan Rows': 2710, 'Plan Width': 44, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 762796.01, 'Plan Rows': 13198801, 'Plan Width': 48, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Member', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 48, 'parent': 11, 'ID': 12}, {'Node Type': 'Seq Scan', 'Parent Relationship': 'Member', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 48, 'parent': 11, 'ID': 13}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-09'::date) AND (d_date <= '2000-08-23 00:00:00'::timestamp without time zone))"", 'parent': 14, 'ID': 15}], 'parent': 10, 'ID': 14, 'left': 15}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 16, 'ID': 17}], 'parent': 9, 'ID': 16, 'left': 17}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 16}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 529855.82, 'Total Cost': 530397.33, 'Plan Rows': 3253, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 529855.82, 'Total Cost': 530340.41, 'Plan Rows': 3253, 'Plan Width': 145, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 529855.82, 'Total Cost': 530234.68, 'Plan Rows': 3253, 'Plan Width': 57, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 528855.79, 'Total Cost': 528859.18, 'Plan Rows': 1355, 'Plan Width': 57, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2567.66, 'Total Cost': 528785.31, 'Plan Rows': 1355, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.66, 'Total Cost': 528248.68, 'Plan Rows': 1355, 'Plan Width': 44, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 501439.31, 'Plan Rows': 6600420, 'Plan Width': 48, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Member', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 48, 'parent': 24, 'ID': 25}, {'Node Type': 'Seq Scan', 'Parent Relationship': 'Member', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 48, 'parent': 24, 'ID': 26}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 26}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-09'::date) AND (d_date <= '2000-08-23 00:00:00'::timestamp without time zone))"", 'parent': 27, 'ID': 28}], 'parent': 23, 'ID': 27, 'left': 28}], 'parent': 22, 'ID': 23, 'left': 24, 'right': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 29, 'ID': 30}], 'parent': 22, 'ID': 29, 'left': 30}], 'parent': 21, 'ID': 22, 'left': 23, 'right': 29}], 'parent': 20, 'ID': 21, 'left': 22}], 'parent': 19, 'ID': 20, 'left': 21}], 'parent': 18, 'ID': 19, 'left': 20}], 'parent': 3, 'ID': 18, 'left': 19}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 594059.62, 'Total Cost': 594068.75, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 594059.62, 'Total Cost': 594068.38, 'Plan Rows': 21, 'Plan Width': 145, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 594059.62, 'Total Cost': 594067.01, 'Plan Rows': 42, 'Plan Width': 145, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 593059.59, 'Total Cost': 593062.14, 'Plan Rows': 21, 'Plan Width': 145, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 593059.59, 'Total Cost': 593059.95, 'Plan Rows': 142, 'Plan Width': 57, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2053.61, 'Total Cost': 593054.52, 'Plan Rows': 142, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(""*SELECT* 2"".wsr_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.66, 'Total Cost': 593046.61, 'Plan Rows': 678, 'Plan Width': 44, 'Inner Unique': False, 'Hash Cond': '(""*SELECT* 2"".date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 577049.1, 'Plan Rows': 3718203, 'Plan Width': 48, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': '*SELECT* 2', 'Startup Cost': 277366.65, 'Total Cost': 340720.23, 'Plan Rows': 719217, 'Plan Width': 48, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Subquery', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 277366.65, 'Total Cost': 333528.06, 'Plan Rows': 299674, 'Plan Width': 48, 'Inner Unique': False, 'Hash Cond': '((web_returns.wr_item_sk = web_sales_1.ws_item_sk) AND (web_returns.wr_order_number = web_sales_1.ws_order_number))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 24, 'parent': 40, 'ID': 41}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 217737.86, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales_1', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 12, 'parent': 42, 'ID': 43}], 'parent': 40, 'ID': 42, 'left': 43}], 'parent': 39, 'ID': 40, 'left': 41, 'right': 42}], 'parent': 38, 'ID': 39, 'left': 40}, {'Node Type': 'Seq Scan', 'Parent Relationship': 'Member', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 48, 'parent': 38, 'ID': 44}], 'parent': 37, 'ID': 38, 'left': 39, 'right': 44}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 9, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-09'::date) AND (d_date <= '2000-08-23 00:00:00'::timestamp without time zone))"", 'parent': 45, 'ID': 46}], 'parent': 37, 'ID': 45, 'left': 46}], 'parent': 36, 'ID': 37, 'left': 38, 'right': 45}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 47, 'ID': 48}], 'parent': 36, 'ID': 47, 'left': 48}], 'parent': 35, 'ID': 36, 'left': 37, 'right': 47}], 'parent': 34, 'ID': 35, 'left': 36}], 'parent': 33, 'ID': 34, 'left': 35}], 'parent': 32, 'ID': 33, 'left': 34}], 'parent': 31, 'ID': 32, 'left': 33}], 'parent': 3, 'ID': 31, 'left': 32}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 18}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
4,60,"with ss as (
 select
          i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 cs as (
 select
          i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 ws as (
 select
          i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id)
  select   
  i_item_id
,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by i_item_id
      ,total_sales
 limit 100;

-- end query 44 in stream 1 using template query60.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446860.63, 'Total Cost': 1446860.88, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446860.63, 'Total Cost': 1446861.13, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['item.i_item_id', '(sum((sum(store_sales.ss_ext_sales_price))))'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446578.71, 'Total Cost': 1446852.99, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446578.71, 'Total Cost': 1446840.62, 'Plan Rows': 1974, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708587.67, 'Total Cost': 708786.58, 'Plan Rows': 1087, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708587.67, 'Total Cost': 708766.2, 'Plan Rows': 906, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707587.65, 'Total Cost': 707661.6, 'Plan Rows': 453, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707587.65, 'Total Cost': 707653.67, 'Plan Rows': 453, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698660.73, 'Total Cost': 698665.68, 'Plan Rows': 1980, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690995.69, 'Total Cost': 698552.32, 'Plan Rows': 1980, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690970.94, 'Total Cost': 690970.94, 'Plan Rows': 1980, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684053.54, 'Total Cost': 690970.94, 'Plan Rows': 1980, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8926.92, 'Total Cost': 8952.71, 'Plan Rows': 10319, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482718.72, 'Total Cost': 482730.5, 'Plan Rows': 589, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482718.72, 'Total Cost': 482720.19, 'Plan Rows': 589, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 474867.13, 'Total Cost': 482691.62, 'Plan Rows': 589, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 466499.14, 'Total Cost': 474309.58, 'Plan Rows': 2576, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465499.14, 'Total Cost': 473051.98, 'Plan Rows': 1073, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 25, 'ID': 26}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465485.73, 'Total Cost': 465485.73, 'Plan Rows': 1073, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458285.32, 'Total Cost': 465485.73, 'Plan Rows': 1073, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 28, 'ID': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 31, 'ID': 32}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 33, 'ID': 34}], 'parent': 31, 'ID': 33, 'left': 34}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 33}], 'parent': 28, 'ID': 30, 'left': 31}], 'parent': 27, 'ID': 28, 'left': 29, 'right': 30}], 'parent': 25, 'ID': 27, 'left': 28}], 'parent': 24, 'ID': 25, 'left': 26, 'right': 27}], 'parent': 23, 'ID': 24, 'left': 25}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8239.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 35, 'ID': 36}], 'parent': 23, 'ID': 35, 'left': 36}], 'parent': 22, 'ID': 23, 'left': 24, 'right': 35}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255272.29, 'Total Cost': 255278.25, 'Plan Rows': 298, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255272.29, 'Total Cost': 255273.04, 'Plan Rows': 298, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 247572.21, 'Total Cost': 255260.05, 'Plan Rows': 298, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 239204.22, 'Total Cost': 246884.96, 'Plan Rows': 1301, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238204.22, 'Total Cost': 245754.86, 'Plan Rows': 542, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 41, 'ID': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238197.45, 'Total Cost': 238197.45, 'Plan Rows': 542, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231056.61, 'Total Cost': 238197.45, 'Plan Rows': 542, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 44, 'ID': 45}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 47, 'ID': 48}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 49, 'ID': 50}], 'parent': 47, 'ID': 49, 'left': 50}], 'parent': 46, 'ID': 47, 'left': 48, 'right': 49}], 'parent': 44, 'ID': 46, 'left': 47}], 'parent': 43, 'ID': 44, 'left': 45, 'right': 46}], 'parent': 41, 'ID': 43, 'left': 44}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 43}], 'parent': 39, 'ID': 40, 'left': 41}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8239.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 51, 'ID': 52}], 'parent': 39, 'ID': 51, 'left': 52}], 'parent': 38, 'ID': 39, 'left': 40, 'right': 51}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 3, 'ID': 37, 'left': 38}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
5,78,"with ws as
  (select d_year AS ws_sold_year, ws_item_sk,
    ws_bill_customer_sk ws_customer_sk,
    sum(ws_quantity) ws_qty,
    sum(ws_wholesale_cost) ws_wc,
    sum(ws_sales_price) ws_sp
   from web_sales
   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk
   join date_dim on ws_sold_date_sk = d_date_sk
   where wr_order_number is null
   group by d_year, ws_item_sk, ws_bill_customer_sk
   ),
cs as
  (select d_year AS cs_sold_year, cs_item_sk,
    cs_bill_customer_sk cs_customer_sk,
    sum(cs_quantity) cs_qty,
    sum(cs_wholesale_cost) cs_wc,
    sum(cs_sales_price) cs_sp
   from catalog_sales
   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk
   join date_dim on cs_sold_date_sk = d_date_sk
   where cr_order_number is null
   group by d_year, cs_item_sk, cs_bill_customer_sk
   ),
ss as
  (select d_year AS ss_sold_year, ss_item_sk,
    ss_customer_sk,
    sum(ss_quantity) ss_qty,
    sum(ss_wholesale_cost) ss_wc,
    sum(ss_sales_price) ss_sp
   from store_sales
   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk
   join date_dim on ss_sold_date_sk = d_date_sk
   where sr_ticket_number is null
   group by d_year, ss_item_sk, ss_customer_sk
   )
 select 
ss_sold_year,
round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio,
ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,
coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,
coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,
coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price
from ss
left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)
left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)
where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000
order by 
  ss_sold_year,
  ss_qty desc, ss_wc desc, ss_sp desc,
  other_chan_qty,
  other_chan_wholesale_cost,
  other_chan_sales_price,
  ratio
limit 100;

-- end query 59 in stream 4 using template query78.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1538916.48, 'Total Cost': 1538916.73, 'Plan Rows': 100, 'Plan Width': 180, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1538916.48, 'Total Cost': 1538921.65, 'Plan Rows': 2066, 'Plan Width': 180, 'Sort Key': ['(sum(store_sales.ss_quantity)) DESC', '(sum(store_sales.ss_wholesale_cost)) DESC', '(sum(store_sales.ss_sales_price)) DESC', ""((COALESCE((sum(web_sales.ws_quantity)), '0'::bigint) + COALESCE((sum(catalog_sales.cs_quantity)), '0'::bigint)))"", ""((COALESCE((sum(web_sales.ws_wholesale_cost)), '0'::numeric) + COALESCE((sum(catalog_sales.cs_wholesale_cost)), '0'::numeric)))"", ""((COALESCE((sum(web_sales.ws_sales_price)), '0'::numeric) + COALESCE((sum(catalog_sales.cs_sales_price)), '0'::numeric)))"", ""(round((((sum(store_sales.ss_quantity)) / (COALESCE((sum(web_sales.ws_quantity)), '0'::bigint) + COALESCE((sum(catalog_sales.cs_quantity)), '0'::bigint))))::numeric, 2))""], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 1537617.57, 'Total Cost': 1538837.52, 'Plan Rows': 2066, 'Plan Width': 180, 'Inner Unique': True, 'Merge Cond': '((store_sales.ss_item_sk = catalog_sales.cs_item_sk) AND (store_sales.ss_customer_sk = catalog_sales.cs_bill_customer_sk))', 'Join Filter': '(date_dim_2.d_year = date_dim.d_year)', 'Filter': ""((COALESCE((sum(web_sales.ws_quantity)), '0'::bigint) > 0) OR (COALESCE((sum(catalog_sales.cs_quantity)), '0'::bigint) > 0))"", 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 1029209.44, 'Total Cost': 1030120.75, 'Plan Rows': 3719, 'Plan Width': 156, 'Inner Unique': True, 'Merge Cond': '((store_sales.ss_item_sk = web_sales.ws_item_sk) AND (store_sales.ss_customer_sk = web_sales.ws_bill_customer_sk))', 'Join Filter': '(date_dim_1.d_year = date_dim.d_year)', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 773713.41, 'Total Cost': 774239.39, 'Plan Rows': 3719, 'Plan Width': 84, 'Group Key': ['date_dim.d_year', 'store_sales.ss_item_sk', 'store_sales.ss_customer_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 773713.41, 'Total Cost': 774121.6, 'Plan Rows': 3100, 'Plan Width': 84, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 772713.39, 'Total Cost': 772763.76, 'Plan Rows': 1550, 'Plan Width': 84, 'Group Key': ['date_dim.d_year', 'store_sales.ss_item_sk', 'store_sales.ss_customer_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 772713.39, 'Total Cost': 772717.26, 'Plan Rows': 1550, 'Plan Width': 28, 'Sort Key': ['store_sales.ss_item_sk', 'store_sales.ss_customer_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Anti', 'Startup Cost': 84485.89, 'Total Cost': 772631.25, 'Plan Rows': 1550, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 684195.48, 'Plan Rows': 56754, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Filter': '(d_year = 2000)', 'parent': 11, 'ID': 12}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 8, 'parent': 13, 'ID': 14}], 'parent': 8, 'ID': 13, 'left': 14}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 13}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255496.03, 'Total Cost': 255812.9, 'Plan Rows': 2058, 'Plan Width': 84, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255496.03, 'Total Cost': 255787.18, 'Plan Rows': 2058, 'Plan Width': 84, 'Group Key': ['date_dim_1.d_year', 'web_sales.ws_item_sk', 'web_sales.ws_bill_customer_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255496.03, 'Total Cost': 255721.99, 'Plan Rows': 1716, 'Plan Width': 84, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 254496.01, 'Total Cost': 254523.9, 'Plan Rows': 858, 'Plan Width': 84, 'Group Key': ['date_dim_1.d_year', 'web_sales.ws_item_sk', 'web_sales.ws_bill_customer_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 254496.01, 'Total Cost': 254498.16, 'Plan Rows': 858, 'Plan Width': 28, 'Sort Key': ['web_sales.ws_item_sk', 'web_sales.ws_bill_customer_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Anti', 'Startup Cost': 23889.63, 'Total Cost': 254454.21, 'Plan Rows': 858, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 231016.27, 'Plan Rows': 14859, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 21, 'ID': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Filter': '(d_year = 2000)', 'parent': 23, 'ID': 24}], 'parent': 21, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 21, 'left': 22, 'right': 23}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 8, 'parent': 25, 'ID': 26}], 'parent': 20, 'ID': 25, 'left': 26}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 25}], 'parent': 18, 'ID': 19, 'left': 20}], 'parent': 17, 'ID': 18, 'left': 19}], 'parent': 16, 'ID': 17, 'left': 18}], 'parent': 15, 'ID': 16, 'left': 17}], 'parent': 3, 'ID': 15, 'left': 16}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 15}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 508408.12, 'Total Cost': 508651.54, 'Plan Rows': 1582, 'Plan Width': 84, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 508408.12, 'Total Cost': 508631.76, 'Plan Rows': 1582, 'Plan Width': 84, 'Group Key': ['date_dim_2.d_year', 'catalog_sales.cs_item_sk', 'catalog_sales.cs_bill_customer_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 508408.12, 'Total Cost': 508581.67, 'Plan Rows': 1318, 'Plan Width': 84, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 507408.1, 'Total Cost': 507429.52, 'Plan Rows': 659, 'Plan Width': 84, 'Group Key': ['date_dim_2.d_year', 'catalog_sales.cs_item_sk', 'catalog_sales.cs_bill_customer_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 507408.1, 'Total Cost': 507409.75, 'Plan Rows': 659, 'Plan Width': 28, 'Sort Key': ['catalog_sales.cs_item_sk', 'catalog_sales.cs_bill_customer_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Anti', 'Startup Cost': 48036.17, 'Total Cost': 507377.24, 'Plan Rows': 659, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 33, 'ID': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 8, 'Filter': '(d_year = 2000)', 'parent': 35, 'ID': 36}], 'parent': 33, 'ID': 35, 'left': 36}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 8, 'parent': 37, 'ID': 38}], 'parent': 32, 'ID': 37, 'left': 38}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 37}], 'parent': 30, 'ID': 31, 'left': 32}], 'parent': 29, 'ID': 30, 'left': 31}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 2, 'ID': 27, 'left': 28}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 27}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
6,82,"select  i_item_id
       ,i_item_desc
       ,i_current_price
 from item, inventory, date_dim, store_sales
 where i_current_price between 30 and 30+30
 and inv_item_sk = i_item_sk
 and d_date_sk=inv_date_sk
 and d_date between cast('2002-05-28' as date) and (cast('2002-05-28' as date) +  interval '60 days')
 and i_manufact_id in (114,807,226,515)
 and inv_quantity_on_hand between 100 and 500
 and ss_item_sk = i_item_sk
 group by i_item_id,i_item_desc,i_current_price
 order by i_item_id
 limit 100;

-- end query 62 in stream 0 using template query82.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2322740.3, 'Total Cost': 2322750.33, 'Plan Rows': 12, 'Plan Width': 125, 'Plans': [{'Node Type': 'Group', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2322740.3, 'Total Cost': 2322750.33, 'Plan Rows': 12, 'Plan Width': 125, 'Group Key': ['item.i_item_id', 'item.i_item_desc', 'item.i_current_price'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2322740.3, 'Total Cost': 2322750.15, 'Plan Rows': 24, 'Plan Width': 125, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Group', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2321740.27, 'Total Cost': 2321747.35, 'Plan Rows': 12, 'Plan Width': 125, 'Group Key': ['item.i_item_id', 'item.i_item_desc', 'item.i_current_price'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2321740.27, 'Total Cost': 2321742.04, 'Plan Rows': 708, 'Plan Width': 125, 'Sort Key': ['item.i_item_id', 'item.i_item_desc', 'item.i_current_price'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1639762.26, 'Total Cost': 2321706.76, 'Plan Rows': 708, 'Plan Width': 125, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = inventory.inv_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 7814.06, 'Total Cost': 689736.7, 'Plan Rows': 1412, 'Plan Width': 133, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 4, 'parent': 6, 'ID': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7814.0, 'Total Cost': 7814.0, 'Plan Rows': 5, 'Plan Width': 129, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7814.0, 'Plan Rows': 5, 'Plan Width': 129, 'Filter': ""((i_current_price >= '30'::numeric) AND (i_current_price <= '60'::numeric) AND (i_manufact_id = ANY ('{114,807,226,515}'::integer[])))"", 'parent': 8, 'ID': 9}], 'parent': 6, 'ID': 8, 'left': 9}], 'parent': 5, 'ID': 6, 'left': 7, 'right': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1631727.17, 'Total Cost': 1631727.17, 'Plan Rows': 17682, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2050.0, 'Total Cost': 1631727.17, 'Plan Rows': 17682, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(inventory.inv_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'inventory', 'Alias': 'inventory', 'Startup Cost': 0.0, 'Total Cost': 1551452.05, 'Plan Rows': 20832653, 'Plan Width': 8, 'Filter': '((inv_quantity_on_hand >= 100) AND (inv_quantity_on_hand <= 500))', 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 36, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 36, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-05-28'::date) AND (d_date <= '2002-07-27 00:00:00'::timestamp without time zone))"", 'parent': 13, 'ID': 14}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 5, 'ID': 10, 'left': 11}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 10}], 'parent': 3, 'ID': 4, 'left': 5}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
7,56,"with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;

-- end query 40 in stream 2 using template query56.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.55, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.8, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445794.65, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445790.74, 'Plan Rows': 283, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708105.4, 'Plan Rows': 156, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708102.48, 'Plan Rows': 130, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707068.54, 'Total Cost': 707087.45, 'Plan Rows': 65, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707068.54, 'Total Cost': 707086.31, 'Plan Rows': 65, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698608.76, 'Total Cost': 698612.98, 'Plan Rows': 1689, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690962.79, 'Total Cost': 698518.21, 'Plan Rows': 1689, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690941.68, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684055.5, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482498.46, 'Plan Rows': 84, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482496.88, 'Plan Rows': 70, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481474.57, 'Total Cost': 481488.78, 'Plan Rows': 35, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 481474.57, 'Total Cost': 481488.17, 'Plan Rows': 35, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473014.78, 'Total Cost': 473017.07, 'Plan Rows': 916, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465417.52, 'Total Cost': 472969.72, 'Plan Rows': 916, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465406.07, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458286.35, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 24, 'ID': 25, 'left': 26}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_3.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 36, 'ID': 37}], 'parent': 24, 'ID': 36, 'left': 37}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 36}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255180.37, 'Plan Rows': 43, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255179.56, 'Plan Rows': 36, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 254163.91, 'Total Cost': 254175.38, 'Plan Rows': 18, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 254163.91, 'Total Cost': 254175.07, 'Plan Rows': 18, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 245704.12, 'Total Cost': 245705.27, 'Plan Rows': 462, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238133.38, 'Total Cost': 245683.67, 'Plan Rows': 462, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 43, 'ID': 44}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.6, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231057.12, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 46, 'ID': 47}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 49, 'ID': 50}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 51, 'ID': 52}], 'parent': 49, 'ID': 51, 'left': 52}], 'parent': 48, 'ID': 49, 'left': 50, 'right': 51}], 'parent': 46, 'ID': 48, 'left': 49}], 'parent': 45, 'ID': 46, 'left': 47, 'right': 48}], 'parent': 43, 'ID': 45, 'left': 46}], 'parent': 42, 'ID': 43, 'left': 44, 'right': 45}], 'parent': 41, 'ID': 42, 'left': 43}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_5.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 53, 'ID': 54}], 'parent': 41, 'ID': 53, 'left': 54}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 53}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 3, 'ID': 38, 'left': 39}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
