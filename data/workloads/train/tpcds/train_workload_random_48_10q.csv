,Query_id,Query_text,Plan_dump
0,56,"with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;

-- end query 40 in stream 2 using template query56.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.55, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.8, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445794.65, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445790.74, 'Plan Rows': 283, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708105.4, 'Plan Rows': 156, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708102.48, 'Plan Rows': 130, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707068.54, 'Total Cost': 707087.45, 'Plan Rows': 65, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707068.54, 'Total Cost': 707086.31, 'Plan Rows': 65, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698608.76, 'Total Cost': 698612.98, 'Plan Rows': 1689, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690962.79, 'Total Cost': 698518.21, 'Plan Rows': 1689, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690941.68, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684055.5, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482498.46, 'Plan Rows': 84, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482496.88, 'Plan Rows': 70, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481474.57, 'Total Cost': 481488.78, 'Plan Rows': 35, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 481474.57, 'Total Cost': 481488.17, 'Plan Rows': 35, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473014.78, 'Total Cost': 473017.07, 'Plan Rows': 916, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465417.52, 'Total Cost': 472969.72, 'Plan Rows': 916, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465406.07, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458286.35, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 24, 'ID': 25, 'left': 26}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_3.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 36, 'ID': 37}], 'parent': 24, 'ID': 36, 'left': 37}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 36}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255180.37, 'Plan Rows': 43, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255179.56, 'Plan Rows': 36, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 254163.91, 'Total Cost': 254175.38, 'Plan Rows': 18, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 254163.91, 'Total Cost': 254175.07, 'Plan Rows': 18, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 245704.12, 'Total Cost': 245705.27, 'Plan Rows': 462, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238133.38, 'Total Cost': 245683.67, 'Plan Rows': 462, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 43, 'ID': 44}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.6, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231057.12, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 46, 'ID': 47}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 49, 'ID': 50}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 51, 'ID': 52}], 'parent': 49, 'ID': 51, 'left': 52}], 'parent': 48, 'ID': 49, 'left': 50, 'right': 51}], 'parent': 46, 'ID': 48, 'left': 49}], 'parent': 45, 'ID': 46, 'left': 47, 'right': 48}], 'parent': 43, 'ID': 45, 'left': 46}], 'parent': 42, 'ID': 43, 'left': 44, 'right': 45}], 'parent': 41, 'ID': 42, 'left': 43}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_5.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 53, 'ID': 54}], 'parent': 41, 'ID': 53, 'left': 54}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 53}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 3, 'ID': 38, 'left': 39}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
1,56,"with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('midnight','lace','firebrick'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 3
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;

-- end query 40 in stream 2 using template query56.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.55, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445802.3, 'Total Cost': 1445802.8, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445794.65, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445707.11, 'Total Cost': 1445790.74, 'Plan Rows': 283, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708105.4, 'Plan Rows': 156, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708068.57, 'Total Cost': 708102.48, 'Plan Rows': 130, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707068.54, 'Total Cost': 707087.45, 'Plan Rows': 65, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707068.54, 'Total Cost': 707086.31, 'Plan Rows': 65, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698608.76, 'Total Cost': 698612.98, 'Plan Rows': 1689, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690962.79, 'Total Cost': 698518.21, 'Plan Rows': 1689, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690941.68, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684055.5, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482498.46, 'Plan Rows': 84, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482474.59, 'Total Cost': 482496.88, 'Plan Rows': 70, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481474.57, 'Total Cost': 481488.78, 'Plan Rows': 35, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 481474.57, 'Total Cost': 481488.17, 'Plan Rows': 35, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473014.78, 'Total Cost': 473017.07, 'Plan Rows': 916, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465417.52, 'Total Cost': 472969.72, 'Plan Rows': 916, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465406.07, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458286.35, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 24, 'ID': 25, 'left': 26}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_3.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 36, 'ID': 37}], 'parent': 24, 'ID': 36, 'left': 37}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 36}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255180.37, 'Plan Rows': 43, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255163.93, 'Total Cost': 255179.56, 'Plan Rows': 36, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 254163.91, 'Total Cost': 254175.38, 'Plan Rows': 18, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 254163.91, 'Total Cost': 254175.07, 'Plan Rows': 18, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 245704.12, 'Total Cost': 245705.27, 'Plan Rows': 462, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238133.38, 'Total Cost': 245683.67, 'Plan Rows': 462, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 43, 'ID': 44}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.6, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231057.12, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 46, 'ID': 47}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 49, 'ID': 50}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 3))', 'parent': 51, 'ID': 52}], 'parent': 49, 'ID': 51, 'left': 52}], 'parent': 48, 'ID': 49, 'left': 50, 'right': 51}], 'parent': 46, 'ID': 48, 'left': 49}], 'parent': 45, 'ID': 46, 'left': 47, 'right': 48}], 'parent': 43, 'ID': 45, 'left': 46}], 'parent': 42, 'ID': 43, 'left': 44, 'right': 45}], 'parent': 41, 'ID': 42, 'left': 43}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8459.79, 'Total Cost': 8464.12, 'Plan Rows': 1734, 'Plan Width': 17, 'Sort Key': ['item_5.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 1734, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{midnight,lace,firebrick}'::bpchar[]))"", 'parent': 53, 'ID': 54}], 'parent': 41, 'ID': 53, 'left': 54}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 53}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 3, 'ID': 38, 'left': 39}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
2,31,"with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from store_sales,date_dim,customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from web_sales,date_dim,customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select 
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1998
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1998
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1998
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1998
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1998
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1998
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end 
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by store_q2_q3_increase;

-- end query 20 in stream 2 using template query31.tpl
","{'Node Type': 'Sort', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 4171895.02, 'Total Cost': 4171895.02, 'Plan Rows': 1, 'Plan Width': 210, 'Sort Key': ['((ss3.store_sales / ss2.store_sales))'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'CTE ss', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2314994.0, 'Total Cost': 2716984.68, 'Plan Rows': 1484184, 'Plan Width': 54, 'Group Key': ['customer_address.ca_county', 'date_dim.d_qoy', 'date_dim.d_year'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2314994.0, 'Total Cost': 2661327.78, 'Plan Rows': 2968368, 'Plan Width': 54, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2313993.98, 'Total Cost': 2317704.44, 'Plan Rows': 1484184, 'Plan Width': 54, 'Sort Key': ['customer_address.ca_county', 'date_dim.d_qoy', 'date_dim.d_year'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1892250.42, 'Total Cost': 2060397.93, 'Plan Rows': 1484184, 'Plan Width': 54, 'Group Key': ['customer_address.ca_county', 'date_dim.d_qoy', 'date_dim.d_year'], 'Planned Partitions': 128, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 10761.58, 'Total Cost': 965614.95, 'Plan Rows': 10941821, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 8389.75, 'Total Cost': 855884.2, 'Plan Rows': 11465408, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_addr_sk = customer_address.ca_address_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 14, 'parent': 6, 'ID': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 6476.67, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 18, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 18, 'parent': 8, 'ID': 9}], 'parent': 6, 'ID': 8, 'left': 9}], 'parent': 5, 'ID': 6, 'left': 7, 'right': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1834.7, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 12, 'parent': 10, 'ID': 11}], 'parent': 5, 'ID': 10, 'left': 11}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 10}], 'parent': 3, 'ID': 4, 'left': 5}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'CTE ws', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 777940.92, 'Total Cost': 1232244.51, 'Plan Rows': 1484184, 'Plan Width': 54, 'Group Key': ['customer_address_1.ca_county', 'date_dim_1.d_qoy', 'date_dim_1.d_year'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 777940.92, 'Total Cost': 1176587.61, 'Plan Rows': 2968368, 'Plan Width': 54, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 776940.89, 'Total Cost': 832964.27, 'Plan Rows': 1484184, 'Plan Width': 54, 'Group Key': ['customer_address_1.ca_county', 'date_dim_1.d_qoy', 'date_dim_1.d_year'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 776940.89, 'Total Cost': 784435.11, 'Plan Rows': 2997686, 'Plan Width': 28, 'Sort Key': ['customer_address_1.ca_county', 'date_dim_1.d_qoy', 'date_dim_1.d_year'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 10761.58, 'Total Cost': 311014.56, 'Plan Rows': 2997686, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 8389.75, 'Total Cost': 279765.71, 'Plan Rows': 2998286, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_bill_addr_sk = customer_address_1.ca_address_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 14, 'parent': 17, 'ID': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 6476.67, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 18, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 18, 'parent': 19, 'ID': 20}], 'parent': 17, 'ID': 19, 'left': 20}], 'parent': 16, 'ID': 17, 'left': 18, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1834.7, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 12, 'parent': 21, 'ID': 22}], 'parent': 16, 'ID': 21, 'left': 22}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 21}], 'parent': 14, 'ID': 15, 'left': 16}], 'parent': 13, 'ID': 14, 'left': 15}], 'parent': 12, 'ID': 13, 'left': 14}], 'parent': 0, 'ID': 12, 'left': 13}, {'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 0.0, 'Total Cost': 222665.81, 'Plan Rows': 1, 'Plan Width': 210, 'Inner Unique': False, 'Join Filter': ""(((ss1.ca_county)::text = (ws3.ca_county)::text) AND (CASE WHEN (ws2.web_sales > '0'::numeric) THEN (ws3.web_sales / ws2.web_sales) ELSE NULL::numeric END > CASE WHEN (ss2.store_sales > '0'::numeric) THEN (ss3.store_sales / ss2.store_sales) ELSE NULL::numeric END))"", 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 0.0, 'Total Cost': 185560.28, 'Plan Rows': 1, 'Plan Width': 554, 'Inner Unique': False, 'Join Filter': ""(((ss1.ca_county)::text = (ws2.ca_county)::text) AND (CASE WHEN (ws1.web_sales > '0'::numeric) THEN (ws2.web_sales / ws1.web_sales) ELSE NULL::numeric END > CASE WHEN (ss1.store_sales > '0'::numeric) THEN (ss2.store_sales / ss1.store_sales) ELSE NULL::numeric END))"", 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 0.0, 'Total Cost': 148454.75, 'Plan Rows': 1, 'Plan Width': 444, 'Inner Unique': False, 'Join Filter': '((ss1.ca_county)::text = (ws1.ca_county)::text)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 0.0, 'Total Cost': 111349.69, 'Plan Rows': 1, 'Plan Width': 334, 'Inner Unique': False, 'Join Filter': '((ss1.ca_county)::text = (ss3.ca_county)::text)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 0.0, 'Total Cost': 74239.63, 'Plan Rows': 7, 'Plan Width': 224, 'Inner Unique': False, 'Join Filter': '((ss1.ca_county)::text = (ss2.ca_county)::text)', 'Plans': [{'Node Type': 'CTE Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ss', 'Alias': 'ss1', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 114, 'Filter': '((d_qoy = 1) AND (d_year = 1998))', 'parent': 27, 'ID': 28}, {'Node Type': 'CTE Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ss', 'Alias': 'ss2', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 110, 'Filter': '((d_year = 1998) AND (d_qoy = 2))', 'parent': 27, 'ID': 29}], 'parent': 26, 'ID': 27, 'left': 28, 'right': 29}, {'Node Type': 'CTE Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ss', 'Alias': 'ss3', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 110, 'Filter': '((d_year = 1998) AND (d_qoy = 3))', 'parent': 26, 'ID': 30}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 30}, {'Node Type': 'CTE Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ws', 'Alias': 'ws1', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 110, 'Filter': '((d_qoy = 1) AND (d_year = 1998))', 'parent': 25, 'ID': 31}], 'parent': 24, 'ID': 25, 'left': 26, 'right': 31}, {'Node Type': 'CTE Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ws', 'Alias': 'ws2', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 110, 'Filter': '((d_year = 1998) AND (d_qoy = 2))', 'parent': 24, 'ID': 32}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 32}, {'Node Type': 'CTE Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'CTE Name': 'ws', 'Alias': 'ws3', 'Startup Cost': 0.0, 'Total Cost': 37104.6, 'Plan Rows': 37, 'Plan Width': 110, 'Filter': '((d_year = 1998) AND (d_qoy = 3))', 'parent': 23, 'ID': 33}], 'parent': 0, 'ID': 23, 'left': 24, 'right': 33}], 'parent': None, 'ID': 0, 'left': 1, 'right': 12}"
3,77,"with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from store_sales,
      date_dim,
      store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date) 
                  and (cast('2001-08-22' as date) +  interval '30 days') 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from store_returns,
      date_dim,
      store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date)
                  and (cast('2001-08-22' as date) +  interval '30 days')
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from catalog_sales,
      date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date)
                  and (cast('2001-08-22' as date) +  interval '30 days')
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from catalog_returns,
      date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date)
                  and (cast('2001-08-22' as date) +  interval '30 days')
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from web_sales,
      date_dim,
      web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date)
                  and (cast('2001-08-22' as date) +  interval '30 days')
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from web_returns,
      date_dim,
      web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-22' as date)
                  and (cast('2001-08-22' as date) +  interval '30 days')
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 58 in stream 1 using template query77.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1505270.88, 'Total Cost': 1505271.13, 'Plan Rows': 100, 'Plan Width': 132, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1505270.88, 'Total Cost': 1505271.88, 'Plan Rows': 401, 'Plan Width': 132, 'Sort Key': [""('store channel'::text)"", 'store.s_store_sk'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Mixed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 752766.62, 'Total Cost': 1505255.55, 'Plan Rows': 401, 'Plan Width': 132, 'Grouping Sets': [{'Hash Keys': [[""('store channel'::text)"", 'store.s_store_sk']]}, {'Hash Keys': [[""('store channel'::text)""]]}, {'Group Keys': [[]]}], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 752766.62, 'Total Cost': 1505222.2, 'Plan Rows': 878, 'Plan Width': 132, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 752766.62, 'Total Cost': 752969.37, 'Plan Rows': 102, 'Plan Width': 132, 'Inner Unique': True, 'Merge Cond': '(store.s_store_sk = store_1.s_store_sk)', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685301.79, 'Total Cost': 685458.49, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685301.79, 'Total Cost': 685454.41, 'Plan Rows': 204, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684301.77, 'Total Cost': 684430.84, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684301.77, 'Total Cost': 684394.53, 'Plan Rows': 4638, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684292.35, 'Total Cost': 684304.5, 'Plan Rows': 4860, 'Plan Width': 16, 'Sort Key': ['store_sales.ss_store_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 20, 'parent': 10, 'ID': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 12, 'ID': 13}], 'parent': 10, 'ID': 12, 'left': 13}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 12}], 'parent': 8, 'ID': 9, 'left': 10}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 9.42, 'Total Cost': 9.68, 'Plan Rows': 102, 'Plan Width': 4, 'Sort Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 4, 'parent': 14, 'ID': 15}], 'parent': 8, 'ID': 14, 'left': 15}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 14}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 67464.83, 'Total Cost': 67507.05, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 67464.83, 'Total Cost': 67502.97, 'Plan Rows': 204, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 66464.8, 'Total Cost': 66479.4, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 66464.8, 'Total Cost': 66474.3, 'Plan Rows': 475, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(store_returns.sr_store_sk = store_1.s_store_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 66455.38, 'Total Cost': 66456.61, 'Plan Rows': 492, 'Plan Width': 16, 'Sort Key': ['store_returns.sr_store_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 66433.38, 'Plan Rows': 492, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(store_returns.sr_returned_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 21, 'ID': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 23, 'ID': 24}], 'parent': 21, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 21, 'left': 22, 'right': 23}], 'parent': 19, 'ID': 20, 'left': 21}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 9.42, 'Total Cost': 9.68, 'Plan Rows': 102, 'Plan Width': 4, 'Sort Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store_1', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 4, 'parent': 25, 'ID': 26}], 'parent': 19, 'ID': 25, 'left': 26}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 25}], 'parent': 17, 'ID': 18, 'left': 19}], 'parent': 16, 'ID': 17, 'left': 18}], 'parent': 4, 'ID': 16, 'left': 17}], 'parent': 3, 'ID': 4, 'left': 5, 'right': 16}, {'Node Type': 'Nested Loop', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 499457.89, 'Total Cost': 499508.66, 'Plan Rows': 576, 'Plan Width': 132, 'Inner Unique': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 459397.86, 'Total Cost': 459430.04, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 459397.86, 'Total Cost': 459429.08, 'Plan Rows': 48, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 458397.83, 'Total Cost': 458423.51, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 458397.83, 'Total Cost': 458404.16, 'Plan Rows': 2532, 'Plan Width': 16, 'Sort Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 20, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 30, 'ID': 31, 'left': 32}], 'parent': 29, 'ID': 30, 'left': 31}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40069.8, 'Plan Rows': 24, 'Plan Width': 64, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'cr', 'Startup Cost': 40060.03, 'Total Cost': 40069.68, 'Plan Rows': 24, 'Plan Width': 64, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40069.44, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40068.48, 'Plan Rows': 48, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 39060.01, 'Total Cost': 39062.92, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 39060.01, 'Total Cost': 39060.65, 'Plan Rows': 255, 'Plan Width': 16, 'Sort Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 39049.82, 'Plan Rows': 255, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(catalog_returns.cr_returned_date_sk = date_dim_3.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 42, 'ID': 43}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_3', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 44, 'ID': 45}], 'parent': 42, 'ID': 44, 'left': 45}], 'parent': 41, 'ID': 42, 'left': 43, 'right': 44}], 'parent': 40, 'ID': 41, 'left': 42}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 36, 'ID': 37, 'left': 38}], 'parent': 27, 'ID': 36, 'left': 37}], 'parent': 3, 'ID': 27, 'left': 28, 'right': 36}, {'Node Type': 'Merge Join', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 252593.32, 'Total Cost': 252731.0, 'Plan Rows': 200, 'Plan Width': 132, 'Inner Unique': True, 'Merge Cond': '(web_page.wp_web_page_sk = web_page_1.wp_web_page_sk)', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 232121.48, 'Total Cost': 232213.63, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 232121.48, 'Total Cost': 232205.63, 'Plan Rows': 400, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 231121.45, 'Total Cost': 231159.43, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231121.45, 'Total Cost': 231146.89, 'Plan Rows': 1272, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 231106.81, 'Total Cost': 231109.99, 'Plan Rows': 1272, 'Plan Width': 16, 'Sort Key': ['web_sales.ws_web_page_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_4.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 20, 'parent': 52, 'ID': 53}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_4', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 54, 'ID': 55}], 'parent': 52, 'ID': 54, 'left': 55}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 54}], 'parent': 50, 'ID': 51, 'left': 52}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 14.64, 'Total Cost': 15.14, 'Plan Rows': 200, 'Plan Width': 4, 'Sort Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_page', 'Alias': 'web_page', 'Startup Cost': 0.0, 'Total Cost': 7.0, 'Plan Rows': 200, 'Plan Width': 4, 'parent': 56, 'ID': 57}], 'parent': 50, 'ID': 56, 'left': 57}], 'parent': 49, 'ID': 50, 'left': 51, 'right': 56}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 20471.84, 'Total Cost': 20509.87, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 20471.84, 'Total Cost': 20503.97, 'Plan Rows': 232, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19471.82, 'Total Cost': 19477.17, 'Plan Rows': 116, 'Plan Width': 68, 'Group Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 19471.82, 'Total Cost': 19474.56, 'Plan Rows': 116, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(web_returns.wr_web_page_sk = web_page_1.wp_web_page_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19457.18, 'Total Cost': 19457.48, 'Plan Rows': 121, 'Plan Width': 16, 'Sort Key': ['web_returns.wr_web_page_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 19452.99, 'Plan Rows': 121, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(web_returns.wr_returned_date_sk = date_dim_5.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 63, 'ID': 64}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_5', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2001-08-22'::date) AND (d_date <= '2001-09-21 00:00:00'::timestamp without time zone))"", 'parent': 65, 'ID': 66}], 'parent': 63, 'ID': 65, 'left': 66}], 'parent': 62, 'ID': 63, 'left': 64, 'right': 65}], 'parent': 61, 'ID': 62, 'left': 63}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 14.64, 'Total Cost': 15.14, 'Plan Rows': 200, 'Plan Width': 4, 'Sort Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_page', 'Alias': 'web_page_1', 'Startup Cost': 0.0, 'Total Cost': 7.0, 'Plan Rows': 200, 'Plan Width': 4, 'parent': 67, 'ID': 68}], 'parent': 61, 'ID': 67, 'left': 68}], 'parent': 60, 'ID': 61, 'left': 62, 'right': 67}], 'parent': 59, 'ID': 60, 'left': 61}], 'parent': 58, 'ID': 59, 'left': 60}], 'parent': 46, 'ID': 58, 'left': 59}], 'parent': 3, 'ID': 46, 'left': 47, 'right': 58}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 27}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
4,72,"select  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity 
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '501-1000'
  and d1.d_year = 2001
  and cd_marital_status = 'S'
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;

-- end query 54 in stream 2 using template query72.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2058864.31, 'Total Cost': 2058864.41, 'Plan Rows': 40, 'Plan Width': 147, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2058864.31, 'Total Cost': 2058864.41, 'Plan Rows': 40, 'Plan Width': 147, 'Sort Key': ['(count(*)) DESC', 'item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2058862.15, 'Total Cost': 2058863.25, 'Plan Rows': 40, 'Plan Width': 147, 'Group Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2058862.15, 'Total Cost': 2058862.25, 'Plan Rows': 40, 'Plan Width': 127, 'Sort Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 2004596.21, 'Total Cost': 2058861.08, 'Plan Rows': 40, 'Plan Width': 127, 'Inner Unique': False, 'Join Filter': '(catalog_sales.cs_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Right', 'Startup Cost': 2004596.21, 'Total Cost': 2058541.83, 'Plan Rows': 40, 'Plan Width': 127, 'Inner Unique': False, 'Hash Cond': '((catalog_returns.cr_item_sk = catalog_sales.cs_item_sk) AND (catalog_returns.cr_order_number = catalog_sales.cs_order_number))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 43147.49, 'Plan Rows': 1439749, 'Plan Width': 8, 'parent': 5, 'ID': 6}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2004595.61, 'Total Cost': 2004595.61, 'Plan Rows': 40, 'Plan Width': 135, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 508613.25, 'Total Cost': 2004595.61, 'Plan Rows': 40, 'Plan Width': 135, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_ship_date_sk = d3.d_date_sk)', 'Join Filter': '(d3.d_date > (d1.d_date + 5))', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505564.64, 'Total Cost': 2001544.76, 'Plan Rows': 121, 'Plan Width': 143, 'Inner Unique': False, 'Join Filter': '(inventory.inv_warehouse_sk = warehouse.w_warehouse_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505564.64, 'Total Cost': 2001525.48, 'Plan Rows': 121, 'Plan Width': 130, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 494611.64, 'Total Cost': 1988874.82, 'Plan Rows': 121, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 493611.64, 'Total Cost': 1987862.72, 'Plan Rows': 50, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '((inventory.inv_date_sk = d2.d_date_sk) AND (d1.d_week_seq = d2.d_week_seq))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 491132.39, 'Total Cost': 1981451.77, 'Plan Rows': 524186, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(inventory.inv_item_sk = catalog_sales.cs_item_sk)', 'Join Filter': '(inventory.inv_quantity_on_hand < catalog_sales.cs_quantity)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'inventory', 'Alias': 'inventory', 'Startup Cost': 0.0, 'Total Cost': 1274139.37, 'Plan Rows': 55462537, 'Plan Width': 16, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 491120.29, 'Total Cost': 491120.29, 'Plan Rows': 968, 'Plan Width': 28, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458688.15, 'Total Cost': 491120.29, 'Plan Rows': 968, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(customer_demographics.cd_demo_sk = catalog_sales.cs_bill_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'customer_demographics', 'Startup Cost': 0.0, 'Total Cost': 31832.17, 'Plan Rows': 158920, 'Plan Width': 4, 'Filter': ""(cd_marital_status = 'S'::bpchar)"", 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458626.88, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2102.79, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_bill_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = d1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 20, 'ID': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd1', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Filter': '(d_year = 2001)', 'parent': 22, 'ID': 23}], 'parent': 20, 'ID': 22, 'left': 23}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 143.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Filter': ""(hd_buy_potential = '501-1000'::bpchar)"", 'parent': 24, 'ID': 25}], 'parent': 19, 'ID': 24, 'left': 25}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 24}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1834.7, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd2', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 26, 'ID': 27}], 'parent': 12, 'ID': 26, 'left': 27}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 26}], 'parent': 10, 'ID': 11, 'left': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 7984.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'parent': 28, 'ID': 29}], 'parent': 10, 'ID': 28, 'left': 29}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 28}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 1.15, 'Plan Rows': 10, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'warehouse', 'Alias': 'warehouse', 'Startup Cost': 0.0, 'Total Cost': 1.1, 'Plan Rows': 10, 'Plan Width': 21, 'parent': 30, 'ID': 31}], 'parent': 9, 'ID': 30, 'left': 31}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2135.49, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd3', 'Startup Cost': 0.0, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'parent': 32, 'ID': 33}], 'parent': 8, 'ID': 32, 'left': 33}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 32}], 'parent': 5, 'ID': 7, 'left': 8}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 7}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 20.5, 'Plan Rows': 500, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 18.0, 'Plan Rows': 500, 'Plan Width': 4, 'parent': 34, 'ID': 35}], 'parent': 4, 'ID': 34, 'left': 35}], 'parent': 3, 'ID': 4, 'left': 5, 'right': 34}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
5,29,"select   
     i_item_id
    ,i_item_desc
    ,s_store_id
    ,s_store_name
    ,sum(ss_quantity)        as store_sales_quantity
    ,sum(sr_return_quantity) as store_returns_quantity
    ,sum(cs_quantity)        as catalog_sales_quantity
 from
    store_sales
   ,store_returns
   ,catalog_sales
   ,date_dim             d1
   ,date_dim             d2
   ,date_dim             d3
   ,store
   ,item
 where
     d1.d_moy               = 4 
 and d1.d_year              = 1999
 and d1.d_date_sk           = ss_sold_date_sk
 and i_item_sk              = ss_item_sk
 and s_store_sk             = ss_store_sk
 and ss_customer_sk         = sr_customer_sk
 and ss_item_sk             = sr_item_sk
 and ss_ticket_number       = sr_ticket_number
 and sr_returned_date_sk    = d2.d_date_sk
 and d2.d_moy               between 4 and  4 + 3 
 and d2.d_year              = 1999
 and sr_customer_sk         = cs_bill_customer_sk
 and sr_item_sk             = cs_item_sk
 and cs_sold_date_sk        = d3.d_date_sk     
 and d3.d_year              in (1999,1999+1,1999+2)
 group by
    i_item_id
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 order by
    i_item_id 
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 limit 100;

-- end query 19 in stream 2 using template query29.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 762542.58, 'Total Cost': 1221390.95, 'Plan Rows': 1, 'Plan Width': 164, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 762542.58, 'Total Cost': 1221390.95, 'Plan Rows': 1, 'Plan Width': 164, 'Group Key': ['item.i_item_id', 'item.i_item_desc', 'store.s_store_id', 'store.s_store_name'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 762542.58, 'Total Cost': 1221390.92, 'Plan Rows': 1, 'Plan Width': 152, 'Inner Unique': False, 'Join Filter': '((item.i_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_customer_sk = store_returns.sr_customer_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692960.09, 'Total Cost': 694214.78, 'Plan Rows': 10773, 'Plan Width': 160, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 691960.07, 'Total Cost': 691971.29, 'Plan Rows': 4489, 'Plan Width': 160, 'Sort Key': ['item.i_item_id', 'item.i_item_desc', 'store.s_store_id', 'store.s_store_name'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684120.68, 'Total Cost': 691687.76, 'Plan Rows': 4489, 'Plan Width': 160, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 123, 'parent': 5, 'ID': 6}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 684064.57, 'Total Cost': 684064.57, 'Plan Rows': 4489, 'Plan Width': 37, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2057.07, 'Total Cost': 684064.57, 'Plan Rows': 4489, 'Plan Width': 37, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = d1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 24, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_moy = 4) AND (d_year = 1999))', 'parent': 11, 'ID': 12}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 25, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 25, 'parent': 13, 'ID': 14}], 'parent': 8, 'ID': 13, 'left': 14}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 13}], 'parent': 5, 'ID': 7, 'left': 8}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 7}], 'parent': 3, 'ID': 4, 'left': 5}], 'parent': 2, 'ID': 3, 'left': 4}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 69582.49, 'Total Cost': 526960.68, 'Plan Rows': 1, 'Plan Width': 28, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 69582.49, 'Total Cost': 526960.67, 'Plan Rows': 1, 'Plan Width': 28, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 68582.49, 'Total Cost': 525960.57, 'Plan Rows': 1, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = store_returns.sr_item_sk) AND (catalog_sales.cs_bill_customer_sk = store_returns.sr_customer_sk))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2003.83, 'Total Cost': 458715.99, 'Plan Rows': 88788, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = d3.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 16, 'parent': 18, 'ID': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1995.84, 'Total Cost': 1995.84, 'Plan Rows': 639, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd3', 'Startup Cost': 0.0, 'Total Cost': 1995.84, 'Plan Rows': 639, 'Plan Width': 4, 'Filter': ""(d_year = ANY ('{1999,2000,2001}'::integer[]))"", 'parent': 20, 'ID': 21}], 'parent': 18, 'ID': 20, 'left': 21}], 'parent': 17, 'ID': 18, 'left': 19, 'right': 20}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 66549.88, 'Total Cost': 66549.88, 'Plan Rows': 1919, 'Plan Width': 16, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2157.86, 'Total Cost': 66549.88, 'Plan Rows': 1919, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(store_returns.sr_returned_date_sk = d2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 23, 'ID': 24}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2156.97, 'Total Cost': 2156.97, 'Plan Rows': 71, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd2', 'Startup Cost': 0.0, 'Total Cost': 2156.97, 'Plan Rows': 71, 'Plan Width': 4, 'Filter': '((d_moy >= 4) AND (d_moy <= 7) AND (d_year = 1999))', 'parent': 25, 'ID': 26}], 'parent': 23, 'ID': 25, 'left': 26}], 'parent': 22, 'ID': 23, 'left': 24, 'right': 25}], 'parent': 17, 'ID': 22, 'left': 23}], 'parent': 16, 'ID': 17, 'left': 18, 'right': 22}], 'parent': 15, 'ID': 16, 'left': 17}], 'parent': 2, 'ID': 15, 'left': 16}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 15}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
6,72,"select  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity 
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '>10000'
  and d1.d_year = 2000
  and cd_marital_status = 'W'
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;

-- end query 54 in stream 0 using template query72.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059038.72, 'Total Cost': 2059038.82, 'Plan Rows': 40, 'Plan Width': 147, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059038.72, 'Total Cost': 2059038.82, 'Plan Rows': 40, 'Plan Width': 147, 'Sort Key': ['(count(*)) DESC', 'item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059036.55, 'Total Cost': 2059037.65, 'Plan Rows': 40, 'Plan Width': 147, 'Group Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059036.55, 'Total Cost': 2059036.65, 'Plan Rows': 40, 'Plan Width': 127, 'Sort Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 2004770.62, 'Total Cost': 2059035.49, 'Plan Rows': 40, 'Plan Width': 127, 'Inner Unique': False, 'Join Filter': '(catalog_sales.cs_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Right', 'Startup Cost': 2004770.62, 'Total Cost': 2058716.24, 'Plan Rows': 40, 'Plan Width': 127, 'Inner Unique': False, 'Hash Cond': '((catalog_returns.cr_item_sk = catalog_sales.cs_item_sk) AND (catalog_returns.cr_order_number = catalog_sales.cs_order_number))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 43147.49, 'Plan Rows': 1439749, 'Plan Width': 8, 'parent': 5, 'ID': 6}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2004770.02, 'Total Cost': 2004770.02, 'Plan Rows': 40, 'Plan Width': 135, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 508621.87, 'Total Cost': 2004770.02, 'Plan Rows': 40, 'Plan Width': 135, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_ship_date_sk = d3.d_date_sk)', 'Join Filter': '(d3.d_date > (d1.d_date + 5))', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505573.27, 'Total Cost': 2001719.15, 'Plan Rows': 122, 'Plan Width': 143, 'Inner Unique': False, 'Join Filter': '(inventory.inv_warehouse_sk = warehouse.w_warehouse_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505573.27, 'Total Cost': 2001699.72, 'Plan Rows': 122, 'Plan Width': 130, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 494620.27, 'Total Cost': 1989049.04, 'Plan Rows': 122, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 493620.27, 'Total Cost': 1988036.84, 'Plan Rows': 51, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '((inventory.inv_date_sk = d2.d_date_sk) AND (d1.d_week_seq = d2.d_week_seq))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 491141.02, 'Total Cost': 1981570.46, 'Plan Rows': 531578, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(inventory.inv_item_sk = catalog_sales.cs_item_sk)', 'Join Filter': '(inventory.inv_quantity_on_hand < catalog_sales.cs_quantity)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'inventory', 'Alias': 'inventory', 'Startup Cost': 0.0, 'Total Cost': 1274139.37, 'Plan Rows': 55462537, 'Plan Width': 16, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 491128.75, 'Total Cost': 491128.75, 'Plan Rows': 981, 'Plan Width': 28, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458688.15, 'Total Cost': 491128.75, 'Plan Rows': 981, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(customer_demographics.cd_demo_sk = catalog_sales.cs_bill_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'customer_demographics', 'Startup Cost': 0.0, 'Total Cost': 31832.17, 'Plan Rows': 161160, 'Plan Width': 4, 'Filter': ""(cd_marital_status = 'W'::bpchar)"", 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458626.88, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2102.79, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_bill_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = d1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 20, 'ID': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd1', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Filter': '(d_year = 2000)', 'parent': 22, 'ID': 23}], 'parent': 20, 'ID': 22, 'left': 23}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 143.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Filter': ""(hd_buy_potential = '>10000'::bpchar)"", 'parent': 24, 'ID': 25}], 'parent': 19, 'ID': 24, 'left': 25}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 24}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1834.7, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd2', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 26, 'ID': 27}], 'parent': 12, 'ID': 26, 'left': 27}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 26}], 'parent': 10, 'ID': 11, 'left': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 7984.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'parent': 28, 'ID': 29}], 'parent': 10, 'ID': 28, 'left': 29}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 28}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 1.15, 'Plan Rows': 10, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'warehouse', 'Alias': 'warehouse', 'Startup Cost': 0.0, 'Total Cost': 1.1, 'Plan Rows': 10, 'Plan Width': 21, 'parent': 30, 'ID': 31}], 'parent': 9, 'ID': 30, 'left': 31}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2135.49, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd3', 'Startup Cost': 0.0, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'parent': 32, 'ID': 33}], 'parent': 8, 'ID': 32, 'left': 33}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 32}], 'parent': 5, 'ID': 7, 'left': 8}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 7}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 20.5, 'Plan Rows': 500, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 18.0, 'Plan Rows': 500, 'Plan Width': 4, 'parent': 34, 'ID': 35}], 'parent': 4, 'ID': 34, 'left': 35}], 'parent': 3, 'ID': 4, 'left': 5, 'right': 34}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
7,8,"select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '28391','64239','20347','73784','73824','66065',
                          '73199','59089','53201','62243','92719',
                          '37071','59574','76633','26382','16656',
                          '61917','89334','50969','67344','27359',
                          '83432','43653','94525','74307','54303',
                          '20010','43509','52976','82322','24982',
                          '86027','36604','49342','21047','48507',
                          '66415','44851','81425','96808','25230',
                          '88126','55068','70480','95932','60876',
                          '69464','38767','63796','93319','11001',
                          '10890','13117','43752','90688','71748',
                          '26144','14812','36603','54108','94671',
                          '58818','61476','21867','61594','69194',
                          '14575','86757','76286','32981','23473',
                          '28768','70489','66929','22539','73390',
                          '39172','63810','84886','29051','57545',
                          '76769','13506','36726','79223','32191',
                          '74497','27322','55997','30458','54297',
                          '48666','77502','48282','64066','85963',
                          '96708','60107','27853','48171','60037',
                          '94144','27514','46529','30300','33748',
                          '43518','78800','97745','42120','47639',
                          '65771','52068','66731','27664','31745',
                          '91226','90377','14603','28033','30431',
                          '81536','34988','96243','42655','32338',
                          '69267','36723','28623','77444','47421',
                          '31067','35719','74015','57576','17226',
                          '66114','82730','50769','32319','79672',
                          '74534','80801','77250','72566','94602',
                          '16602','79723','95952','88457','85468',
                          '59861','65350','40019','93908','49596',
                          '85681','10731','49038','75055','88540',
                          '38845','70411','96820','37220','83909',
                          '39161','27769','88296','58220','65589',
                          '34209','70043','81549','13269','61113',
                          '59388','98279','15351','40786','35295',
                          '22933','46141','36326','53159','40058',
                          '31209','17456','39039','41507','26092',
                          '44470','72116','11922','91613','30485',
                          '90668','69852','73591','84717','63784',
                          '73638','12531','53729','93058','43391',
                          '89166','10516','45662','33712','63634',
                          '86309','47151','49611','66150','80492',
                          '98855','75249','23696','99487','21585',
                          '61381','61627','17042','32937','31252',
                          '14468','82716','61701','46108','47587',
                          '59954','60474','88331','82466','21238',
                          '66206','70918','38467','25223','44439',
                          '65077','64998','87617','82051','93609',
                          '20011','19168','64594','91448','94908',
                          '83839','85393','99848','81733','22731',
                          '98696','33314','14763','59948','69441',
                          '93052','25756','62090','68535','60501',
                          '74992','52991','36767','63829','72579',
                          '47864','78028','11064','68261','97177',
                          '90090','69375','61205','45051','13452',
                          '72170','56238','12342','14144','71008',
                          '85506','55346','30657','34350','10107',
                          '52939','60779','66210','75463','95371',
                          '92558','63450','36826','39942','33840',
                          '59092','47329','36963','87721','82931',
                          '12512','22763','57808','84000','41473',
                          '37542','82097','57069','10455','16818',
                          '42867','32795','28351','26882','57138',
                          '53130','54989','18773','82718','75038',
                          '92886','55262','86886','37984','34962',
                          '61560','64223','69667','18294','32597',
                          '13655','86763','99226','37239','43778',
                          '70157','47076','42238','60312','45790',
                          '37213','84811','28060','43466','92636',
                          '40444','95018','76006','98667','26288',
                          '10292','58986','98566','21203','81895',
                          '40863','32224','61462','44450','33444',
                          '59155','11030','46922','14725','44646',
                          '13306','47003','10564','56713','20258',
                          '16536','85967','66781','67691','16491',
                          '10077','70688','82357','72506','47511',
                          '65645','73994','68609','74102','84599',
                          '27634','35818','52559','55580','39401',
                          '23121','73037','20480','27230')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;

-- end query 5 in stream 2 using template query8.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 737195.99, 'Total Cost': 737441.22, 'Plan Rows': 10, 'Plan Width': 36, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 737195.99, 'Total Cost': 737441.22, 'Plan Rows': 10, 'Plan Width': 36, 'Group Key': ['store.s_store_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 737195.99, 'Total Cost': 737277.69, 'Plan Rows': 32680, 'Plan Width': 10, 'Sort Key': ['store.s_store_name'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 45610.05, 'Total Cost': 734745.63, 'Plan Rows': 32680, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(substr((store.s_zip)::text, 1, 2) = substr(a2.ca_zip, 1, 2))', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3057.52, 'Total Cost': 688516.6, 'Plan Rows': 32680, 'Plan Width': 21, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2057.52, 'Total Cost': 684248.6, 'Plan Rows': 13617, 'Plan Width': 21, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2050.23, 'Total Cost': 684051.64, 'Plan Rows': 14267, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 14, 'parent': 6, 'ID': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 54, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 54, 'Plan Width': 4, 'Filter': '((d_qoy = 2) AND (d_year = 1999))', 'parent': 8, 'ID': 9}], 'parent': 6, 'ID': 8, 'left': 9}], 'parent': 5, 'ID': 6, 'left': 7, 'right': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 19, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 19, 'parent': 10, 'ID': 11}], 'parent': 5, 'ID': 10, 'left': 11}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 10}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 42550.03, 'Total Cost': 42550.03, 'Plan Rows': 200, 'Plan Width': 32, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'a2', 'Startup Cost': 27168.13, 'Total Cost': 42550.03, 'Plan Rows': 200, 'Plan Width': 32, 'Plans': [{'Node Type': 'SetOp', 'Strategy': 'Hashed', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Command': 'Intersect', 'Startup Cost': 27168.13, 'Total Cost': 42548.03, 'Plan Rows': 200, 'Plan Width': 36, 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 27168.13, 'Total Cost': 42004.46, 'Plan Rows': 217426, 'Plan Width': 36, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': '*SELECT* 2', 'Startup Cost': 27168.13, 'Total Cost': 27236.31, 'Plan Rows': 1091, 'Plan Width': 36, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'a1', 'Startup Cost': 27168.13, 'Total Cost': 27225.4, 'Plan Rows': 1091, 'Plan Width': 32, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 27168.13, 'Total Cost': 27214.49, 'Plan Rows': 1091, 'Plan Width': 51, 'Group Key': ['customer_address.ca_zip'], 'Filter': '(count(*) > 10)', 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 26448.29, 'Total Cost': 27135.41, 'Plan Rows': 6544, 'Plan Width': 19, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 25448.29, 'Total Cost': 25481.01, 'Plan Rows': 3272, 'Plan Width': 19, 'Group Key': ['customer_address.ca_zip'], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 17674.84, 'Total Cost': 24954.02, 'Plan Rows': 98854, 'Plan Width': 11, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = customer.c_current_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 15, 'parent': 21, 'ID': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16439.17, 'Total Cost': 16439.17, 'Plan Rows': 98854, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 16439.17, 'Plan Rows': 98854, 'Plan Width': 4, 'Filter': ""(c_preferred_cust_flag = 'Y'::bpchar)"", 'parent': 23, 'ID': 24}], 'parent': 21, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 21, 'left': 22, 'right': 23}], 'parent': 19, 'ID': 20, 'left': 21}], 'parent': 18, 'ID': 19, 'left': 20}], 'parent': 17, 'ID': 18, 'left': 19}], 'parent': 16, 'ID': 17, 'left': 18}], 'parent': 15, 'ID': 16, 'left': 17}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': '*SELECT* 1', 'Startup Cost': 1.0, 'Total Cost': 13681.02, 'Plan Rows': 216335, 'Plan Width': 36, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 1.0, 'Total Cost': 11517.67, 'Plan Rows': 216335, 'Plan Width': 32, 'Filter': ""(substr((ca_zip)::text, 1, 5) = ANY ('{28391,64239,20347,73784,73824,66065,73199,59089,53201,62243,92719,37071,59574,76633,26382,16656,61917,89334,50969,67344,27359,83432,43653,94525,74307,54303,20010,43509,52976,82322,24982,86027,36604,49342,21047,48507,66415,44851,81425,96808,25230,88126,55068,70480,95932,60876,69464,38767,63796,93319,11001,10890,13117,43752,90688,71748,26144,14812,36603,54108,94671,58818,61476,21867,61594,69194,14575,86757,76286,32981,23473,28768,70489,66929,22539,73390,39172,63810,84886,29051,57545,76769,13506,36726,79223,32191,74497,27322,55997,30458,54297,48666,77502,48282,64066,85963,96708,60107,27853,48171,60037,94144,27514,46529,30300,33748,43518,78800,97745,42120,47639,65771,52068,66731,27664,31745,91226,90377,14603,28033,30431,81536,34988,96243,42655,32338,69267,36723,28623,77444,47421,31067,35719,74015,57576,17226,66114,82730,50769,32319,79672,74534,80801,77250,72566,94602,16602,79723,95952,88457,85468,59861,65350,40019,93908,49596,85681,10731,49038,75055,88540,38845,70411,96820,37220,83909,39161,27769,88296,58220,65589,34209,70043,81549,13269,61113,59388,98279,15351,40786,35295,22933,46141,36326,53159,40058,31209,17456,39039,41507,26092,44470,72116,11922,91613,30485,90668,69852,73591,84717,63784,73638,12531,53729,93058,43391,89166,10516,45662,33712,63634,86309,47151,49611,66150,80492,98855,75249,23696,99487,21585,61381,61627,17042,32937,31252,14468,82716,61701,46108,47587,59954,60474,88331,82466,21238,66206,70918,38467,25223,44439,65077,64998,87617,82051,93609,20011,19168,64594,91448,94908,83839,85393,99848,81733,22731,98696,33314,14763,59948,69441,93052,25756,62090,68535,60501,74992,52991,36767,63829,72579,47864,78028,11064,68261,97177,90090,69375,61205,45051,13452,72170,56238,12342,14144,71008,85506,55346,30657,34350,10107,52939,60779,66210,75463,95371,92558,63450,36826,39942,33840,59092,47329,36963,87721,82931,12512,22763,57808,84000,41473,37542,82097,57069,10455,16818,42867,32795,28351,26882,57138,53130,54989,18773,82718,75038,92886,55262,86886,37984,34962,61560,64223,69667,18294,32597,13655,86763,99226,37239,43778,70157,47076,42238,60312,45790,37213,84811,28060,43466,92636,40444,95018,76006,98667,26288,10292,58986,98566,21203,81895,40863,32224,61462,44450,33444,59155,11030,46922,14725,44646,13306,47003,10564,56713,20258,16536,85967,66781,67691,16491,10077,70688,82357,72506,47511,65645,73994,68609,74102,84599,27634,35818,52559,55580,39401,23121,73037,20480,27230}'::text[]))"", 'parent': 25, 'ID': 26}], 'parent': 15, 'ID': 25, 'left': 26}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 25}], 'parent': 13, 'ID': 14, 'left': 15}], 'parent': 12, 'ID': 13, 'left': 14}], 'parent': 3, 'ID': 12, 'left': 13}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 12}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
8,84,"select  c_customer_id as customer_id
       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername
 from customer
     ,customer_address
     ,customer_demographics
     ,household_demographics
     ,income_band
     ,store_returns
 where ca_city	        =  'Union Hill'
   and c_current_addr_sk = ca_address_sk
   and ib_lower_bound   >=  50882
   and ib_upper_bound   <=  50882 + 50000
   and ib_income_band_sk = hd_income_band_sk
   and cd_demo_sk = c_current_cdemo_sk
   and hd_demo_sk = c_current_hdemo_sk
   and sr_cdemo_sk = cd_demo_sk
 order by c_customer_id
 limit 100;

-- end query 64 in stream 0 using template query84.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 121951.72, 'Total Cost': 121963.38, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 121951.72, 'Total Cost': 122145.86, 'Plan Rows': 1664, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 120951.69, 'Total Cost': 120953.77, 'Plan Rows': 832, 'Plan Width': 49, 'Sort Key': ['customer.c_customer_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56527.35, 'Total Cost': 120919.89, 'Plan Rows': 832, 'Plan Width': 49, 'Inner Unique': False, 'Hash Cond': '(store_returns.sr_cdemo_sk = customer_demographics.cd_demo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 4, 'parent': 3, 'ID': 4}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 56520.15, 'Total Cost': 56520.15, 'Plan Rows': 576, 'Plan Width': 77, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 23685.17, 'Total Cost': 56520.15, 'Plan Rows': 576, 'Plan Width': 77, 'Inner Unique': False, 'Hash Cond': '(customer_demographics.cd_demo_sk = customer.c_current_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'customer_demographics', 'Startup Cost': 0.0, 'Total Cost': 29831.33, 'Plan Rows': 800333, 'Plan Width': 4, 'parent': 6, 'ID': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 23677.7, 'Total Cost': 23677.7, 'Plan Rows': 597, 'Plan Width': 73, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 6958.2, 'Total Cost': 23677.7, 'Plan Rows': 597, 'Plan Width': 73, 'Inner Unique': False, 'Hash Cond': '(customer.c_current_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 6748.11, 'Total Cost': 23455.04, 'Plan Rows': 1764, 'Plan Width': 77, 'Inner Unique': False, 'Hash Cond': '(customer.c_current_addr_sk = customer_address.ca_address_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 15918.33, 'Plan Rows': 208333, 'Plan Width': 81, 'parent': 10, 'ID': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 6737.08, 'Total Cost': 6737.08, 'Plan Rows': 882, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 882, 'Plan Width': 4, 'Filter': ""((ca_city)::text = 'Union Hill'::text)"", 'parent': 12, 'ID': 13}], 'parent': 10, 'ID': 12, 'left': 13}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 178.59, 'Total Cost': 178.59, 'Plan Rows': 2520, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1.39, 'Total Cost': 178.59, 'Plan Rows': 2520, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(household_demographics.hd_income_band_sk = income_band.ib_income_band_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 125.0, 'Plan Rows': 7200, 'Plan Width': 8, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1.3, 'Total Cost': 1.3, 'Plan Rows': 7, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'income_band', 'Alias': 'income_band', 'Startup Cost': 0.0, 'Total Cost': 1.3, 'Plan Rows': 7, 'Plan Width': 4, 'Filter': '((ib_lower_bound >= 50882) AND (ib_upper_bound <= 100882))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 9, 'ID': 14, 'left': 15}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 14}], 'parent': 6, 'ID': 8, 'left': 9}], 'parent': 5, 'ID': 6, 'left': 7, 'right': 8}], 'parent': 3, 'ID': 5, 'left': 6}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 5}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
