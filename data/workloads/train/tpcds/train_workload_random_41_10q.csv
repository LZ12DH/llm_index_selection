,Query_id,Query_text,Plan_dump
0,33,"with ss as (
 select
          i_manufact_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id in (select
  i_manufact_id
from
 item
where i_category in ('Books'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2002
 and     d_moy                   = 4
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_manufact_id),
 cs as (
 select
          i_manufact_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id               in (select
  i_manufact_id
from
 item
where i_category in ('Books'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2002
 and     d_moy                   = 4
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_manufact_id),
 ws as (
 select
          i_manufact_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id               in (select
  i_manufact_id
from
 item
where i_category in ('Books'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2002
 and     d_moy                   = 4
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_manufact_id)
  select  i_manufact_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_manufact_id
 order by total_sales
limit 100;

-- end query 21 in stream 1 using template query33.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446095.98, 'Total Cost': 1446096.23, 'Plan Rows': 100, 'Plan Width': 36, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446095.98, 'Total Cost': 1446096.48, 'Plan Rows': 200, 'Plan Width': 36, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445406.01, 'Total Cost': 1446088.33, 'Plan Rows': 200, 'Plan Width': 36, 'Group Key': ['item.i_manufact_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445406.01, 'Total Cost': 1446070.83, 'Plan Rows': 3000, 'Plan Width': 36, 'Sort Key': ['item.i_manufact_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707925.88, 'Total Cost': 708236.6, 'Plan Rows': 1000, 'Plan Width': 36, 'Group Key': ['item.i_manufact_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707925.88, 'Total Cost': 708209.1, 'Plan Rows': 2000, 'Plan Width': 36, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 706925.85, 'Total Cost': 706978.22, 'Plan Rows': 1000, 'Plan Width': 36, 'Group Key': ['item.i_manufact_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 706925.85, 'Total Cost': 706957.57, 'Plan Rows': 1630, 'Plan Width': 10, 'Inner Unique': True, 'Merge Cond': '(item.i_manufact_id = item_1.i_manufact_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698602.31, 'Total Cost': 698606.39, 'Plan Rows': 1634, 'Plan Width': 10, 'Sort Key': ['item.i_manufact_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690959.91, 'Total Cost': 698515.1, 'Plan Rows': 1634, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 8, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690939.49, 'Total Cost': 690939.49, 'Plan Rows': 1634, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684053.54, 'Total Cost': 690939.49, 'Plan Rows': 1634, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2002) AND (d_moy = 4))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8323.55, 'Total Cost': 8326.05, 'Plan Rows': 1000, 'Plan Width': 4, 'Sort Key': ['item_1.i_manufact_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8263.72, 'Total Cost': 8273.72, 'Plan Rows': 1000, 'Plan Width': 4, 'Group Key': ['item_1.i_manufact_id'], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 9887, 'Plan Width': 4, 'Filter': ""(i_category = 'Books'::bpchar)"", 'parent': 20, 'ID': 21}], 'parent': 19, 'ID': 20, 'left': 21}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482335.0, 'Total Cost': 482599.79, 'Plan Rows': 1000, 'Plan Width': 36, 'Group Key': ['item_2.i_manufact_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482335.0, 'Total Cost': 482574.03, 'Plan Rows': 1768, 'Plan Width': 36, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481334.98, 'Total Cost': 481369.94, 'Plan Rows': 884, 'Plan Width': 36, 'Group Key': ['item_2.i_manufact_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 481334.98, 'Total Cost': 481354.47, 'Plan Rows': 884, 'Plan Width': 10, 'Inner Unique': True, 'Merge Cond': '(item_2.i_manufact_id = item_3.i_manufact_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473011.43, 'Total Cost': 473013.65, 'Plan Rows': 886, 'Plan Width': 10, 'Sort Key': ['item_2.i_manufact_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465415.99, 'Total Cost': 472968.06, 'Plan Rows': 886, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 8, 'parent': 27, 'ID': 28}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465404.92, 'Total Cost': 465404.92, 'Plan Rows': 886, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458285.32, 'Total Cost': 465404.92, 'Plan Rows': 886, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 30, 'ID': 31}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 33, 'ID': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2002) AND (d_moy = 4))', 'parent': 35, 'ID': 36}], 'parent': 33, 'ID': 35, 'left': 36}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 35}], 'parent': 30, 'ID': 32, 'left': 33}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 32}], 'parent': 27, 'ID': 29, 'left': 30}], 'parent': 26, 'ID': 27, 'left': 28, 'right': 29}], 'parent': 25, 'ID': 26, 'left': 27}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8323.55, 'Total Cost': 8326.05, 'Plan Rows': 1000, 'Plan Width': 4, 'Sort Key': ['item_3.i_manufact_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8263.72, 'Total Cost': 8273.72, 'Plan Rows': 1000, 'Plan Width': 4, 'Group Key': ['item_3.i_manufact_id'], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 9887, 'Plan Width': 4, 'Filter': ""(i_category = 'Books'::bpchar)"", 'parent': 38, 'ID': 39}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 25, 'ID': 37, 'left': 38}], 'parent': 24, 'ID': 25, 'left': 26, 'right': 37}], 'parent': 23, 'ID': 24, 'left': 25}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 3, 'ID': 22, 'left': 23}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255145.11, 'Total Cost': 255165.64, 'Plan Rows': 1000, 'Plan Width': 36, 'Group Key': ['item_4.i_manufact_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255145.11, 'Total Cost': 255147.79, 'Plan Rows': 1071, 'Plan Width': 10, 'Sort Key': ['item_4.i_manufact_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 247418.84, 'Total Cost': 255091.22, 'Plan Rows': 1071, 'Plan Width': 10, 'Inner Unique': True, 'Hash Cond': '(item_4.i_manufact_id = item_5.i_manufact_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 239132.62, 'Total Cost': 246790.26, 'Plan Rows': 1074, 'Plan Width': 10, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238132.62, 'Total Cost': 245682.86, 'Plan Rows': 448, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 8, 'parent': 44, 'ID': 45}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.02, 'Total Cost': 238127.02, 'Plan Rows': 448, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231056.61, 'Total Cost': 238127.02, 'Plan Rows': 448, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 47, 'ID': 48}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 50, 'ID': 51}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2002) AND (d_moy = 4))', 'parent': 52, 'ID': 53}], 'parent': 50, 'ID': 52, 'left': 53}], 'parent': 49, 'ID': 50, 'left': 51, 'right': 52}], 'parent': 47, 'ID': 49, 'left': 50}], 'parent': 46, 'ID': 47, 'left': 48, 'right': 49}], 'parent': 44, 'ID': 46, 'left': 47}], 'parent': 43, 'ID': 44, 'left': 45, 'right': 46}], 'parent': 42, 'ID': 43, 'left': 44}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8273.72, 'Total Cost': 8273.72, 'Plan Rows': 1000, 'Plan Width': 4, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8263.72, 'Total Cost': 8273.72, 'Plan Rows': 1000, 'Plan Width': 4, 'Group Key': ['item_5.i_manufact_id'], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 9887, 'Plan Width': 4, 'Filter': ""(i_category = 'Books'::bpchar)"", 'parent': 55, 'ID': 56}], 'parent': 54, 'ID': 55, 'left': 56}], 'parent': 42, 'ID': 54, 'left': 55}], 'parent': 41, 'ID': 42, 'left': 43, 'right': 54}], 'parent': 40, 'ID': 41, 'left': 42}], 'parent': 3, 'ID': 40, 'left': 41}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 22}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
1,46,"select  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,amt,profit 
 from
   (select ss_ticket_number
          ,ss_customer_sk
          ,ca_city bought_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics,customer_address 
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk  
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and store_sales.ss_addr_sk = customer_address.ca_address_sk
    and (household_demographics.hd_dep_count = 9 or
         household_demographics.hd_vehicle_count= 0)
    and date_dim.d_dow in (6,0)
    and date_dim.d_year in (1998,1998+1,1998+2) 
    and store.s_city in ('Fairview','Midway','Fairview','Midway','Fairview') 
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr
    where ss_customer_sk = c_customer_sk
      and customer.c_current_addr_sk = current_addr.ca_address_sk
      and current_addr.ca_city <> bought_city
  order by c_last_name
          ,c_first_name
          ,ca_city
          ,bought_city
          ,ss_ticket_number
  limit 100;

-- end query 31 in stream 0 using template query46.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 742749.48, 'Total Cost': 742749.73, 'Plan Rows': 100, 'Plan Width': 138, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 742749.48, 'Total Cost': 742794.81, 'Plan Rows': 18129, 'Plan Width': 138, 'Sort Key': ['customer.c_last_name', 'customer.c_first_name', 'current_addr.ca_city', 'dn.bought_city', 'dn.ss_ticket_number'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 732957.14, 'Total Cost': 742056.61, 'Plan Rows': 18129, 'Plan Width': 138, 'Inner Unique': False, 'Hash Cond': '(current_addr.ca_address_sk = customer.c_current_addr_sk)', 'Join Filter': '((current_addr.ca_city)::text <> (dn.bought_city)::text)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'current_addr', 'Startup Cost': 0.0, 'Total Cost': 7935.0, 'Plan Rows': 250000, 'Plan Width': 13, 'parent': 2, 'ID': 3}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 732730.18, 'Total Cost': 732730.18, 'Plan Rows': 18157, 'Plan Width': 133, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 723861.76, 'Total Cost': 732730.18, 'Plan Rows': 18157, 'Plan Width': 133, 'Inner Unique': False, 'Hash Cond': '(dn.ss_customer_sk = customer.c_customer_sk)', 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'dn', 'Startup Cost': 693404.76, 'Total Cost': 696153.52, 'Plan Rows': 18157, 'Plan Width': 81, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693404.76, 'Total Cost': 695971.95, 'Plan Rows': 18157, 'Plan Width': 85, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693404.76, 'Total Cost': 695397.0, 'Plan Rows': 15130, 'Plan Width': 85, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692404.73, 'Total Cost': 692650.6, 'Plan Rows': 7565, 'Plan Width': 85, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692404.73, 'Total Cost': 692423.65, 'Plan Rows': 7565, 'Plan Width': 30, 'Sort Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 685018.54, 'Total Cost': 691917.35, 'Plan Rows': 7565, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 13, 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 684919.55, 'Total Cost': 684919.55, 'Plan Rows': 7919, 'Plan Width': 21, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2296.61, 'Total Cost': 684919.55, 'Plan Rows': 7919, 'Plan Width': 21, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2289.04, 'Total Cost': 684789.32, 'Plan Rows': 11593, 'Plan Width': 25, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2105.54, 'Total Cost': 684307.63, 'Plan Rows': 48602, 'Plan Width': 29, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 33, 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2103.26, 'Total Cost': 2103.26, 'Plan Rows': 182, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2103.26, 'Plan Rows': 182, 'Plan Width': 4, 'Filter': ""((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1998,1999,2000}'::integer[])))"", 'parent': 18, 'ID': 19}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 161.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Filter': '((hd_dep_count = 9) OR (hd_vehicle_count = 0))', 'parent': 20, 'ID': 21}], 'parent': 15, 'ID': 20, 'left': 21}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 20}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.66, 'Total Cost': 6.66, 'Plan Rows': 73, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.66, 'Plan Rows': 73, 'Plan Width': 4, 'Filter': ""((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Fairview}'::text[]))"", 'parent': 22, 'ID': 23}], 'parent': 14, 'ID': 22, 'left': 23}], 'parent': 13, 'ID': 14, 'left': 15, 'right': 22}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 9, 'ID': 10, 'left': 11}], 'parent': 8, 'ID': 9, 'left': 10}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 18835.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'parent': 24, 'ID': 25}], 'parent': 5, 'ID': 24, 'left': 25}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 24}], 'parent': 2, 'ID': 4, 'left': 5}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 4}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
2,80,"with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-25' as date) 
                  and (cast('2000-08-25' as date) +  interval '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-25' as date)
                  and (cast('2000-08-25' as date) +  interval '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-25' as date)
                  and (cast('2000-08-25' as date) +  interval '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 61 in stream 1 using template query80.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566793.64, 'Total Cost': 1566796.93, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566793.64, 'Total Cost': 1566806.84, 'Plan Rows': 401, 'Plan Width': 160, 'Grouping Sets': [{'Group Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], [""('store channel'::text)""], []]}], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566793.64, 'Total Cost': 1566794.67, 'Plan Rows': 412, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784596.3, 'Total Cost': 1566775.74, 'Plan Rows': 412, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 784596.3, 'Total Cost': 784616.16, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784596.3, 'Total Cost': 784615.39, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784596.3, 'Total Cost': 784612.71, 'Plan Rows': 102, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783596.27, 'Total Cost': 783600.92, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783596.27, 'Total Cost': 783596.9, 'Plan Rows': 250, 'Plan Width': 41, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94489.35, 'Total Cost': 783586.32, 'Plan Rows': 250, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94482.05, 'Total Cost': 783575.54, 'Plan Rows': 262, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94456.65, 'Total Cost': 783546.47, 'Plan Rows': 279, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 86930.88, 'Total Cost': 776001.31, 'Plan Rows': 4860, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-25'::date) AND (d_date <= '2000-09-24 00:00:00'::timestamp without time zone))"", 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 17, 'ID': 18}], 'parent': 12, 'ID': 17, 'left': 18}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 19, 'ID': 20}], 'parent': 11, 'ID': 19, 'left': 20}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 21, 'ID': 22}], 'parent': 10, 'ID': 21, 'left': 22}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 23, 'ID': 24}], 'parent': 9, 'ID': 23, 'left': 24}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 23}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 518177.36, 'Total Cost': 518230.78, 'Plan Rows': 340, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518177.36, 'Total Cost': 518225.68, 'Plan Rows': 340, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518177.36, 'Total Cost': 518214.76, 'Plan Rows': 284, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517177.34, 'Total Cost': 517181.95, 'Plan Rows': 142, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517177.34, 'Total Cost': 517177.69, 'Plan Rows': 142, 'Plan Width': 41, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 57382.33, 'Total Cost': 517172.26, 'Plan Rows': 142, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56864.33, 'Total Cost': 516652.32, 'Plan Rows': 142, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_promo_sk = promotion_1.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56838.93, 'Total Cost': 516624.96, 'Plan Rows': 145, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item_1.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 49313.15, 'Total Cost': 509089.08, 'Plan Rows': 2532, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 34, 'ID': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-25'::date) AND (d_date <= '2000-09-24 00:00:00'::timestamp without time zone))"", 'parent': 36, 'ID': 37}], 'parent': 34, 'ID': 36, 'left': 37}], 'parent': 33, 'ID': 34, 'left': 35, 'right': 36}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 38, 'ID': 39}], 'parent': 33, 'ID': 38, 'left': 39}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 38}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 40, 'ID': 41}], 'parent': 32, 'ID': 40, 'left': 41}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 40}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_1', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 42, 'ID': 43}], 'parent': 31, 'ID': 42, 'left': 43}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 44, 'ID': 45}], 'parent': 30, 'ID': 44, 'left': 45}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 44}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 3, 'ID': 25, 'left': 26}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 263919.04, 'Total Cost': 263926.75, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263919.04, 'Total Cost': 263926.43, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263919.04, 'Total Cost': 263925.33, 'Plan Rows': 42, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262919.01, 'Total Cost': 262920.46, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262919.01, 'Total Cost': 262919.19, 'Plan Rows': 72, 'Plan Width': 41, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32134.74, 'Total Cost': 262916.79, 'Plan Rows': 72, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32130.8, 'Total Cost': 262911.86, 'Plan Rows': 72, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_promo_sk = promotion_2.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32105.4, 'Total Cost': 262885.46, 'Plan Rows': 73, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_item_sk = item_2.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 24579.62, 'Total Cost': 255354.62, 'Plan Rows': 1272, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 55, 'ID': 56}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2000-08-25'::date) AND (d_date <= '2000-09-24 00:00:00'::timestamp without time zone))"", 'parent': 57, 'ID': 58}], 'parent': 55, 'ID': 57, 'left': 58}], 'parent': 54, 'ID': 55, 'left': 56, 'right': 57}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 59, 'ID': 60}], 'parent': 54, 'ID': 59, 'left': 60}], 'parent': 53, 'ID': 54, 'left': 55, 'right': 59}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 61, 'ID': 62}], 'parent': 53, 'ID': 61, 'left': 62}], 'parent': 52, 'ID': 53, 'left': 54, 'right': 61}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_2', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 63, 'ID': 64}], 'parent': 52, 'ID': 63, 'left': 64}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 63}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 65, 'ID': 66}], 'parent': 51, 'ID': 65, 'left': 66}], 'parent': 50, 'ID': 51, 'left': 52, 'right': 65}], 'parent': 49, 'ID': 50, 'left': 51}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}], 'parent': 3, 'ID': 46, 'left': 47}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 25}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
3,68,"select  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,extended_price
       ,extended_tax
       ,list_price
 from (select ss_ticket_number
             ,ss_customer_sk
             ,ca_city bought_city
             ,sum(ss_ext_sales_price) extended_price 
             ,sum(ss_ext_list_price) list_price
             ,sum(ss_ext_tax) extended_tax 
       from store_sales
           ,date_dim
           ,store
           ,household_demographics
           ,customer_address 
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_store_sk = store.s_store_sk  
        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
        and store_sales.ss_addr_sk = customer_address.ca_address_sk
        and date_dim.d_dom between 1 and 2 
        and (household_demographics.hd_dep_count = 4 or
             household_demographics.hd_vehicle_count= 2)
        and date_dim.d_year in (1999,1999+1,1999+2)
        and store.s_city in ('Fairview','Midway')
       group by ss_ticket_number
               ,ss_customer_sk
               ,ss_addr_sk,ca_city) dn
      ,customer
      ,customer_address current_addr
 where ss_customer_sk = c_customer_sk
   and customer.c_current_addr_sk = current_addr.ca_address_sk
   and current_addr.ca_city <> bought_city
 order by c_last_name
         ,ss_ticket_number
 limit 100;

-- end query 50 in stream 2 using template query68.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 737515.7, 'Total Cost': 737515.95, 'Plan Rows': 100, 'Plan Width': 170, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 737515.7, 'Total Cost': 737519.71, 'Plan Rows': 1602, 'Plan Width': 170, 'Sort Key': ['customer.c_last_name', 'dn.ss_ticket_number'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 728561.91, 'Total Cost': 737454.47, 'Plan Rows': 1602, 'Plan Width': 170, 'Inner Unique': False, 'Hash Cond': '(current_addr.ca_address_sk = customer.c_current_addr_sk)', 'Join Filter': '((current_addr.ca_city)::text <> (dn.bought_city)::text)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'current_addr', 'Startup Cost': 0.0, 'Total Cost': 7935.0, 'Plan Rows': 250000, 'Plan Width': 13, 'parent': 2, 'ID': 3}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 728541.85, 'Total Cost': 728541.85, 'Plan Rows': 1605, 'Plan Width': 165, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 722832.67, 'Total Cost': 728541.85, 'Plan Rows': 1605, 'Plan Width': 165, 'Inner Unique': False, 'Hash Cond': '(dn.ss_customer_sk = customer.c_customer_sk)', 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'dn', 'Startup Cost': 692375.67, 'Total Cost': 692632.78, 'Plan Rows': 1605, 'Plan Width': 113, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692375.67, 'Total Cost': 692616.73, 'Plan Rows': 1605, 'Plan Width': 117, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692375.67, 'Total Cost': 692555.19, 'Plan Rows': 1338, 'Plan Width': 117, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 691375.64, 'Total Cost': 691400.73, 'Plan Rows': 669, 'Plan Width': 117, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 691375.64, 'Total Cost': 691377.32, 'Plan Rows': 669, 'Plan Width': 40, 'Sort Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684474.17, 'Total Cost': 691344.25, 'Plan Rows': 669, 'Plan Width': 40, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 13, 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 684465.42, 'Total Cost': 684465.42, 'Plan Rows': 700, 'Plan Width': 31, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2401.34, 'Total Cost': 684465.42, 'Plan Rows': 700, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2394.7, 'Total Cost': 684442.1, 'Plan Rows': 2580, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2211.2, 'Total Cost': 684192.24, 'Plan Rows': 10818, 'Plan Width': 39, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 43, 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2210.69, 'Total Cost': 2210.69, 'Plan Rows': 41, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2210.69, 'Plan Rows': 41, 'Plan Width': 4, 'Filter': ""((d_dom >= 1) AND (d_dom <= 2) AND (d_year = ANY ('{1999,2000,2001}'::integer[])))"", 'parent': 18, 'ID': 19}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 161.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Filter': '((hd_dep_count = 4) OR (hd_vehicle_count = 2))', 'parent': 20, 'ID': 21}], 'parent': 15, 'ID': 20, 'left': 21}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 20}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.28, 'Total Cost': 6.28, 'Plan Rows': 29, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.28, 'Plan Rows': 29, 'Plan Width': 4, 'Filter': ""((s_city)::text = ANY ('{Fairview,Midway}'::text[]))"", 'parent': 22, 'ID': 23}], 'parent': 14, 'ID': 22, 'left': 23}], 'parent': 13, 'ID': 14, 'left': 15, 'right': 22}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 9, 'ID': 10, 'left': 11}], 'parent': 8, 'ID': 9, 'left': 10}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 18835.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'parent': 24, 'ID': 25}], 'parent': 5, 'ID': 24, 'left': 25}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 24}], 'parent': 2, 'ID': 4, 'left': 5}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 4}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
4,80,"with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-07' as date) 
                  and (cast('1999-08-07' as date) +  interval '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-07' as date)
                  and (cast('1999-08-07' as date) +  interval '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('1999-08-07' as date)
                  and (cast('1999-08-07' as date) +  interval '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 61 in stream 2 using template query80.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566786.01, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566795.8, 'Plan Rows': 401, 'Plan Width': 160, 'Grouping Sets': [{'Group Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], [""('store channel'::text)""], []]}], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566783.77, 'Plan Rows': 401, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 1566765.43, 'Plan Rows': 401, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 784591.9, 'Total Cost': 784611.64, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784610.87, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784608.2, 'Plan Rows': 102, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783596.4, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783592.48, 'Plan Rows': 242, 'Plan Width': 41, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94489.35, 'Total Cost': 783582.3, 'Plan Rows': 242, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94482.05, 'Total Cost': 783571.63, 'Plan Rows': 254, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94456.65, 'Total Cost': 783542.68, 'Plan Rows': 270, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 86930.88, 'Total Cost': 775998.13, 'Plan Rows': 4703, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-07'::date) AND (d_date <= '1999-09-06 00:00:00'::timestamp without time zone))"", 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 17, 'ID': 18}], 'parent': 12, 'ID': 17, 'left': 18}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 19, 'ID': 20}], 'parent': 11, 'ID': 19, 'left': 20}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 21, 'ID': 22}], 'parent': 10, 'ID': 21, 'left': 22}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 23, 'ID': 24}], 'parent': 9, 'ID': 23, 'left': 24}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 23}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 518174.1, 'Total Cost': 518225.66, 'Plan Rows': 329, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518220.73, 'Plan Rows': 329, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518210.18, 'Plan Rows': 274, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517178.53, 'Plan Rows': 137, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517174.42, 'Plan Rows': 137, 'Plan Width': 41, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 57382.33, 'Total Cost': 517169.21, 'Plan Rows': 137, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56864.33, 'Total Cost': 516649.32, 'Plan Rows': 138, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_promo_sk = promotion_1.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56838.93, 'Total Cost': 516622.01, 'Plan Rows': 141, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item_1.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 49313.15, 'Total Cost': 509086.46, 'Plan Rows': 2450, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 34, 'ID': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-07'::date) AND (d_date <= '1999-09-06 00:00:00'::timestamp without time zone))"", 'parent': 36, 'ID': 37}], 'parent': 34, 'ID': 36, 'left': 37}], 'parent': 33, 'ID': 34, 'left': 35, 'right': 36}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 38, 'ID': 39}], 'parent': 33, 'ID': 38, 'left': 39}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 38}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 40, 'ID': 41}], 'parent': 32, 'ID': 40, 'left': 41}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 40}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_1', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 42, 'ID': 43}], 'parent': 31, 'ID': 42, 'left': 43}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 44, 'ID': 45}], 'parent': 30, 'ID': 44, 'left': 45}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 44}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 3, 'ID': 25, 'left': 26}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 263918.43, 'Total Cost': 263926.12, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263925.8, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263924.7, 'Plan Rows': 42, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262919.83, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262918.59, 'Plan Rows': 70, 'Plan Width': 41, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32134.74, 'Total Cost': 262916.27, 'Plan Rows': 70, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32130.8, 'Total Cost': 262911.36, 'Plan Rows': 70, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_promo_sk = promotion_2.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32105.4, 'Total Cost': 262884.99, 'Plan Rows': 71, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_item_sk = item_2.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 24579.62, 'Total Cost': 255354.31, 'Plan Rows': 1231, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 55, 'ID': 56}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1999-08-07'::date) AND (d_date <= '1999-09-06 00:00:00'::timestamp without time zone))"", 'parent': 57, 'ID': 58}], 'parent': 55, 'ID': 57, 'left': 58}], 'parent': 54, 'ID': 55, 'left': 56, 'right': 57}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 59, 'ID': 60}], 'parent': 54, 'ID': 59, 'left': 60}], 'parent': 53, 'ID': 54, 'left': 55, 'right': 59}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 61, 'ID': 62}], 'parent': 53, 'ID': 61, 'left': 62}], 'parent': 52, 'ID': 53, 'left': 54, 'right': 61}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_2', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 63, 'ID': 64}], 'parent': 52, 'ID': 63, 'left': 64}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 63}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 65, 'ID': 66}], 'parent': 51, 'ID': 65, 'left': 66}], 'parent': 50, 'ID': 51, 'left': 52, 'right': 65}], 'parent': 49, 'ID': 50, 'left': 51}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}], 'parent': 3, 'ID': 46, 'left': 47}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 25}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
5,56,"with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('ivory','sky','mint'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;

-- end query 40 in stream 4 using template query56.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446131.58, 'Total Cost': 1446131.83, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446131.58, 'Total Cost': 1446132.08, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['(sum((sum(store_sales.ss_ext_sales_price))))', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445992.02, 'Total Cost': 1446123.93, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1445992.02, 'Total Cost': 1446118.51, 'Plan Rows': 584, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708186.6, 'Total Cost': 708253.6, 'Plan Rows': 322, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708186.6, 'Total Cost': 708247.57, 'Plan Rows': 268, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707186.58, 'Total Cost': 707216.61, 'Plan Rows': 134, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707186.58, 'Total Cost': 707214.26, 'Plan Rows': 134, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698608.76, 'Total Cost': 698612.98, 'Plan Rows': 1689, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690962.79, 'Total Cost': 698518.21, 'Plan Rows': 1689, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690941.68, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684055.5, 'Total Cost': 690941.68, 'Plan Rows': 1689, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8577.82, 'Total Cost': 8586.77, 'Plan Rows': 3580, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482592.63, 'Total Cost': 482636.97, 'Plan Rows': 174, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482592.63, 'Total Cost': 482633.72, 'Plan Rows': 144, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 481592.6, 'Total Cost': 481617.07, 'Plan Rows': 72, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 481592.6, 'Total Cost': 481615.81, 'Plan Rows': 72, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 473014.78, 'Total Cost': 473017.07, 'Plan Rows': 916, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465417.52, 'Total Cost': 472969.72, 'Plan Rows': 916, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 26, 'ID': 27}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465406.07, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458286.35, 'Total Cost': 465406.07, 'Plan Rows': 916, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 26, 'ID': 28, 'left': 29}], 'parent': 25, 'ID': 26, 'left': 27, 'right': 28}], 'parent': 24, 'ID': 25, 'left': 26}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8577.82, 'Total Cost': 8586.77, 'Plan Rows': 3580, 'Plan Width': 17, 'Sort Key': ['item_3.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 36, 'ID': 37}], 'parent': 24, 'ID': 36, 'left': 37}], 'parent': 23, 'ID': 24, 'left': 25, 'right': 36}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255212.77, 'Total Cost': 255214.53, 'Plan Rows': 88, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255212.77, 'Total Cost': 255212.99, 'Plan Rows': 88, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 247544.63, 'Total Cost': 255209.92, 'Plan Rows': 88, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 239133.38, 'Total Cost': 246794.67, 'Plan Rows': 1110, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238133.38, 'Total Cost': 245683.67, 'Plan Rows': 462, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 42, 'ID': 43}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238127.6, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231057.12, 'Total Cost': 238127.6, 'Plan Rows': 462, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 37882, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-5'::numeric)"", 'parent': 45, 'ID': 46}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 48, 'ID': 49}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 1998) AND (d_moy = 5))', 'parent': 50, 'ID': 51}], 'parent': 48, 'ID': 50, 'left': 51}], 'parent': 47, 'ID': 48, 'left': 49, 'right': 50}], 'parent': 45, 'ID': 47, 'left': 48}], 'parent': 44, 'ID': 45, 'left': 46, 'right': 47}], 'parent': 42, 'ID': 44, 'left': 45}], 'parent': 41, 'ID': 42, 'left': 43, 'right': 44}], 'parent': 40, 'ID': 41, 'left': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8366.5, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8366.5, 'Plan Rows': 3580, 'Plan Width': 17, 'Filter': ""(i_color = ANY ('{ivory,sky,mint}'::bpchar[]))"", 'parent': 52, 'ID': 53}], 'parent': 40, 'ID': 52, 'left': 53}], 'parent': 39, 'ID': 40, 'left': 41, 'right': 52}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 3, 'ID': 38, 'left': 39}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
6,58,"with ss_items as
 (select i_item_id item_id
        ,sum(ss_ext_sales_price) ss_item_rev 
 from store_sales
     ,item
     ,date_dim
 where ss_item_sk = i_item_sk
   and d_date in (select d_date
                  from date_dim
                  where d_week_seq = (select d_week_seq 
                                      from date_dim
                                      where d_date = '2000-05-19'))
   and ss_sold_date_sk   = d_date_sk
 group by i_item_id),
 cs_items as
 (select i_item_id item_id
        ,sum(cs_ext_sales_price) cs_item_rev
  from catalog_sales
      ,item
      ,date_dim
 where cs_item_sk = i_item_sk
  and  d_date in (select d_date
                  from date_dim
                  where d_week_seq = (select d_week_seq 
                                      from date_dim
                                      where d_date = '2000-05-19'))
  and  cs_sold_date_sk = d_date_sk
 group by i_item_id),
 ws_items as
 (select i_item_id item_id
        ,sum(ws_ext_sales_price) ws_item_rev
  from web_sales
      ,item
      ,date_dim
 where ws_item_sk = i_item_sk
  and  d_date in (select d_date
                  from date_dim
                  where d_week_seq =(select d_week_seq 
                                     from date_dim
                                     where d_date = '2000-05-19'))
  and ws_sold_date_sk   = d_date_sk
 group by i_item_id)
  select  ss_items.item_id
       ,ss_item_rev
       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev
       ,cs_item_rev
       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev
       ,ws_item_rev
       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev
       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average
 from ss_items,cs_items,ws_items
 where ss_items.item_id=cs_items.item_id
   and ss_items.item_id=ws_items.item_id 
   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev
   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev
   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev
   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev
   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev
   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev
 order by item_id
         ,ss_item_rev
 limit 100;

-- end query 42 in stream 2 using template query58.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1412339.33, 'Total Cost': 1412339.33, 'Plan Rows': 1, 'Plan Width': 241, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1412339.33, 'Total Cost': 1412339.33, 'Plan Rows': 1, 'Plan Width': 241, 'Sort Key': ['item.i_item_id', '(sum(store_sales.ss_ext_sales_price))'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1411497.09, 'Total Cost': 1412339.32, 'Plan Rows': 1, 'Plan Width': 241, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_2.i_item_id)', 'Join Filter': '(((sum(store_sales.ss_ext_sales_price)) >= (0.9 * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) <= (1.1 * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) >= (0.9 * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) <= (1.1 * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) >= (0.9 * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) <= (1.1 * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) >= (0.9 * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) <= (1.1 * (sum(store_sales.ss_ext_sales_price)))))', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 696753.06, 'Total Cost': 697077.89, 'Plan Rows': 2634, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'InitPlan 1 (returns $0)', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_6', 'Startup Cost': 0.0, 'Total Cost': 2318.11, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(d_date = '2000-05-19'::date)"", 'parent': 3, 'ID': 4}, {'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 694434.95, 'Total Cost': 694710.38, 'Plan Rows': 2196, 'Plan Width': 49, 'Workers Planned': 2, 'Params Evaluated': ['$0'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693434.92, 'Total Cost': 693456.88, 'Plan Rows': 1098, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693434.92, 'Total Cost': 693437.67, 'Plan Rows': 1098, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 685826.52, 'Total Cost': 693379.47, 'Plan Rows': 1098, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 8, 'ID': 9}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 685812.79, 'Total Cost': 685812.79, 'Plan Rows': 1098, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 3889.77, 'Total Cost': 685812.79, 'Plan Rows': 1098, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 14, 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 3889.72, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 1942.17, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(date_dim.d_date = date_dim_1.d_date)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 14, 'ID': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Filter': '(d_week_seq = $0)', 'parent': 16, 'ID': 17}], 'parent': 14, 'ID': 16, 'left': 17}], 'parent': 13, 'ID': 14, 'left': 15, 'right': 16}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 8, 'ID': 10, 'left': 11}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 10}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 3, 'ID': 5, 'left': 6}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 5}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 714744.03, 'Total Cost': 715186.59, 'Plan Rows': 58, 'Plan Width': 98, 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 714744.03, 'Total Cost': 715186.44, 'Plan Rows': 58, 'Plan Width': 98, 'Inner Unique': True, 'Merge Cond': '(item_1.i_item_id = item_2.i_item_id)', 'Join Filter': '(((sum(catalog_sales.cs_ext_sales_price)) >= (0.9 * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) <= (1.1 * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) >= (0.9 * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) <= (1.1 * (sum(catalog_sales.cs_ext_sales_price)))))', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 243758.54, 'Total Cost': 243843.73, 'Plan Rows': 690, 'Plan Width': 49, 'Group Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'InitPlan 3 (returns $2)', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_8', 'Startup Cost': 0.0, 'Total Cost': 2318.11, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(d_date = '2000-05-19'::date)"", 'parent': 20, 'ID': 21}, {'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 241440.43, 'Total Cost': 241512.67, 'Plan Rows': 576, 'Plan Width': 49, 'Workers Planned': 2, 'Params Evaluated': ['$2'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 240440.4, 'Total Cost': 240446.16, 'Plan Rows': 288, 'Plan Width': 49, 'Group Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 240440.4, 'Total Cost': 240441.12, 'Plan Rows': 288, 'Plan Width': 23, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 232879.06, 'Total Cost': 240428.64, 'Plan Rows': 288, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_1.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 25, 'ID': 26}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 232875.46, 'Total Cost': 232875.46, 'Plan Rows': 288, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 3889.77, 'Total Cost': 232875.46, 'Plan Rows': 288, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 14, 'parent': 28, 'ID': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 3889.72, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 1942.17, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(date_dim_2.d_date = date_dim_3.d_date)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 31, 'ID': 32}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_3', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Filter': '(d_week_seq = $2)', 'parent': 33, 'ID': 34}], 'parent': 31, 'ID': 33, 'left': 34}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 33}], 'parent': 28, 'ID': 30, 'left': 31}], 'parent': 27, 'ID': 28, 'left': 29, 'right': 30}], 'parent': 25, 'ID': 27, 'left': 28}], 'parent': 24, 'ID': 25, 'left': 26, 'right': 27}], 'parent': 23, 'ID': 24, 'left': 25}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 22, 'left': 23}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 22}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 470985.5, 'Total Cost': 471171.86, 'Plan Rows': 1372, 'Plan Width': 49, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 470985.5, 'Total Cost': 471154.71, 'Plan Rows': 1372, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'InitPlan 2 (returns $1)', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_7', 'Startup Cost': 0.0, 'Total Cost': 2318.11, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(d_date = '2000-05-19'::date)"", 'parent': 36, 'ID': 37}, {'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 468667.38, 'Total Cost': 468810.87, 'Plan Rows': 1144, 'Plan Width': 49, 'Workers Planned': 2, 'Params Evaluated': ['$1'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 467667.36, 'Total Cost': 467678.8, 'Plan Rows': 572, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 467667.36, 'Total Cost': 467668.79, 'Plan Rows': 572, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 460090.41, 'Total Cost': 467641.16, 'Plan Rows': 572, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 41, 'ID': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 460083.26, 'Total Cost': 460083.26, 'Plan Rows': 572, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 3889.77, 'Total Cost': 460083.26, 'Plan Rows': 572, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_4.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 14, 'parent': 44, 'ID': 45}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 3889.72, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 1942.17, 'Total Cost': 3889.72, 'Plan Rows': 4, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(date_dim_4.d_date = date_dim_5.d_date)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_4', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 47, 'ID': 48}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_5', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 4, 'Plan Width': 4, 'Filter': '(d_week_seq = $1)', 'parent': 49, 'ID': 50}], 'parent': 47, 'ID': 49, 'left': 50}], 'parent': 46, 'ID': 47, 'left': 48, 'right': 49}], 'parent': 44, 'ID': 46, 'left': 47}], 'parent': 43, 'ID': 44, 'left': 45, 'right': 46}], 'parent': 41, 'ID': 43, 'left': 44}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 43}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 36, 'ID': 38, 'left': 39}], 'parent': 35, 'ID': 36, 'left': 37, 'right': 38}], 'parent': 19, 'ID': 35, 'left': 36}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 35}], 'parent': 2, 'ID': 18, 'left': 19}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 18}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
7,77,"with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from store_sales,
      date_dim,
      store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date) 
                  and (cast('2002-08-09' as date) +  interval '30 days') 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from store_returns,
      date_dim,
      store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date)
                  and (cast('2002-08-09' as date) +  interval '30 days')
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from catalog_sales,
      date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date)
                  and (cast('2002-08-09' as date) +  interval '30 days')
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from catalog_returns,
      date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date)
                  and (cast('2002-08-09' as date) +  interval '30 days')
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from web_sales,
      date_dim,
      web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date)
                  and (cast('2002-08-09' as date) +  interval '30 days')
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from web_returns,
      date_dim,
      web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2002-08-09' as date)
                  and (cast('2002-08-09' as date) +  interval '30 days')
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 58 in stream 2 using template query77.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1505270.88, 'Total Cost': 1505271.13, 'Plan Rows': 100, 'Plan Width': 132, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1505270.88, 'Total Cost': 1505271.88, 'Plan Rows': 401, 'Plan Width': 132, 'Sort Key': [""('store channel'::text)"", 'store.s_store_sk'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Mixed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 752766.62, 'Total Cost': 1505255.55, 'Plan Rows': 401, 'Plan Width': 132, 'Grouping Sets': [{'Hash Keys': [[""('store channel'::text)"", 'store.s_store_sk']]}, {'Hash Keys': [[""('store channel'::text)""]]}, {'Group Keys': [[]]}], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 752766.62, 'Total Cost': 1505222.2, 'Plan Rows': 878, 'Plan Width': 132, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 752766.62, 'Total Cost': 752969.37, 'Plan Rows': 102, 'Plan Width': 132, 'Inner Unique': True, 'Merge Cond': '(store.s_store_sk = store_1.s_store_sk)', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685301.79, 'Total Cost': 685458.49, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685301.79, 'Total Cost': 685454.41, 'Plan Rows': 204, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684301.77, 'Total Cost': 684430.84, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684301.77, 'Total Cost': 684394.53, 'Plan Rows': 4638, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684292.35, 'Total Cost': 684304.5, 'Plan Rows': 4860, 'Plan Width': 16, 'Sort Key': ['store_sales.ss_store_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4860, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 20, 'parent': 10, 'ID': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 12, 'ID': 13}], 'parent': 10, 'ID': 12, 'left': 13}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 12}], 'parent': 8, 'ID': 9, 'left': 10}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 9.42, 'Total Cost': 9.68, 'Plan Rows': 102, 'Plan Width': 4, 'Sort Key': ['store.s_store_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 4, 'parent': 14, 'ID': 15}], 'parent': 8, 'ID': 14, 'left': 15}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 14}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 67464.83, 'Total Cost': 67507.05, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 67464.83, 'Total Cost': 67502.97, 'Plan Rows': 204, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 66464.8, 'Total Cost': 66479.4, 'Plan Rows': 102, 'Plan Width': 68, 'Group Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 66464.8, 'Total Cost': 66474.3, 'Plan Rows': 475, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(store_returns.sr_store_sk = store_1.s_store_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 66455.38, 'Total Cost': 66456.61, 'Plan Rows': 492, 'Plan Width': 16, 'Sort Key': ['store_returns.sr_store_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 66433.38, 'Plan Rows': 492, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(store_returns.sr_returned_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 21, 'ID': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 23, 'ID': 24}], 'parent': 21, 'ID': 23, 'left': 24}], 'parent': 20, 'ID': 21, 'left': 22, 'right': 23}], 'parent': 19, 'ID': 20, 'left': 21}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 9.42, 'Total Cost': 9.68, 'Plan Rows': 102, 'Plan Width': 4, 'Sort Key': ['store_1.s_store_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store_1', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 4, 'parent': 25, 'ID': 26}], 'parent': 19, 'ID': 25, 'left': 26}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 25}], 'parent': 17, 'ID': 18, 'left': 19}], 'parent': 16, 'ID': 17, 'left': 18}], 'parent': 4, 'ID': 16, 'left': 17}], 'parent': 3, 'ID': 4, 'left': 5, 'right': 16}, {'Node Type': 'Nested Loop', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 499457.89, 'Total Cost': 499508.66, 'Plan Rows': 576, 'Plan Width': 132, 'Inner Unique': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 459397.86, 'Total Cost': 459430.04, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 459397.86, 'Total Cost': 459429.08, 'Plan Rows': 48, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 458397.83, 'Total Cost': 458423.51, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 458397.83, 'Total Cost': 458404.16, 'Plan Rows': 2532, 'Plan Width': 16, 'Sort Key': ['catalog_sales.cs_call_center_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2532, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 20, 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 30, 'ID': 31, 'left': 32}], 'parent': 29, 'ID': 30, 'left': 31}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40069.8, 'Plan Rows': 24, 'Plan Width': 64, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'cr', 'Startup Cost': 40060.03, 'Total Cost': 40069.68, 'Plan Rows': 24, 'Plan Width': 64, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40069.44, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 40060.03, 'Total Cost': 40068.48, 'Plan Rows': 48, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 39060.01, 'Total Cost': 39062.92, 'Plan Rows': 24, 'Plan Width': 68, 'Group Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 39060.01, 'Total Cost': 39060.65, 'Plan Rows': 255, 'Plan Width': 16, 'Sort Key': ['catalog_returns.cr_call_center_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 39049.82, 'Plan Rows': 255, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(catalog_returns.cr_returned_date_sk = date_dim_3.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 42, 'ID': 43}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_3', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 44, 'ID': 45}], 'parent': 42, 'ID': 44, 'left': 45}], 'parent': 41, 'ID': 42, 'left': 43, 'right': 44}], 'parent': 40, 'ID': 41, 'left': 42}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 36, 'ID': 37, 'left': 38}], 'parent': 27, 'ID': 36, 'left': 37}], 'parent': 3, 'ID': 27, 'left': 28, 'right': 36}, {'Node Type': 'Merge Join', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 252593.32, 'Total Cost': 252731.0, 'Plan Rows': 200, 'Plan Width': 132, 'Inner Unique': True, 'Merge Cond': '(web_page.wp_web_page_sk = web_page_1.wp_web_page_sk)', 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 232121.48, 'Total Cost': 232213.63, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 232121.48, 'Total Cost': 232205.63, 'Plan Rows': 400, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 231121.45, 'Total Cost': 231159.43, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231121.45, 'Total Cost': 231146.89, 'Plan Rows': 1272, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 231106.81, 'Total Cost': 231109.99, 'Plan Rows': 1272, 'Plan Width': 16, 'Sort Key': ['web_sales.ws_web_page_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1272, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_4.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 20, 'parent': 52, 'ID': 53}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_4', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 54, 'ID': 55}], 'parent': 52, 'ID': 54, 'left': 55}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 54}], 'parent': 50, 'ID': 51, 'left': 52}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 14.64, 'Total Cost': 15.14, 'Plan Rows': 200, 'Plan Width': 4, 'Sort Key': ['web_page.wp_web_page_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_page', 'Alias': 'web_page', 'Startup Cost': 0.0, 'Total Cost': 7.0, 'Plan Rows': 200, 'Plan Width': 4, 'parent': 56, 'ID': 57}], 'parent': 50, 'ID': 56, 'left': 57}], 'parent': 49, 'ID': 50, 'left': 51, 'right': 56}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 20471.84, 'Total Cost': 20509.87, 'Plan Rows': 200, 'Plan Width': 68, 'Group Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 20471.84, 'Total Cost': 20503.97, 'Plan Rows': 232, 'Plan Width': 68, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19471.82, 'Total Cost': 19477.17, 'Plan Rows': 116, 'Plan Width': 68, 'Group Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 19471.82, 'Total Cost': 19474.56, 'Plan Rows': 116, 'Plan Width': 16, 'Inner Unique': False, 'Merge Cond': '(web_returns.wr_web_page_sk = web_page_1.wp_web_page_sk)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19457.18, 'Total Cost': 19457.48, 'Plan Rows': 121, 'Plan Width': 16, 'Sort Key': ['web_returns.wr_web_page_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 19452.99, 'Plan Rows': 121, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(web_returns.wr_returned_date_sk = date_dim_5.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 63, 'ID': 64}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_5', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '2002-08-09'::date) AND (d_date <= '2002-09-08 00:00:00'::timestamp without time zone))"", 'parent': 65, 'ID': 66}], 'parent': 63, 'ID': 65, 'left': 66}], 'parent': 62, 'ID': 63, 'left': 64, 'right': 65}], 'parent': 61, 'ID': 62, 'left': 63}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 14.64, 'Total Cost': 15.14, 'Plan Rows': 200, 'Plan Width': 4, 'Sort Key': ['web_page_1.wp_web_page_sk'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_page', 'Alias': 'web_page_1', 'Startup Cost': 0.0, 'Total Cost': 7.0, 'Plan Rows': 200, 'Plan Width': 4, 'parent': 67, 'ID': 68}], 'parent': 61, 'ID': 67, 'left': 68}], 'parent': 60, 'ID': 61, 'left': 62, 'right': 67}], 'parent': 59, 'ID': 60, 'left': 61}], 'parent': 58, 'ID': 59, 'left': 60}], 'parent': 46, 'ID': 58, 'left': 59}], 'parent': 3, 'ID': 46, 'left': 47, 'right': 58}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 27}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
8,80,"with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date) 
                  and (cast('1998-08-19' as date) +  interval '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date)
                  and (cast('1998-08-19' as date) +  interval '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date)
                  and (cast('1998-08-19' as date) +  interval '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 61 in stream 0 using template query80.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566786.01, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566795.8, 'Plan Rows': 401, 'Plan Width': 160, 'Grouping Sets': [{'Group Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], [""('store channel'::text)""], []]}], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566783.77, 'Plan Rows': 401, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 1566765.43, 'Plan Rows': 401, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 784591.9, 'Total Cost': 784611.64, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784610.87, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784608.2, 'Plan Rows': 102, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783596.4, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783592.48, 'Plan Rows': 242, 'Plan Width': 41, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94489.35, 'Total Cost': 783582.3, 'Plan Rows': 242, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94482.05, 'Total Cost': 783571.63, 'Plan Rows': 254, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94456.65, 'Total Cost': 783542.68, 'Plan Rows': 270, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 86930.88, 'Total Cost': 775998.13, 'Plan Rows': 4703, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 17, 'ID': 18}], 'parent': 12, 'ID': 17, 'left': 18}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 19, 'ID': 20}], 'parent': 11, 'ID': 19, 'left': 20}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 21, 'ID': 22}], 'parent': 10, 'ID': 21, 'left': 22}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 23, 'ID': 24}], 'parent': 9, 'ID': 23, 'left': 24}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 23}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 518174.1, 'Total Cost': 518225.66, 'Plan Rows': 329, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518220.73, 'Plan Rows': 329, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518210.18, 'Plan Rows': 274, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517178.53, 'Plan Rows': 137, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517174.42, 'Plan Rows': 137, 'Plan Width': 41, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 57382.33, 'Total Cost': 517169.21, 'Plan Rows': 137, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56864.33, 'Total Cost': 516649.32, 'Plan Rows': 138, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_promo_sk = promotion_1.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56838.93, 'Total Cost': 516622.01, 'Plan Rows': 141, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item_1.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 49313.15, 'Total Cost': 509086.46, 'Plan Rows': 2450, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 34, 'ID': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 36, 'ID': 37}], 'parent': 34, 'ID': 36, 'left': 37}], 'parent': 33, 'ID': 34, 'left': 35, 'right': 36}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 38, 'ID': 39}], 'parent': 33, 'ID': 38, 'left': 39}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 38}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 40, 'ID': 41}], 'parent': 32, 'ID': 40, 'left': 41}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 40}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_1', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 42, 'ID': 43}], 'parent': 31, 'ID': 42, 'left': 43}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 44, 'ID': 45}], 'parent': 30, 'ID': 44, 'left': 45}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 44}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 3, 'ID': 25, 'left': 26}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 263918.43, 'Total Cost': 263926.12, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263925.8, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263924.7, 'Plan Rows': 42, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262919.83, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262918.59, 'Plan Rows': 70, 'Plan Width': 41, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32134.74, 'Total Cost': 262916.27, 'Plan Rows': 70, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32130.8, 'Total Cost': 262911.36, 'Plan Rows': 70, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_promo_sk = promotion_2.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32105.4, 'Total Cost': 262884.99, 'Plan Rows': 71, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_item_sk = item_2.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 24579.62, 'Total Cost': 255354.31, 'Plan Rows': 1231, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 55, 'ID': 56}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 57, 'ID': 58}], 'parent': 55, 'ID': 57, 'left': 58}], 'parent': 54, 'ID': 55, 'left': 56, 'right': 57}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 59, 'ID': 60}], 'parent': 54, 'ID': 59, 'left': 60}], 'parent': 53, 'ID': 54, 'left': 55, 'right': 59}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 61, 'ID': 62}], 'parent': 53, 'ID': 61, 'left': 62}], 'parent': 52, 'ID': 53, 'left': 54, 'right': 61}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_2', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 63, 'ID': 64}], 'parent': 52, 'ID': 63, 'left': 64}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 63}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 65, 'ID': 66}], 'parent': 51, 'ID': 65, 'left': 66}], 'parent': 50, 'ID': 51, 'left': 52, 'right': 65}], 'parent': 49, 'ID': 50, 'left': 51}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}], 'parent': 3, 'ID': 46, 'left': 47}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 25}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
