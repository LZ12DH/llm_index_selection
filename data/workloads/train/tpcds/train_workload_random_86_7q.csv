,Query_id,Query_text,Plan_dump
0,79,"select 
  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit
  from
   (select ss_ticket_number
          ,ss_customer_sk
          ,store.s_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk  
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count > 3)
    and date_dim.d_dow = 1
    and date_dim.d_year in (2000,2000+1,2000+2) 
    and store.s_number_employees between 200 and 295
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer
    where ss_customer_sk = c_customer_sk
 order by c_last_name,c_first_name,substr(s_city,1,30), profit
limit 100;

-- end query 60 in stream 2 using template query79.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 723642.22, 'Total Cost': 723642.47, 'Plan Rows': 100, 'Plan Width': 152, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 723642.22, 'Total Cost': 723673.2, 'Plan Rows': 12394, 'Plan Width': 152, 'Sort Key': ['customer.c_last_name', 'customer.c_first_name', '(substr((ms.s_city)::text, 1, 30))', 'ms.profit'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 715867.78, 'Total Cost': 723168.53, 'Plan Rows': 12394, 'Plan Width': 152, 'Inner Unique': False, 'Hash Cond': '(ms.ss_customer_sk = customer.c_customer_sk)', 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ms', 'Startup Cost': 685899.78, 'Total Cost': 687776.13, 'Plan Rows': 12394, 'Plan Width': 82, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685899.78, 'Total Cost': 687652.19, 'Plan Rows': 12394, 'Plan Width': 86, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'store.s_city'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 685899.78, 'Total Cost': 687259.72, 'Plan Rows': 10328, 'Plan Width': 86, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684899.76, 'Total Cost': 685067.59, 'Plan Rows': 5164, 'Plan Width': 86, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'store.s_city'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 684899.76, 'Total Cost': 684912.67, 'Plan Rows': 5164, 'Plan Width': 31, 'Sort Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'store.s_city'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2295.62, 'Total Cost': 684581.29, 'Plan Rows': 5164, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2287.91, 'Total Cost': 684499.92, 'Plan Rows': 5871, 'Plan Width': 25, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2104.41, 'Total Cost': 684165.41, 'Plan Rows': 24615, 'Plan Width': 29, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 33, 'parent': 10, 'ID': 11}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2103.26, 'Total Cost': 2103.26, 'Plan Rows': 92, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2103.26, 'Plan Rows': 92, 'Plan Width': 4, 'Filter': ""((d_dow = 1) AND (d_year = ANY ('{2000,2001,2002}'::integer[])))"", 'parent': 12, 'ID': 13}], 'parent': 10, 'ID': 12, 'left': 13}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 161.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Filter': '((hd_dep_count = 4) OR (hd_vehicle_count > 3))', 'parent': 14, 'ID': 15}], 'parent': 9, 'ID': 14, 'left': 15}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.53, 'Total Cost': 6.53, 'Plan Rows': 94, 'Plan Width': 14, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.53, 'Plan Rows': 94, 'Plan Width': 14, 'Filter': '((s_number_employees >= 200) AND (s_number_employees <= 295))', 'parent': 16, 'ID': 17}], 'parent': 8, 'ID': 16, 'left': 17}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 16}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}], 'parent': 2, 'ID': 3, 'left': 4}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 18835.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 56, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 56, 'parent': 18, 'ID': 19}], 'parent': 2, 'ID': 18, 'left': 19}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 18}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
1,72,"select  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity 
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '501-1000'
  and d1.d_year = 2001
  and cd_marital_status = 'M'
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;

-- end query 54 in stream 4 using template query72.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059177.32, 'Total Cost': 2059177.43, 'Plan Rows': 41, 'Plan Width': 147, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059177.32, 'Total Cost': 2059177.43, 'Plan Rows': 41, 'Plan Width': 147, 'Sort Key': ['(count(*)) DESC', 'item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059175.1, 'Total Cost': 2059176.23, 'Plan Rows': 41, 'Plan Width': 147, 'Group Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2059175.1, 'Total Cost': 2059175.2, 'Plan Rows': 41, 'Plan Width': 127, 'Sort Key': ['item.i_item_desc', 'warehouse.w_warehouse_name', 'd1.d_week_seq'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 2004901.63, 'Total Cost': 2059174.0, 'Plan Rows': 41, 'Plan Width': 127, 'Inner Unique': False, 'Join Filter': '(catalog_sales.cs_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Right', 'Startup Cost': 2004901.63, 'Total Cost': 2058847.25, 'Plan Rows': 41, 'Plan Width': 127, 'Inner Unique': False, 'Hash Cond': '((catalog_returns.cr_item_sk = catalog_sales.cs_item_sk) AND (catalog_returns.cr_order_number = catalog_sales.cs_order_number))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 43147.49, 'Plan Rows': 1439749, 'Plan Width': 8, 'parent': 5, 'ID': 6}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2004901.02, 'Total Cost': 2004901.02, 'Plan Rows': 41, 'Plan Width': 135, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 508628.04, 'Total Cost': 2004901.02, 'Plan Rows': 41, 'Plan Width': 135, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_ship_date_sk = d3.d_date_sk)', 'Join Filter': '(d3.d_date > (d1.d_date + 5))', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505579.43, 'Total Cost': 2001850.1, 'Plan Rows': 124, 'Plan Width': 143, 'Inner Unique': False, 'Join Filter': '(inventory.inv_warehouse_sk = warehouse.w_warehouse_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 505579.43, 'Total Cost': 2001830.38, 'Plan Rows': 124, 'Plan Width': 130, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 494626.43, 'Total Cost': 1989179.68, 'Plan Rows': 124, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 493626.43, 'Total Cost': 1988167.28, 'Plan Rows': 52, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '((inventory.inv_date_sk = d2.d_date_sk) AND (d1.d_week_seq = d2.d_week_seq))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 491147.18, 'Total Cost': 1981661.29, 'Plan Rows': 536858, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(inventory.inv_item_sk = catalog_sales.cs_item_sk)', 'Join Filter': '(inventory.inv_quantity_on_hand < catalog_sales.cs_quantity)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'inventory', 'Alias': 'inventory', 'Startup Cost': 0.0, 'Total Cost': 1274139.37, 'Plan Rows': 55462537, 'Plan Width': 16, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 491134.8, 'Total Cost': 491134.8, 'Plan Rows': 991, 'Plan Width': 28, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458688.15, 'Total Cost': 491134.8, 'Plan Rows': 991, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(customer_demographics.cd_demo_sk = catalog_sales.cs_bill_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'customer_demographics', 'Startup Cost': 0.0, 'Total Cost': 31832.17, 'Plan Rows': 162761, 'Plan Width': 4, 'Filter': ""(cd_marital_status = 'M'::bpchar)"", 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458626.88, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2102.79, 'Total Cost': 458626.88, 'Plan Rows': 4901, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_bill_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = d1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 20, 'ID': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd1', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 12, 'Filter': '(d_year = 2001)', 'parent': 22, 'ID': 23}], 'parent': 20, 'ID': 22, 'left': 23}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 22}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 143.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 143.0, 'Plan Rows': 1200, 'Plan Width': 4, 'Filter': ""(hd_buy_potential = '501-1000'::bpchar)"", 'parent': 24, 'ID': 25}], 'parent': 19, 'ID': 24, 'left': 25}], 'parent': 18, 'ID': 19, 'left': 20, 'right': 24}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1834.7, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd2', 'Startup Cost': 0.0, 'Total Cost': 1834.7, 'Plan Rows': 42970, 'Plan Width': 8, 'parent': 26, 'ID': 27}], 'parent': 12, 'ID': 26, 'left': 27}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 26}], 'parent': 10, 'ID': 11, 'left': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 7984.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7984.0, 'Plan Rows': 102000, 'Plan Width': 106, 'parent': 28, 'ID': 29}], 'parent': 10, 'ID': 28, 'left': 29}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 28}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 1.15, 'Plan Rows': 10, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'warehouse', 'Alias': 'warehouse', 'Startup Cost': 0.0, 'Total Cost': 1.1, 'Plan Rows': 10, 'Plan Width': 21, 'parent': 30, 'ID': 31}], 'parent': 9, 'ID': 30, 'left': 31}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 2135.49, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'd3', 'Startup Cost': 0.0, 'Total Cost': 2135.49, 'Plan Rows': 73049, 'Plan Width': 8, 'parent': 32, 'ID': 33}], 'parent': 8, 'ID': 32, 'left': 33}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 32}], 'parent': 5, 'ID': 7, 'left': 8}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 7}, {'Node Type': 'Materialize', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 0.0, 'Total Cost': 20.5, 'Plan Rows': 500, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 18.0, 'Plan Rows': 500, 'Plan Width': 4, 'parent': 34, 'ID': 35}], 'parent': 4, 'ID': 34, 'left': 35}], 'parent': 3, 'ID': 4, 'left': 5, 'right': 34}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
2,18,"select  i_item_id,
        ca_country,
        ca_state, 
        ca_county,
        avg( cast(cs_quantity as decimal(12,2))) agg1,
        avg( cast(cs_list_price as decimal(12,2))) agg2,
        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,
        avg( cast(cs_sales_price as decimal(12,2))) agg4,
        avg( cast(cs_net_profit as decimal(12,2))) agg5,
        avg( cast(c_birth_year as decimal(12,2))) agg6,
        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7
 from catalog_sales, customer_demographics cd1, 
      customer_demographics cd2, customer, customer_address, date_dim, item
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd1.cd_demo_sk and
       cs_bill_customer_sk = c_customer_sk and
       cd1.cd_gender = 'F' and 
       cd1.cd_education_status = 'College' and
       c_current_cdemo_sk = cd2.cd_demo_sk and
       c_current_addr_sk = ca_address_sk and
       c_birth_month in (5,11,9,3,8,1) and
       d_year = 2001 and
       ca_state in ('CO','TX','SD'
                   ,'NE','VA','GA','KY')
 group by rollup (i_item_id, ca_country, ca_state, ca_county)
 order by ca_country,
        ca_state, 
        ca_county,
	i_item_id
 limit 100;

-- end query 9 in stream 4 using template query18.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 559805.15, 'Total Cost': 559805.4, 'Plan Rows': 100, 'Plan Width': 272, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 559805.15, 'Total Cost': 559811.59, 'Plan Rows': 2573, 'Plan Width': 272, 'Sort Key': ['customer_address.ca_country', 'customer_address.ca_state', 'customer_address.ca_county', 'item.i_item_id'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 559533.84, 'Total Cost': 559706.82, 'Plan Rows': 2573, 'Plan Width': 272, 'Grouping Sets': [{'Group Keys': [['item.i_item_id', 'customer_address.ca_country', 'customer_address.ca_state', 'customer_address.ca_county'], ['item.i_item_id', 'customer_address.ca_country', 'customer_address.ca_state'], ['item.i_item_id', 'customer_address.ca_country'], ['item.i_item_id'], []]}], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 559533.84, 'Total Cost': 559608.73, 'Plan Rows': 643, 'Plan Width': 81, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 558533.82, 'Total Cost': 558534.49, 'Plan Rows': 268, 'Plan Width': 81, 'Sort Key': ['item.i_item_id', 'customer_address.ca_country', 'customer_address.ca_state', 'customer_address.ca_county'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 550973.51, 'Total Cost': 558523.01, 'Plan Rows': 268, 'Plan Width': 81, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 5, 'ID': 6}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 550970.16, 'Total Cost': 550970.16, 'Plan Rows': 268, 'Plan Width': 68, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 518136.46, 'Total Cost': 550970.16, 'Plan Rows': 268, 'Plan Width': 68, 'Inner Unique': False, 'Hash Cond': '(cd2.cd_demo_sk = customer.c_current_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'cd2', 'Startup Cost': 0.0, 'Total Cost': 29831.33, 'Plan Rows': 800333, 'Plan Width': 4, 'parent': 8, 'ID': 9}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 518132.99, 'Total Cost': 518132.99, 'Plan Rows': 278, 'Plan Width': 72, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 510635.81, 'Total Cost': 518132.99, 'Plan Rows': 278, 'Plan Width': 72, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = customer.c_current_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 7388.12, 'Plan Rows': 28771, 'Plan Width': 35, 'Filter': ""(ca_state = ANY ('{CO,TX,SD,NE,VA,GA,KY}'::bpchar[]))"", 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 510623.26, 'Total Cost': 510623.26, 'Plan Rows': 1004, 'Plan Width': 45, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 492757.89, 'Total Cost': 510623.26, 'Plan Rows': 1004, 'Plan Width': 45, 'Inner Unique': False, 'Hash Cond': '(customer.c_customer_sk = catalog_sales.cs_bill_customer_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 17480.83, 'Plan Rows': 101430, 'Plan Width': 16, 'Filter': ""(c_birth_month = ANY ('{5,11,9,3,8,1}'::integer[]))"", 'parent': 14, 'ID': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 492731.96, 'Total Cost': 492731.96, 'Plan Rows': 2074, 'Plan Width': 37, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458678.6, 'Total Cost': 492731.96, 'Plan Rows': 2074, 'Plan Width': 37, 'Inner Unique': False, 'Hash Cond': '(cd1.cd_demo_sk = catalog_sales.cs_bill_cdemo_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_demographics', 'Alias': 'cd1', 'Startup Cost': 0.0, 'Total Cost': 33833.0, 'Plan Rows': 56458, 'Plan Width': 8, 'Filter': ""((cd_gender = 'F'::bpchar) AND (cd_education_status = 'College'::bpchar))"", 'parent': 17, 'ID': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458308.99, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 37, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 1944.79, 'Total Cost': 458308.99, 'Plan Rows': 29569, 'Plan Width': 37, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 41, 'parent': 20, 'ID': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 1942.12, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 1942.12, 'Plan Rows': 213, 'Plan Width': 4, 'Filter': '(d_year = 2001)', 'parent': 22, 'ID': 23}], 'parent': 20, 'ID': 22, 'left': 23}], 'parent': 19, 'ID': 20, 'left': 21, 'right': 22}], 'parent': 17, 'ID': 19, 'left': 20}], 'parent': 16, 'ID': 17, 'left': 18, 'right': 19}], 'parent': 14, 'ID': 16, 'left': 17}], 'parent': 13, 'ID': 14, 'left': 15, 'right': 16}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 8, 'ID': 10, 'left': 11}], 'parent': 7, 'ID': 8, 'left': 9, 'right': 10}], 'parent': 5, 'ID': 7, 'left': 8}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 7}], 'parent': 3, 'ID': 4, 'left': 5}], 'parent': 2, 'ID': 3, 'left': 4}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
3,49,"select  channel, item, return_ratio, return_rank, currency_rank from
 (select
 'web' as channel
 ,web.item
 ,web.return_ratio
 ,web.return_rank
 ,web.currency_rank
 from (
 	select 
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select ws.ws_item_sk as item
 		,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from 
 		 web_sales ws left outer join web_returns wr 
 			on (ws.ws_order_number = wr.wr_order_number and 
 			ws.ws_item_sk = wr.wr_item_sk)
                 ,date_dim
 		where 
 			wr.wr_return_amt > 10000 
 			and ws.ws_net_profit > 1
                         and ws.ws_net_paid > 0
                         and ws.ws_quantity > 0
                         and ws_sold_date_sk = d_date_sk
                         and d_year = 2001
                         and d_moy = 11
 		group by ws.ws_item_sk
 	) in_web
 ) web
 where 
 (
 web.return_rank <= 10
 or
 web.currency_rank <= 10
 )
 union
 select 
 'catalog' as channel
 ,catalog.item
 ,catalog.return_ratio
 ,catalog.return_rank
 ,catalog.currency_rank
 from (
 	select 
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select 
 		cs.cs_item_sk as item
 		,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from 
 		catalog_sales cs left outer join catalog_returns cr
 			on (cs.cs_order_number = cr.cr_order_number and 
 			cs.cs_item_sk = cr.cr_item_sk)
                ,date_dim
 		where 
 			cr.cr_return_amount > 10000 
 			and cs.cs_net_profit > 1
                         and cs.cs_net_paid > 0
                         and cs.cs_quantity > 0
                         and cs_sold_date_sk = d_date_sk
                         and d_year = 2001
                         and d_moy = 11
                 group by cs.cs_item_sk
 	) in_cat
 ) catalog
 where 
 (
 catalog.return_rank <= 10
 or
 catalog.currency_rank <=10
 )
 union
 select 
 'store' as channel
 ,store.item
 ,store.return_ratio
 ,store.return_rank
 ,store.currency_rank
 from (
 	select 
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select sts.ss_item_sk as item
 		,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from 
 		store_sales sts left outer join store_returns sr
 			on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)
                ,date_dim
 		where 
 			sr.sr_return_amt > 10000 
 			and sts.ss_net_profit > 1
                         and sts.ss_net_paid > 0 
                         and sts.ss_quantity > 0
                         and ss_sold_date_sk = d_date_sk
                         and d_year = 2001
                         and d_moy = 11
 		group by sts.ss_item_sk
 	) in_store
 ) store
 where  (
 store.return_rank <= 10
 or 
 store.currency_rank <= 10
 )
 ) as alias123 
 order by 1,4,5,2
 limit 100;

-- end query 34 in stream 1 using template query49.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1594247.03, 'Total Cost': 1594247.04, 'Plan Rows': 3, 'Plan Width': 84, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1594247.03, 'Total Cost': 1594247.04, 'Plan Rows': 3, 'Plan Width': 84, 'Sort Key': [""('web'::text)"", 'web.return_rank', 'web.currency_rank', 'web.item'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1594246.95, 'Total Cost': 1594246.98, 'Plan Rows': 3, 'Plan Width': 84, 'Group Key': [""('web'::text)"", 'web.item', 'web.return_ratio', 'web.return_rank', 'web.currency_rank'], 'Planned Partitions': 0, 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.74, 'Total Cost': 1594246.91, 'Plan Rows': 3, 'Plan Width': 84, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'web', 'Startup Cost': 264662.74, 'Total Cost': 264662.78, 'Plan Rows': 1, 'Plan Width': 84, 'Filter': '((web.return_rank <= 10) OR (web.currency_rank <= 10))', 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.74, 'Total Cost': 264662.76, 'Plan Rows': 1, 'Plan Width': 84, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.74, 'Total Cost': 264662.75, 'Plan Rows': 1, 'Plan Width': 76, 'Sort Key': ['in_web.return_ratio'], 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.71, 'Total Cost': 264662.73, 'Plan Rows': 1, 'Plan Width': 76, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.71, 'Total Cost': 264662.72, 'Plan Rows': 1, 'Plan Width': 68, 'Sort Key': ['in_web.currency_ratio'], 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'in_web', 'Startup Cost': 264662.52, 'Total Cost': 264662.7, 'Plan Rows': 1, 'Plan Width': 68, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.52, 'Total Cost': 264662.69, 'Plan Rows': 1, 'Plan Width': 68, 'Group Key': ['ws.ws_item_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 264662.52, 'Total Cost': 264662.64, 'Plan Rows': 1, 'Plan Width': 24, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263662.5, 'Total Cost': 263662.51, 'Plan Rows': 1, 'Plan Width': 24, 'Sort Key': ['ws.ws_item_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 246613.79, 'Total Cost': 263662.49, 'Plan Rows': 1, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '((wr.wr_order_number = ws.ws_order_number) AND (wr.wr_item_sk = ws.ws_item_sk))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'wr', 'Startup Cost': 0.0, 'Total Cost': 17027.92, 'Plan Rows': 2769, 'Plan Width': 18, 'Filter': ""(wr_return_amt > '10000'::numeric)"", 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 246606.7, 'Total Cost': 246606.7, 'Plan Rows': 473, 'Plan Width': 18, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 246606.7, 'Plan Rows': 473, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(ws.ws_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'ws', 'Startup Cost': 0.0, 'Total Cost': 240230.25, 'Plan Rows': 1153021, 'Plan Width': 22, 'Filter': ""((ws_net_profit > '1'::numeric) AND (ws_net_paid > '0'::numeric) AND (ws_quantity > 0))"", 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 11))', 'parent': 18, 'ID': 19}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}], 'parent': 11, 'ID': 12, 'left': 13}], 'parent': 10, 'ID': 11, 'left': 12}], 'parent': 9, 'ID': 10, 'left': 11}], 'parent': 8, 'ID': 9, 'left': 10}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'catalog', 'Startup Cost': 526538.74, 'Total Cost': 526538.77, 'Plan Rows': 1, 'Plan Width': 84, 'Filter': '((catalog.return_rank <= 10) OR (catalog.currency_rank <= 10))', 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.74, 'Total Cost': 526538.76, 'Plan Rows': 1, 'Plan Width': 84, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.74, 'Total Cost': 526538.74, 'Plan Rows': 1, 'Plan Width': 76, 'Sort Key': ['in_cat.return_ratio'], 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.71, 'Total Cost': 526538.73, 'Plan Rows': 1, 'Plan Width': 76, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.71, 'Total Cost': 526538.71, 'Plan Rows': 1, 'Plan Width': 68, 'Sort Key': ['in_cat.currency_ratio'], 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'in_cat', 'Startup Cost': 526538.52, 'Total Cost': 526538.7, 'Plan Rows': 1, 'Plan Width': 68, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.52, 'Total Cost': 526538.69, 'Plan Rows': 1, 'Plan Width': 68, 'Group Key': ['cs.cs_item_sk'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 526538.52, 'Total Cost': 526538.64, 'Plan Rows': 1, 'Plan Width': 24, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 525538.49, 'Total Cost': 525538.5, 'Plan Rows': 1, 'Plan Width': 24, 'Sort Key': ['cs.cs_item_sk'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 489247.48, 'Total Cost': 525538.48, 'Plan Rows': 1, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '((cr.cr_order_number = cs.cs_order_number) AND (cr.cr_item_sk = cs.cs_item_sk))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'cr', 'Startup Cost': 0.0, 'Total Cost': 36248.69, 'Plan Rows': 5640, 'Plan Width': 18, 'Filter': ""(cr_return_amount > '10000'::numeric)"", 'parent': 29, 'ID': 30}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 489233.62, 'Total Cost': 489233.62, 'Plan Rows': 924, 'Plan Width': 18, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 489233.62, 'Plan Rows': 924, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(cs.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'cs', 'Startup Cost': 0.0, 'Total Cost': 478692.19, 'Plan Rows': 2262963, 'Plan Width': 22, 'Filter': ""((cs_net_profit > '1'::numeric) AND (cs_net_paid > '0'::numeric) AND (cs_quantity > 0))"", 'parent': 32, 'ID': 33}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 11))', 'parent': 34, 'ID': 35}], 'parent': 32, 'ID': 34, 'left': 35}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 34}], 'parent': 29, 'ID': 31, 'left': 32}], 'parent': 28, 'ID': 29, 'left': 30, 'right': 31}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 24, 'ID': 25, 'left': 26}], 'parent': 23, 'ID': 24, 'left': 25}], 'parent': 22, 'ID': 23, 'left': 24}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 20, 'ID': 21, 'left': 22}], 'parent': 3, 'ID': 20, 'left': 21}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'store', 'Startup Cost': 803045.29, 'Total Cost': 803045.32, 'Plan Rows': 1, 'Plan Width': 84, 'Filter': '((store.return_rank <= 10) OR (store.currency_rank <= 10))', 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.29, 'Total Cost': 803045.31, 'Plan Rows': 1, 'Plan Width': 84, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.29, 'Total Cost': 803045.29, 'Plan Rows': 1, 'Plan Width': 76, 'Sort Key': ['in_store.return_ratio'], 'Plans': [{'Node Type': 'WindowAgg', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.26, 'Total Cost': 803045.28, 'Plan Rows': 1, 'Plan Width': 76, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.26, 'Total Cost': 803045.26, 'Plan Rows': 1, 'Plan Width': 68, 'Sort Key': ['in_store.currency_ratio'], 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'in_store', 'Startup Cost': 803045.18, 'Total Cost': 803045.25, 'Plan Rows': 1, 'Plan Width': 68, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.18, 'Total Cost': 803045.24, 'Plan Rows': 1, 'Plan Width': 68, 'Group Key': ['sts.ss_item_sk'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 803045.18, 'Total Cost': 803045.19, 'Plan Rows': 1, 'Plan Width': 24, 'Sort Key': ['sts.ss_item_sk'], 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 740105.63, 'Total Cost': 803045.17, 'Plan Rows': 1, 'Plan Width': 24, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 739105.63, 'Total Cost': 802045.07, 'Plan Rows': 1, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '((sr.sr_ticket_number = sts.ss_ticket_number) AND (sr.sr_item_sk = sts.ss_item_sk))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'sr', 'Startup Cost': 0.0, 'Total Cost': 62883.05, 'Plan Rows': 7518, 'Plan Width': 18, 'Filter': ""(sr_return_amt > '10000'::numeric)"", 'parent': 45, 'ID': 46}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 739089.77, 'Total Cost': 739089.77, 'Plan Rows': 1057, 'Plan Width': 18, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 739089.77, 'Plan Rows': 1057, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(sts.ss_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'sts', 'Startup Cost': 0.0, 'Total Cost': 726919.14, 'Plan Rows': 2697204, 'Plan Width': 22, 'Filter': ""((ss_net_profit > '1'::numeric) AND (ss_net_paid > '0'::numeric) AND (ss_quantity > 0))"", 'parent': 48, 'ID': 49}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2001) AND (d_moy = 11))', 'parent': 50, 'ID': 51}], 'parent': 48, 'ID': 50, 'left': 51}], 'parent': 47, 'ID': 48, 'left': 49, 'right': 50}], 'parent': 45, 'ID': 47, 'left': 48}], 'parent': 44, 'ID': 45, 'left': 46, 'right': 47}], 'parent': 43, 'ID': 44, 'left': 45}], 'parent': 42, 'ID': 43, 'left': 44}], 'parent': 41, 'ID': 42, 'left': 43}], 'parent': 40, 'ID': 41, 'left': 42}], 'parent': 39, 'ID': 40, 'left': 41}], 'parent': 38, 'ID': 39, 'left': 40}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 36, 'ID': 37, 'left': 38}], 'parent': 3, 'ID': 36, 'left': 37}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 20}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
4,80,"with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date) 
                  and (cast('1998-08-19' as date) +  interval '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date)
                  and (cast('1998-08-19' as date) +  interval '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('1998-08-19' as date)
                  and (cast('1998-08-19' as date) +  interval '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;

-- end query 61 in stream 0 using template query80.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566786.01, 'Plan Rows': 100, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566795.8, 'Plan Rows': 401, 'Plan Width': 160, 'Grouping Sets': [{'Group Keys': [[""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], [""('store channel'::text)""], []]}], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1566782.76, 'Total Cost': 1566783.77, 'Plan Rows': 401, 'Plan Width': 160, 'Sort Key': [""('store channel'::text)"", ""(('store'::text || (ssr.store_id)::text))""], 'Plans': [{'Node Type': 'Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 1566765.43, 'Plan Rows': 401, 'Plan Width': 160, 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'ssr', 'Startup Cost': 784591.9, 'Total Cost': 784611.64, 'Plan Rows': 51, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784610.87, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 784591.9, 'Total Cost': 784608.2, 'Plan Rows': 102, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783596.4, 'Plan Rows': 51, 'Plan Width': 113, 'Group Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 783591.88, 'Total Cost': 783592.48, 'Plan Rows': 242, 'Plan Width': 41, 'Sort Key': ['store.s_store_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94489.35, 'Total Cost': 783582.3, 'Plan Rows': 242, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94482.05, 'Total Cost': 783571.63, 'Plan Rows': 254, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_promo_sk = promotion.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 94456.65, 'Total Cost': 783542.68, 'Plan Rows': 270, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_item_sk = item.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 86930.88, 'Total Cost': 775998.13, 'Plan Rows': 4703, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((store_sales.ss_item_sk = store_returns.sr_item_sk) AND (store_sales.ss_ticket_number = store_returns.sr_ticket_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 32, 'parent': 13, 'ID': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 15, 'ID': 16}], 'parent': 13, 'ID': 15, 'left': 16}], 'parent': 12, 'ID': 13, 'left': 14, 'right': 15}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 59887.64, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_returns', 'Alias': 'store_returns', 'Startup Cost': 0.0, 'Total Cost': 59887.64, 'Plan Rows': 1198164, 'Plan Width': 20, 'parent': 17, 'ID': 18}], 'parent': 12, 'ID': 17, 'left': 18}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 19, 'ID': 20}], 'parent': 11, 'ID': 19, 'left': 20}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 19}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 21, 'ID': 22}], 'parent': 10, 'ID': 21, 'left': 22}], 'parent': 9, 'ID': 10, 'left': 11, 'right': 21}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.02, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.02, 'Plan Rows': 102, 'Plan Width': 21, 'parent': 23, 'ID': 24}], 'parent': 9, 'ID': 23, 'left': 24}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 23}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'csr', 'Startup Cost': 518174.1, 'Total Cost': 518225.66, 'Plan Rows': 329, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518220.73, 'Plan Rows': 329, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 518174.1, 'Total Cost': 518210.18, 'Plan Rows': 274, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517178.53, 'Plan Rows': 137, 'Plan Width': 113, 'Group Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 517174.07, 'Total Cost': 517174.42, 'Plan Rows': 137, 'Plan Width': 41, 'Sort Key': ['catalog_page.cp_catalog_page_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 57382.33, 'Total Cost': 517169.21, 'Plan Rows': 137, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56864.33, 'Total Cost': 516649.32, 'Plan Rows': 138, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_promo_sk = promotion_1.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 56838.93, 'Total Cost': 516622.01, 'Plan Rows': 141, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_item_sk = item_1.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 49313.15, 'Total Cost': 509086.46, 'Plan Rows': 2450, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 32, 'parent': 34, 'ID': 35}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 36, 'ID': 37}], 'parent': 34, 'ID': 36, 'left': 37}], 'parent': 33, 'ID': 34, 'left': 35, 'right': 36}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 34748.95, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_returns', 'Alias': 'catalog_returns', 'Startup Cost': 0.0, 'Total Cost': 34748.95, 'Plan Rows': 599895, 'Plan Width': 20, 'parent': 38, 'ID': 39}], 'parent': 33, 'ID': 38, 'left': 39}], 'parent': 32, 'ID': 33, 'left': 34, 'right': 38}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 40, 'ID': 41}], 'parent': 32, 'ID': 40, 'left': 41}], 'parent': 31, 'ID': 32, 'left': 33, 'right': 40}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_1', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 42, 'ID': 43}], 'parent': 31, 'ID': 42, 'left': 43}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 368.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'catalog_page', 'Alias': 'catalog_page', 'Startup Cost': 0.0, 'Total Cost': 368.0, 'Plan Rows': 12000, 'Plan Width': 21, 'parent': 44, 'ID': 45}], 'parent': 30, 'ID': 44, 'left': 45}], 'parent': 29, 'ID': 30, 'left': 31, 'right': 44}], 'parent': 28, 'ID': 29, 'left': 30}], 'parent': 27, 'ID': 28, 'left': 29}], 'parent': 26, 'ID': 27, 'left': 28}], 'parent': 25, 'ID': 26, 'left': 27}], 'parent': 3, 'ID': 25, 'left': 26}, {'Node Type': 'Subquery Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'wsr', 'Startup Cost': 263918.43, 'Total Cost': 263926.12, 'Plan Rows': 21, 'Plan Width': 160, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263925.8, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 263918.43, 'Total Cost': 263924.7, 'Plan Rows': 42, 'Plan Width': 113, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262919.83, 'Plan Rows': 21, 'Plan Width': 113, 'Group Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 262918.41, 'Total Cost': 262918.59, 'Plan Rows': 70, 'Plan Width': 41, 'Sort Key': ['web_site.web_site_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32134.74, 'Total Cost': 262916.27, 'Plan Rows': 70, 'Plan Width': 41, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_web_site_sk = web_site.web_site_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32130.8, 'Total Cost': 262911.36, 'Plan Rows': 70, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_promo_sk = promotion_2.p_promo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 32105.4, 'Total Cost': 262884.99, 'Plan Rows': 71, 'Plan Width': 32, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_item_sk = item_2.i_item_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Left', 'Startup Cost': 24579.62, 'Total Cost': 255354.31, 'Plan Rows': 1231, 'Plan Width': 36, 'Inner Unique': False, 'Hash Cond': '((web_sales.ws_item_sk = web_returns.wr_item_sk) AND (web_sales.ws_order_number = web_returns.wr_order_number))', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 28, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 32, 'parent': 55, 'ID': 56}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': ""((d_date >= '1998-08-19'::date) AND (d_date <= '1998-09-18 00:00:00'::timestamp without time zone))"", 'parent': 57, 'ID': 58}], 'parent': 55, 'ID': 57, 'left': 58}], 'parent': 54, 'ID': 55, 'left': 56, 'right': 57}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 16278.74, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_returns', 'Alias': 'web_returns', 'Startup Cost': 0.0, 'Total Cost': 16278.74, 'Plan Rows': 299674, 'Plan Width': 20, 'parent': 59, 'ID': 60}], 'parent': 54, 'ID': 59, 'left': 60}], 'parent': 53, 'ID': 54, 'left': 55, 'right': 59}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 7495.25, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7495.25, 'Plan Rows': 2442, 'Plan Width': 4, 'Filter': ""(i_current_price > '50'::numeric)"", 'parent': 61, 'ID': 62}], 'parent': 53, 'ID': 61, 'left': 62}], 'parent': 52, 'ID': 53, 'left': 54, 'right': 61}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 19.25, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'promotion', 'Alias': 'promotion_2', 'Startup Cost': 0.0, 'Total Cost': 19.25, 'Plan Rows': 492, 'Plan Width': 4, 'Filter': ""(p_channel_tv = 'N'::bpchar)"", 'parent': 63, 'ID': 64}], 'parent': 52, 'ID': 63, 'left': 64}], 'parent': 51, 'ID': 52, 'left': 53, 'right': 63}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 3.42, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'web_site', 'Alias': 'web_site', 'Startup Cost': 0.0, 'Total Cost': 3.42, 'Plan Rows': 42, 'Plan Width': 21, 'parent': 65, 'ID': 66}], 'parent': 51, 'ID': 65, 'left': 66}], 'parent': 50, 'ID': 51, 'left': 52, 'right': 65}], 'parent': 49, 'ID': 50, 'left': 51}], 'parent': 48, 'ID': 49, 'left': 50}], 'parent': 47, 'ID': 48, 'left': 49}], 'parent': 46, 'ID': 47, 'left': 48}], 'parent': 3, 'ID': 46, 'left': 47}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 25}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
5,60,"with ss as (
 select
          i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 cs as (
 select
          i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 ws as (
 select
          i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Men'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 9
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id)
  select   
  i_item_id
,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by i_item_id
      ,total_sales
 limit 100;

-- end query 44 in stream 2 using template query60.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446860.63, 'Total Cost': 1446860.88, 'Plan Rows': 100, 'Plan Width': 49, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446860.63, 'Total Cost': 1446861.13, 'Plan Rows': 200, 'Plan Width': 49, 'Sort Key': ['item.i_item_id', '(sum((sum(store_sales.ss_ext_sales_price))))'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446578.71, 'Total Cost': 1446852.99, 'Plan Rows': 200, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Append', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 1446578.71, 'Total Cost': 1446840.62, 'Plan Rows': 1974, 'Plan Width': 49, 'Sort Key': ['item.i_item_id'], 'Subplans Removed': 0, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708587.67, 'Total Cost': 708786.58, 'Plan Rows': 1087, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 708587.67, 'Total Cost': 708766.2, 'Plan Rows': 906, 'Plan Width': 49, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 707587.65, 'Total Cost': 707661.6, 'Plan Rows': 453, 'Plan Width': 49, 'Group Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Merge Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 707587.65, 'Total Cost': 707653.67, 'Plan Rows': 453, 'Plan Width': 23, 'Inner Unique': False, 'Merge Cond': '(item.i_item_id = item_1.i_item_id)', 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 698660.73, 'Total Cost': 698665.68, 'Plan Rows': 1980, 'Plan Width': 23, 'Sort Key': ['item.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 690995.69, 'Total Cost': 698552.32, 'Plan Rows': 1980, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item.i_item_sk = store_sales.ss_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 9, 'ID': 10}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 690970.94, 'Total Cost': 690970.94, 'Plan Rows': 1980, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 684053.54, 'Total Cost': 690970.94, 'Plan Rows': 1980, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 12, 'ID': 13}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 683994.75, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 683994.75, 'Plan Rows': 4703, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 18, 'parent': 15, 'ID': 16}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 17, 'ID': 18}], 'parent': 15, 'ID': 17, 'left': 18}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 17}], 'parent': 12, 'ID': 14, 'left': 15}], 'parent': 11, 'ID': 12, 'left': 13, 'right': 14}], 'parent': 9, 'ID': 11, 'left': 12}], 'parent': 8, 'ID': 9, 'left': 10, 'right': 11}], 'parent': 7, 'ID': 8, 'left': 9}, {'Node Type': 'Sort', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8926.92, 'Total Cost': 8952.71, 'Plan Rows': 10319, 'Plan Width': 17, 'Sort Key': ['item_1.i_item_id'], 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_1', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 19, 'ID': 20}], 'parent': 7, 'ID': 19, 'left': 20}], 'parent': 6, 'ID': 7, 'left': 8, 'right': 19}], 'parent': 5, 'ID': 6, 'left': 7}], 'parent': 4, 'ID': 5, 'left': 6}], 'parent': 3, 'ID': 4, 'left': 5}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482718.72, 'Total Cost': 482730.5, 'Plan Rows': 589, 'Plan Width': 49, 'Group Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 482718.72, 'Total Cost': 482720.19, 'Plan Rows': 589, 'Plan Width': 23, 'Sort Key': ['item_2.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 474867.13, 'Total Cost': 482691.62, 'Plan Rows': 589, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_id = item_3.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 466499.14, 'Total Cost': 474309.58, 'Plan Rows': 2576, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 465499.14, 'Total Cost': 473051.98, 'Plan Rows': 1073, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_2.i_item_sk = catalog_sales.cs_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_2', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 25, 'ID': 26}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 465485.73, 'Total Cost': 465485.73, 'Plan Rows': 1073, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 458285.32, 'Total Cost': 465485.73, 'Plan Rows': 1073, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_1.ca_address_sk = catalog_sales.cs_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_1', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 28, 'ID': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 458254.7, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 458254.7, 'Plan Rows': 2450, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'catalog_sales', 'Alias': 'catalog_sales', 'Startup Cost': 0.0, 'Total Cost': 433688.25, 'Plan Rows': 6000525, 'Plan Width': 18, 'parent': 31, 'ID': 32}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_1', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 33, 'ID': 34}], 'parent': 31, 'ID': 33, 'left': 34}], 'parent': 30, 'ID': 31, 'left': 32, 'right': 33}], 'parent': 28, 'ID': 30, 'left': 31}], 'parent': 27, 'ID': 28, 'left': 29, 'right': 30}], 'parent': 25, 'ID': 27, 'left': 28}], 'parent': 24, 'ID': 25, 'left': 26, 'right': 27}], 'parent': 23, 'ID': 24, 'left': 25}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8239.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_3', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 35, 'ID': 36}], 'parent': 23, 'ID': 35, 'left': 36}], 'parent': 22, 'ID': 23, 'left': 24, 'right': 35}], 'parent': 21, 'ID': 22, 'left': 23}], 'parent': 3, 'ID': 21, 'left': 22}, {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255272.29, 'Total Cost': 255278.25, 'Plan Rows': 298, 'Plan Width': 49, 'Group Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 255272.29, 'Total Cost': 255273.04, 'Plan Rows': 298, 'Plan Width': 23, 'Sort Key': ['item_4.i_item_id'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Semi', 'Startup Cost': 247572.21, 'Total Cost': 255260.05, 'Plan Rows': 298, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_id = item_5.i_item_id)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 239204.22, 'Total Cost': 246884.96, 'Plan Rows': 1301, 'Plan Width': 23, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 238204.22, 'Total Cost': 245754.86, 'Plan Rows': 542, 'Plan Width': 23, 'Inner Unique': False, 'Hash Cond': '(item_4.i_item_sk = web_sales.ws_item_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_4', 'Startup Cost': 0.0, 'Total Cost': 7389.0, 'Plan Rows': 42500, 'Plan Width': 21, 'parent': 41, 'ID': 42}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 238197.45, 'Total Cost': 238197.45, 'Plan Rows': 542, 'Plan Width': 10, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 231056.61, 'Total Cost': 238197.45, 'Plan Rows': 542, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(customer_address_2.ca_address_sk = web_sales.ws_bill_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address_2', 'Startup Cost': 0.0, 'Total Cost': 6737.08, 'Plan Rows': 45885, 'Plan Width': 4, 'Filter': ""(ca_gmt_offset = '-6'::numeric)"", 'parent': 44, 'ID': 45}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 231041.22, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2049.78, 'Total Cost': 231041.22, 'Plan Rows': 1231, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'web_sales', 'Alias': 'web_sales', 'Startup Cost': 0.0, 'Total Cost': 217737.86, 'Plan Rows': 2998986, 'Plan Width': 18, 'parent': 47, 'ID': 48}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2049.55, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim_2', 'Startup Cost': 0.0, 'Total Cost': 2049.55, 'Plan Rows': 18, 'Plan Width': 4, 'Filter': '((d_year = 2000) AND (d_moy = 9))', 'parent': 49, 'ID': 50}], 'parent': 47, 'ID': 49, 'left': 50}], 'parent': 46, 'ID': 47, 'left': 48, 'right': 49}], 'parent': 44, 'ID': 46, 'left': 47}], 'parent': 43, 'ID': 44, 'left': 45, 'right': 46}], 'parent': 41, 'ID': 43, 'left': 44}], 'parent': 40, 'ID': 41, 'left': 42, 'right': 43}], 'parent': 39, 'ID': 40, 'left': 41}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 8239.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'item', 'Alias': 'item_5', 'Startup Cost': 0.0, 'Total Cost': 8239.0, 'Plan Rows': 10319, 'Plan Width': 17, 'Filter': ""(i_category = 'Men'::bpchar)"", 'parent': 51, 'ID': 52}], 'parent': 39, 'ID': 51, 'left': 52}], 'parent': 38, 'ID': 39, 'left': 40, 'right': 51}], 'parent': 37, 'ID': 38, 'left': 39}], 'parent': 3, 'ID': 37, 'left': 38}], 'parent': 2, 'ID': 3, 'left': 4, 'right': 21}], 'parent': 1, 'ID': 2, 'left': 3}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
6,46,"select  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,amt,profit 
 from
   (select ss_ticket_number
          ,ss_customer_sk
          ,ca_city bought_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics,customer_address 
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk  
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and store_sales.ss_addr_sk = customer_address.ca_address_sk
    and (household_demographics.hd_dep_count = 2 or
         household_demographics.hd_vehicle_count= 3)
    and date_dim.d_dow in (6,0)
    and date_dim.d_year in (1999,1999+1,1999+2) 
    and store.s_city in ('Fairview','Midway','Fairview','Midway','Midway') 
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr
    where ss_customer_sk = c_customer_sk
      and customer.c_current_addr_sk = current_addr.ca_address_sk
      and current_addr.ca_city <> bought_city
  order by c_last_name
          ,c_first_name
          ,ca_city
          ,bought_city
          ,ss_ticket_number
  limit 100;

-- end query 31 in stream 4 using template query46.tpl
","{'Node Type': 'Limit', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 742674.58, 'Total Cost': 742674.83, 'Plan Rows': 100, 'Plan Width': 138, 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 742674.58, 'Total Cost': 742719.28, 'Plan Rows': 17880, 'Plan Width': 138, 'Sort Key': ['customer.c_last_name', 'customer.c_first_name', 'current_addr.ca_city', 'dn.bought_city', 'dn.ss_ticket_number'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 732894.87, 'Total Cost': 741991.22, 'Plan Rows': 17880, 'Plan Width': 138, 'Inner Unique': False, 'Hash Cond': '(current_addr.ca_address_sk = customer.c_current_addr_sk)', 'Join Filter': '((current_addr.ca_city)::text <> (dn.bought_city)::text)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'current_addr', 'Startup Cost': 0.0, 'Total Cost': 7935.0, 'Plan Rows': 250000, 'Plan Width': 13, 'parent': 2, 'ID': 3}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 732671.02, 'Total Cost': 732671.02, 'Plan Rows': 17908, 'Plan Width': 133, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 723851.49, 'Total Cost': 732671.02, 'Plan Rows': 17908, 'Plan Width': 133, 'Inner Unique': False, 'Hash Cond': '(dn.ss_customer_sk = customer.c_customer_sk)', 'Plans': [{'Node Type': 'Subquery Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Alias': 'dn', 'Startup Cost': 693394.49, 'Total Cost': 696105.78, 'Plan Rows': 17908, 'Plan Width': 81, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Subquery', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693394.49, 'Total Cost': 695926.7, 'Plan Rows': 17908, 'Plan Width': 85, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 693394.49, 'Total Cost': 695359.6, 'Plan Rows': 14924, 'Plan Width': 85, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692394.47, 'Total Cost': 692636.98, 'Plan Rows': 7462, 'Plan Width': 85, 'Group Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 692394.47, 'Total Cost': 692413.12, 'Plan Rows': 7462, 'Plan Width': 30, 'Sort Key': ['store_sales.ss_ticket_number', 'store_sales.ss_customer_sk', 'store_sales.ss_addr_sk', 'customer_address.ca_city'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 685016.08, 'Total Cost': 691914.46, 'Plan Rows': 7462, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(customer_address.ca_address_sk = store_sales.ss_addr_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'customer_address', 'Alias': 'customer_address', 'Startup Cost': 0.0, 'Total Cost': 6476.67, 'Plan Rows': 104167, 'Plan Width': 13, 'parent': 11, 'ID': 12}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 684918.45, 'Total Cost': 684918.45, 'Plan Rows': 7810, 'Plan Width': 21, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2296.59, 'Total Cost': 684918.45, 'Plan Rows': 7810, 'Plan Width': 21, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_store_sk = store.s_store_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2289.04, 'Total Cost': 684789.32, 'Plan Rows': 11593, 'Plan Width': 25, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Join Type': 'Inner', 'Startup Cost': 2105.54, 'Total Cost': 684307.63, 'Plan Rows': 48602, 'Plan Width': 29, 'Inner Unique': False, 'Hash Cond': '(store_sales.ss_sold_date_sk = date_dim.d_date_sk)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'store_sales', 'Alias': 'store_sales', 'Startup Cost': 0.0, 'Total Cost': 636914.37, 'Plan Rows': 12000637, 'Plan Width': 33, 'parent': 16, 'ID': 17}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Async Capable': False, 'Startup Cost': 2103.26, 'Total Cost': 2103.26, 'Plan Rows': 182, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Async Capable': False, 'Relation Name': 'date_dim', 'Alias': 'date_dim', 'Startup Cost': 0.0, 'Total Cost': 2103.26, 'Plan Rows': 182, 'Plan Width': 4, 'Filter': ""((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1999,2000,2001}'::integer[])))"", 'parent': 18, 'ID': 19}], 'parent': 16, 'ID': 18, 'left': 19}], 'parent': 15, 'ID': 16, 'left': 17, 'right': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 161.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'household_demographics', 'Alias': 'household_demographics', 'Startup Cost': 0.0, 'Total Cost': 161.0, 'Plan Rows': 1800, 'Plan Width': 4, 'Filter': '((hd_dep_count = 2) OR (hd_vehicle_count = 3))', 'parent': 20, 'ID': 21}], 'parent': 15, 'ID': 20, 'left': 21}], 'parent': 14, 'ID': 15, 'left': 16, 'right': 20}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 6.66, 'Total Cost': 6.66, 'Plan Rows': 72, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'store', 'Alias': 'store', 'Startup Cost': 0.0, 'Total Cost': 6.66, 'Plan Rows': 72, 'Plan Width': 4, 'Filter': ""((s_city)::text = ANY ('{Fairview,Midway,Fairview,Midway,Midway}'::text[]))"", 'parent': 22, 'ID': 23}], 'parent': 14, 'ID': 22, 'left': 23}], 'parent': 13, 'ID': 14, 'left': 15, 'right': 22}], 'parent': 11, 'ID': 13, 'left': 14}], 'parent': 10, 'ID': 11, 'left': 12, 'right': 13}], 'parent': 9, 'ID': 10, 'left': 11}], 'parent': 8, 'ID': 9, 'left': 10}], 'parent': 7, 'ID': 8, 'left': 9}], 'parent': 6, 'ID': 7, 'left': 8}], 'parent': 5, 'ID': 6, 'left': 7}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Async Capable': False, 'Startup Cost': 18835.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Async Capable': False, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 18835.0, 'Plan Rows': 500000, 'Plan Width': 60, 'parent': 24, 'ID': 25}], 'parent': 5, 'ID': 24, 'left': 25}], 'parent': 4, 'ID': 5, 'left': 6, 'right': 24}], 'parent': 2, 'ID': 4, 'left': 5}], 'parent': 1, 'ID': 2, 'left': 3, 'right': 4}], 'parent': 0, 'ID': 1, 'left': 2}], 'parent': None, 'ID': 0, 'left': 1}"
