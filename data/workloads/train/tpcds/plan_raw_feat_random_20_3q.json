[
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "date_dim.d_qoy",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n 2. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4.\n 4. 4. 4.]"
        ],
        "Aggregate": [
          "[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n 2. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4.\n 4. 4. 4.]",
          "[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n 2. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4.\n 4. 4. 4.]"
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 8.637020142311364e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047063841843619355
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 8.637020142311364e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047063841843619355
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "date_dim.d_month_seq",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.002945825022446118,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0029295404454544594
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 8.635767584173132e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004850723678525195
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_manufact_id",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[   1.    12.    23.    34.    46.    57.    68.    79.    90.   101.\n  113.   123.   134.   145.   156.   167.6  179.   190.   201.   212.\n  223.   234.   245.   256.   267.   277.   289.   300.   311.   322.\n  333.   355.   377.   399.   421.   443.   465.   488.   510.   533.\n  556.   577.   598.   620.   643.   666.   734.   798.   863.   932.\n 1000. ]"
        ],
        "Aggregate": [
          "[   1.    12.    23.    34.    46.    57.    68.    79.    90.   101.\n  113.   123.   134.   145.   156.   167.6  179.   190.   201.   212.\n  223.   234.   245.   256.   267.   277.   289.   300.   311.   322.\n  333.   355.   377.   399.   421.   443.   465.   488.   510.   533.\n  556.   577.   598.   620.   643.   666.   734.   798.   863.   932.\n 1000. ]",
          "[   1.    12.    23.    34.    46.    57.    68.    79.    90.   101.\n  113.   123.   134.   145.   156.   167.6  179.   190.   201.   212.\n  223.   234.   245.   256.   267.   277.   289.   300.   311.   322.\n  333.   355.   377.   399.   421.   443.   465.   488.   510.   533.\n  556.   577.   598.   620.   643.   666.   734.   798.   863.   932.\n 1000. ]"
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_class",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.012328180190262465,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0006372549019607598
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_category",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.012328180190262465,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0006372549019607598
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_manufact",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]",
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "item.i_brand",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.012328180190262465,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0006372549019607598
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "store.s_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 7.838610143277228e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09671177050379087
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 8.637020142311364e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0047063841843619355
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "store_sales.ss_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 8.635767584173132e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004850723678525195
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "store_sales.ss_store_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 7.838610143277228e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.09671177050379087
        ]
      }
    }
  },
  {
    "query": "select  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1199,1199+1,1199+2,1199+3,1199+4,1199+5,1199+6,1199+7,1199+8,1199+9,1199+10,1199+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100;\n\n-- end query 38 in stream 4 using template query53.tpl\n",
    "indexes": "store_sales.ss_sales_price",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 693719.13,
      "Total Cost": 693719.3,
      "Plan Rows": 66,
      "Plan Width": 68,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 693719.13,
          "Total Cost": 693719.3,
          "Plan Rows": 66,
          "Plan Width": 68,
          "Sort Key": [
            "tmp1.avg_quarterly_sales",
            "tmp1.sum_sales",
            "tmp1.i_manufact_id"
          ],
          "Plans": [
            {
              "Node Type": "Subquery Scan",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Alias": "tmp1",
              "Startup Cost": 693684.5,
              "Total Cost": 693717.14,
              "Plan Rows": 66,
              "Plan Width": 68,
              "Filter": "(CASE WHEN (tmp1.avg_quarterly_sales > '0'::numeric) THEN (abs((tmp1.sum_sales - tmp1.avg_quarterly_sales)) / tmp1.avg_quarterly_sales) ELSE NULL::numeric END > 0.1)",
              "Plans": [
                {
                  "Node Type": "WindowAgg",
                  "Parent Relationship": "Subquery",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 693684.5,
                  "Total Cost": 693712.66,
                  "Plan Rows": 199,
                  "Plan Width": 72,
                  "Plans": [
                    {
                      "Node Type": "Aggregate",
                      "Strategy": "Sorted",
                      "Partial Mode": "Finalize",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 693684.5,
                      "Total Cost": 693709.68,
                      "Plan Rows": 199,
                      "Plan Width": 40,
                      "Group Key": [
                        "item.i_manufact_id",
                        "date_dim.d_qoy"
                      ],
                      "Plans": [
                        {
                          "Node Type": "Gather Merge",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 693684.5,
                          "Total Cost": 693705.53,
                          "Plan Rows": 166,
                          "Plan Width": 40,
                          "Workers Planned": 2,
                          "Plans": [
                            {
                              "Node Type": "Aggregate",
                              "Strategy": "Sorted",
                              "Partial Mode": "Partial",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 692684.48,
                              "Total Cost": 692686.34,
                              "Plan Rows": 83,
                              "Plan Width": 40,
                              "Group Key": [
                                "item.i_manufact_id",
                                "date_dim.d_qoy"
                              ],
                              "Plans": [
                                {
                                  "Node Type": "Sort",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": false,
                                  "Async Capable": false,
                                  "Startup Cost": 692684.48,
                                  "Total Cost": 692684.68,
                                  "Plan Rows": 83,
                                  "Plan Width": 14,
                                  "Sort Key": [
                                    "item.i_manufact_id",
                                    "date_dim.d_qoy"
                                  ],
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": false,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 10618.11,
                                      "Total Cost": 692681.83,
                                      "Plan Rows": 83,
                                      "Plan Width": 14,
                                      "Inner Unique": false,
                                      "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 10610.82,
                                          "Total Cost": 692673.38,
                                          "Plan Rows": 87,
                                          "Plan Width": 18,
                                          "Inner Unique": false,
                                          "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Hash Join",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Join Type": "Inner",
                                              "Startup Cost": 8558.56,
                                              "Total Cost": 690551.79,
                                              "Plan Rows": 18354,
                                              "Plan Width": 18,
                                              "Inner Unique": false,
                                              "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)",
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "store_sales",
                                                  "Alias": "store_sales",
                                                  "Startup Cost": 0.0,
                                                  "Total Cost": 636914.37,
                                                  "Plan Rows": 12000637,
                                                  "Plan Width": 18,
                                                  "parent": 10,
                                                  "ID": 11
                                                },
                                                {
                                                  "Node Type": "Hash",
                                                  "Parent Relationship": "Inner",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Startup Cost": 8557.75,
                                                  "Total Cost": 8557.75,
                                                  "Plan Rows": 65,
                                                  "Plan Width": 8,
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "item",
                                                      "Alias": "item",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 8557.75,
                                                      "Plan Rows": 65,
                                                      "Plan Width": 8,
                                                      "Filter": "(((i_category = ANY ('{Books,Children,Electronics}'::bpchar[])) AND (i_class = ANY ('{personal,portable,reference,self-help}'::bpchar[])) AND (i_brand = ANY ('{\"scholaramalgamalg #14\",\"scholaramalgamalg #7\",\"exportiunivamalg #9\",\"scholaramalgamalg #9\"}'::bpchar[]))) OR ((i_category = ANY ('{Women,Music,Men}'::bpchar[])) AND (i_class = ANY ('{accessories,classical,fragrances,pants}'::bpchar[])) AND (i_brand = ANY ('{\"amalgimporto #1\",\"edu packscholar #1\",\"exportiimporto #1\",\"importoamalg #1\"}'::bpchar[]))))",
                                                      "parent": 12,
                                                      "ID": 13
                                                    }
                                                  ],
                                                  "parent": 10,
                                                  "ID": 12,
                                                  "left": 13
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 10,
                                              "left": 11,
                                              "right": 12
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 2049.58,
                                              "Total Cost": 2049.58,
                                              "Plan Rows": 214,
                                              "Plan Width": 8,
                                              "Plans": [
                                                {
                                                  "Node Type": "Seq Scan",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Relation Name": "date_dim",
                                                  "Alias": "date_dim",
                                                  "Startup Cost": 0.03,
                                                  "Total Cost": 2049.58,
                                                  "Plan Rows": 214,
                                                  "Plan Width": 8,
                                                  "Filter": "(d_month_seq = ANY ('{1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210}'::integer[]))",
                                                  "parent": 14,
                                                  "ID": 15
                                                }
                                              ],
                                              "parent": 9,
                                              "ID": 14,
                                              "left": 15
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 9,
                                          "left": 10,
                                          "right": 14
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": false,
                                          "Async Capable": false,
                                          "Startup Cost": 6.02,
                                          "Total Cost": 6.02,
                                          "Plan Rows": 102,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": false,
                                              "Async Capable": false,
                                              "Relation Name": "store",
                                              "Alias": "store",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6.02,
                                              "Plan Rows": 102,
                                              "Plan Width": 4,
                                              "parent": 16,
                                              "ID": 17
                                            }
                                          ],
                                          "parent": 8,
                                          "ID": 16,
                                          "left": 17
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 8,
                                      "left": 9,
                                      "right": 16
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Aggregate",
          "Gather Merge",
          "WindowAgg",
          "Subquery Scan"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_address.ca_address_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.4992970628274727e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0030277506338350136
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_address.ca_state",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.017183525658687342,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.10262400000000005
        ],
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_address.ca_country",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.017180016217205538,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.10262400000000005
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_demographics.cd_demo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_demographics.cd_marital_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.09778658825481559,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.03440285297792589
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "customer_demographics.cd_education_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.09778658825481559,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.03440285297792589
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.004687460411861959,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0029158510041205066
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.4929990289757203e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004822101002789471
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.4929990289757203e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004822101002789471
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "reason.r_reason_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 2.986695625336987e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.14907119849998599
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "reason.r_reason_desc",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]",
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_page.wp_web_page_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.2617351151385878e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.07071067811865475
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.5094414818076144e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_refunded_cdemo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.496270252609718e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0038901083408314514
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_refunded_addr_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.4992970628274727e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0030277506338350136
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_returning_cdemo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.5060008400403616e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0011178013705439639
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_reason_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 2.986695625336987e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.14907119849998599
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.5094414818076144e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_fee",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[  0.5    2.45   4.47   6.45   8.41  10.42  12.42  14.41  16.37  18.35\n  20.37  22.33  24.33  26.31  28.33  30.32  32.32  34.3   36.3   38.27\n  40.29  42.3   44.29  46.25  48.27  50.25  52.25  54.22  56.21  58.18\n  60.18  62.18  64.17  66.17  68.17  70.17  72.13  74.14  76.14  78.16\n  80.13  82.1   84.09  86.09  88.07  90.09  92.07  94.04  96.02  98.01\n 100.  ]"
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_returns.wr_refunded_cash",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0.0000000e+00 3.0000000e-02 1.6200000e+00 3.5600000e+00 5.9000000e+00\n 8.5600000e+00 1.1650000e+01 1.5070000e+01 1.8950000e+01 2.3250000e+01\n 2.8084000e+01 3.3420000e+01 3.9170000e+01 4.5570000e+01 5.2380000e+01\n 6.0140000e+01 6.8626400e+01 7.7920000e+01 8.8200000e+01 9.9390000e+01\n 1.1172000e+02 1.2513000e+02 1.3967880e+02 1.5584000e+02 1.7311960e+02\n 1.9250000e+02 2.1343000e+02 2.3649000e+02 2.6229000e+02 2.9002660e+02\n 3.2071000e+02 3.5510740e+02 3.9312000e+02 4.3455000e+02 4.8144000e+02\n 5.3409000e+02 5.9207440e+02 6.5868980e+02 7.3609000e+02 8.2232240e+02\n 9.2240600e+02 1.0378514e+03 1.1754136e+03 1.3379422e+03 1.5383328e+03\n 1.7919700e+03 2.1202700e+03 2.5787600e+03 3.2753692e+03 4.5796474e+03\n 2.4003810e+04]"
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.4929990289757203e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004822101002789471
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_item_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.5094414818076144e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_web_page_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.2617351151385878e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.07071067811865475
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_order_number",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 3.5094414818076144e-06,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_quantity",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[  1.   2.   4.   6.   8.  10.  12.  14.  16.  18.  20.  22.  24.  26.\n  28.  30.  32.  34.  36.  39.  41.  43.  45.  47.  49.  51.  53.  55.\n  57.  59.  61.  63.  65.  67.  69.  71.  73.  75.  77.  79.  81.  83.\n  85.  87.  89.  91.  93.  95.  97.  99. 100.]"
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_sales_price",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.7291808129941401,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.021038917878627328
        ],
        "Hash Join": [
          0.0038901083408314514
        ]
      }
    }
  },
  {
    "query": "select  substr(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IN', 'OR', 'TX')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('OK', 'IA', 'TN')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'AR', 'KY')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;\n\n-- end query 65 in stream 4 using template query85.tpl\n",
    "indexes": "web_sales.ws_net_profit",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 413114.32,
      "Total Cost": 413114.33,
      "Plan Rows": 1,
      "Plan Width": 229,
      "Plans": [
        {
          "Node Type": "Sort",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 413114.32,
          "Total Cost": 413114.33,
          "Plan Rows": 1,
          "Plan Width": 229,
          "Sort Key": [
            "(substr((reason.r_reason_desc)::text, 1, 20))",
            "(avg(web_sales.ws_quantity))",
            "(avg(web_returns.wr_refunded_cash))",
            "(avg(web_returns.wr_fee))"
          ],
          "Plans": [
            {
              "Node Type": "Aggregate",
              "Strategy": "Sorted",
              "Partial Mode": "Simple",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Startup Cost": 413114.27,
              "Total Cost": 413114.31,
              "Plan Rows": 1,
              "Plan Width": 229,
              "Group Key": [
                "reason.r_reason_desc"
              ],
              "Plans": [
                {
                  "Node Type": "Sort",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 413114.27,
                  "Total Cost": 413114.28,
                  "Plan Rows": 1,
                  "Plan Width": 117,
                  "Sort Key": [
                    "reason.r_reason_desc"
                  ],
                  "Plans": [
                    {
                      "Node Type": "Nested Loop",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 370522.87,
                      "Total Cost": 413114.26,
                      "Plan Rows": 1,
                      "Plan Width": 117,
                      "Inner Unique": false,
                      "Join Filter": "(web_returns.wr_reason_sk = reason.r_reason_sk)",
                      "Plans": [
                        {
                          "Node Type": "Nested Loop",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Join Type": "Inner",
                          "Startup Cost": 370522.87,
                          "Total Cost": 413112.25,
                          "Plan Rows": 1,
                          "Plan Width": 20,
                          "Inner Unique": false,
                          "Join Filter": "(web_sales.ws_web_page_sk = web_page.wp_web_page_sk)",
                          "Plans": [
                            {
                              "Node Type": "Gather",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Startup Cost": 370522.87,
                              "Total Cost": 413102.75,
                              "Plan Rows": 1,
                              "Plan Width": 24,
                              "Workers Planned": 2,
                              "Single Copy": false,
                              "Plans": [
                                {
                                  "Node Type": "Hash Join",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Join Type": "Inner",
                                  "Startup Cost": 369522.87,
                                  "Total Cost": 412102.65,
                                  "Plan Rows": 1,
                                  "Plan Width": 24,
                                  "Inner Unique": false,
                                  "Hash Cond": "((cd1.cd_demo_sk = web_returns.wr_refunded_cdemo_sk) AND (cd1.cd_marital_status = cd2.cd_marital_status) AND (cd1.cd_education_status = cd2.cd_education_status))",
                                  "Join Filter": "(((cd1.cd_marital_status = 'W'::bpchar) AND (cd1.cd_education_status = 'Primary'::bpchar) AND (web_sales.ws_sales_price >= 100.00) AND (web_sales.ws_sales_price <= 150.00)) OR ((cd1.cd_marital_status = 'U'::bpchar) AND (cd1.cd_education_status = 'College'::bpchar) AND (web_sales.ws_sales_price >= 50.00) AND (web_sales.ws_sales_price <= 100.00)) OR ((cd1.cd_marital_status = 'S'::bpchar) AND (cd1.cd_education_status = '4 yr Degree'::bpchar) AND (web_sales.ws_sales_price >= 150.00) AND (web_sales.ws_sales_price <= 200.00)))",
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "customer_demographics",
                                      "Alias": "cd1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 41836.33,
                                      "Plan Rows": 66081,
                                      "Plan Width": 27,
                                      "Filter": "(((cd_marital_status = 'W'::bpchar) AND (cd_education_status = 'Primary'::bpchar)) OR ((cd_marital_status = 'U'::bpchar) AND (cd_education_status = 'College'::bpchar)) OR ((cd_marital_status = 'S'::bpchar) AND (cd_education_status = '4 yr Degree'::bpchar)))",
                                      "parent": 7,
                                      "ID": 8
                                    },
                                    {
                                      "Node Type": "Hash",
                                      "Parent Relationship": "Inner",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Startup Cost": 369522.85,
                                      "Total Cost": 369522.85,
                                      "Plan Rows": 1,
                                      "Plan Width": 57,
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Inner",
                                          "Startup Cost": 336690.26,
                                          "Total Cost": 369522.85,
                                          "Plan Rows": 1,
                                          "Plan Width": 57,
                                          "Inner Unique": false,
                                          "Hash Cond": "(cd2.cd_demo_sk = web_returns.wr_returning_cdemo_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_demographics",
                                              "Alias": "cd2",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 29831.33,
                                              "Plan Rows": 800333,
                                              "Plan Width": 27,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 336690.24,
                                              "Total Cost": 336690.24,
                                              "Plan Rows": 1,
                                              "Plan Width": 38,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 318465.4,
                                                  "Total Cost": 336690.24,
                                                  "Plan Rows": 1,
                                                  "Plan Width": 38,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "((web_returns.wr_item_sk = web_sales.ws_item_sk) AND (web_returns.wr_order_number = web_sales.ws_order_number))",
                                                  "Join Filter": "(((customer_address.ca_state = ANY ('{IN,OR,TX}'::bpchar[])) AND (web_sales.ws_net_profit >= '100'::numeric) AND (web_sales.ws_net_profit <= '200'::numeric)) OR ((customer_address.ca_state = ANY ('{OK,IA,TN}'::bpchar[])) AND (web_sales.ws_net_profit >= '150'::numeric) AND (web_sales.ws_net_profit <= '300'::numeric)) OR ((customer_address.ca_state = ANY ('{NY,AR,KY}'::bpchar[])) AND (web_sales.ws_net_profit >= '50'::numeric) AND (web_sales.ws_net_profit <= '250'::numeric)))",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Hash Join",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Join Type": "Inner",
                                                      "Startup Cost": 8229.66,
                                                      "Total Cost": 25925.85,
                                                      "Plan Rows": 70482,
                                                      "Plan Width": 35,
                                                      "Inner Unique": false,
                                                      "Hash Cond": "(web_returns.wr_refunded_addr_sk = customer_address.ca_address_sk)",
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "web_returns",
                                                          "Alias": "web_returns",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 16278.74,
                                                          "Plan Rows": 299674,
                                                          "Plan Width": 36,
                                                          "parent": 14,
                                                          "ID": 15
                                                        },
                                                        {
                                                          "Node Type": "Hash",
                                                          "Parent Relationship": "Inner",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Startup Cost": 7908.96,
                                                          "Total Cost": 7908.96,
                                                          "Plan Rows": 25656,
                                                          "Plan Width": 7,
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "customer_address",
                                                              "Alias": "customer_address",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 7908.96,
                                                              "Plan Rows": 25656,
                                                              "Plan Width": 7,
                                                              "Filter": "(((ca_country)::text = 'United States'::text) AND ((ca_state = ANY ('{IN,OR,TX}'::bpchar[])) OR (ca_state = ANY ('{OK,IA,TN}'::bpchar[])) OR (ca_state = ANY ('{NY,AR,KY}'::bpchar[]))))",
                                                              "parent": 16,
                                                              "ID": 17
                                                            }
                                                          ],
                                                          "parent": 14,
                                                          "ID": 16,
                                                          "left": 17
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 14,
                                                      "left": 15,
                                                      "right": 16
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 310224.49,
                                                      "Total Cost": 310224.49,
                                                      "Plan Rows": 750,
                                                      "Plan Width": 28,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Hash Join",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Join Type": "Inner",
                                                          "Startup Cost": 1944.79,
                                                          "Total Cost": 310224.49,
                                                          "Plan Rows": 750,
                                                          "Plan Width": 28,
                                                          "Inner Unique": false,
                                                          "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)",
                                                          "Plans": [
                                                            {
                                                              "Node Type": "Seq Scan",
                                                              "Parent Relationship": "Outer",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Relation Name": "web_sales",
                                                              "Alias": "web_sales",
                                                              "Startup Cost": 0.0,
                                                              "Total Cost": 307707.43,
                                                              "Plan Rows": 151429,
                                                              "Plan Width": 32,
                                                              "Filter": "((((ws_sales_price >= 100.00) AND (ws_sales_price <= 150.00)) OR ((ws_sales_price >= 50.00) AND (ws_sales_price <= 100.00)) OR ((ws_sales_price >= 150.00) AND (ws_sales_price <= 200.00))) AND (((ws_net_profit >= '100'::numeric) AND (ws_net_profit <= '200'::numeric)) OR ((ws_net_profit >= '150'::numeric) AND (ws_net_profit <= '300'::numeric)) OR ((ws_net_profit >= '50'::numeric) AND (ws_net_profit <= '250'::numeric))))",
                                                              "parent": 19,
                                                              "ID": 20
                                                            },
                                                            {
                                                              "Node Type": "Hash",
                                                              "Parent Relationship": "Inner",
                                                              "Parallel Aware": true,
                                                              "Async Capable": false,
                                                              "Startup Cost": 1942.12,
                                                              "Total Cost": 1942.12,
                                                              "Plan Rows": 213,
                                                              "Plan Width": 4,
                                                              "Plans": [
                                                                {
                                                                  "Node Type": "Seq Scan",
                                                                  "Parent Relationship": "Outer",
                                                                  "Parallel Aware": true,
                                                                  "Async Capable": false,
                                                                  "Relation Name": "date_dim",
                                                                  "Alias": "date_dim",
                                                                  "Startup Cost": 0.0,
                                                                  "Total Cost": 1942.12,
                                                                  "Plan Rows": 213,
                                                                  "Plan Width": 4,
                                                                  "Filter": "(d_year = 2000)",
                                                                  "parent": 21,
                                                                  "ID": 22
                                                                }
                                                              ],
                                                              "parent": 19,
                                                              "ID": 21,
                                                              "left": 22
                                                            }
                                                          ],
                                                          "parent": 18,
                                                          "ID": 19,
                                                          "left": 20,
                                                          "right": 21
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 18,
                                                      "left": 19
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 18
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        }
                                      ],
                                      "parent": 7,
                                      "ID": 9,
                                      "left": 10
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 7,
                                  "left": 8,
                                  "right": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7
                            },
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Inner",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "web_page",
                              "Alias": "web_page",
                              "Startup Cost": 0.0,
                              "Total Cost": 7.0,
                              "Plan Rows": 200,
                              "Plan Width": 4,
                              "parent": 5,
                              "ID": 23
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6,
                          "right": 23
                        },
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "reason",
                          "Alias": "reason",
                          "Startup Cost": 0.0,
                          "Total Cost": 1.45,
                          "Plan Rows": 45,
                          "Plan Width": 105,
                          "parent": 4,
                          "ID": 24
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5,
                      "right": 24
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.7291808261653692,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Nested Loop",
          "Sort",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.021038917878627328
        ],
        "Hash Join": [
          0.00013754039230334813
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer.c_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.009684455814752272,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.007352854254732239,
          0.010467220305521231
        ],
        "Hash Join": [
          0.0021402448383944653
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer.c_current_addr_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer.c_current_cdemo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.003246202994750034,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0010988825096416013
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_address.ca_address_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [],
      "physical_operator": {}
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_address.ca_state",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.008058941809767736,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.03101200000000004
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_purchase_estimate",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[  500.           500.           500.          1000.\n  1000.          1450.00000001  1500.          1500.\n  2000.          2000.          2400.00000002  2500.\n  2500.          3000.          3000.          3349.99999998\n  3500.          3500.          4000.          4000.\n  4300.00000005  4500.          4500.          5000.\n  5000.          5250.          5500.          5500.\n  6000.          6000.          6199.99999995  6500.\n  6500.          7000.          7000.          7149.99999991\n  7500.          7500.          8000.          8000.\n  8100.00000009  8500.          8500.          9000.\n  9000.          9050.00000005  9500.          9500.\n 10000.         10000.         10000.        ]"
        ],
        "Aggregate": [
          "[  500.           500.           500.          1000.\n  1000.          1450.00000001  1500.          1500.\n  2000.          2000.          2400.00000002  2500.\n  2500.          3000.          3000.          3349.99999998\n  3500.          3500.          4000.          4000.\n  4300.00000005  4500.          4500.          5000.\n  5000.          5250.          5500.          5500.\n  6000.          6000.          6199.99999995  6500.\n  6500.          7000.          7000.          7149.99999991\n  7500.          7500.          8000.          8000.\n  8100.00000009  8500.          8500.          9000.\n  9000.          9050.00000005  9500.          9500.\n 10000.         10000.         10000.        ]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_demo_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.003246202994750034,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0010988825096416013
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_gender",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_marital_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_education_status",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "customer_demographics.cd_credit_rating",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "order-by"
      ],
      "physical_operator": {
        "Sort": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ],
        "Aggregate": [
          "[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0. 0.]"
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "date_dim.d_year",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.008466406918503713,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0007392298320305635,
          0.0007392298320305635,
          0.0012457391613848179
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "date_dim.d_moy",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.008466406918503713,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "selection"
      ],
      "physical_operator": {
        "Seq Scan": [
          0.0007392298320305635,
          0.0007392298320305635,
          0.0012457391613848179
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "date_dim.d_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.009706477306260553,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00469210045035693,
          0.004802431776525597,
          0.0036894726553894776
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "date_dim.d_date",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.009706477306260553,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00469210045035693,
          0.004802431776525597,
          0.0036894726553894776
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "catalog_sales.cs_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0032377841619526245,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0036894726553894776
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "catalog_sales.cs_ship_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0032258789992588672,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.007352854254732239
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "store_sales.ss_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0032345258480978756,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.00469210045035693
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "store_sales.ss_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.003242818802410045,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.0021402448383944653
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "web_sales.ws_sold_date_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.003234167296210054,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Hash Join": [
          0.004802431776525597
        ]
      }
    }
  },
  {
    "query": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('WI','NE','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2003 and\n                d_moy between 4 and 4+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2003 and\n                  d_moy between 4 and 4+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;\n\n-- end query 51 in stream 1 using template query69.tpl\n",
    "indexes": "web_sales.ws_bill_customer_sk",
    "wo plan est": {
      "Node Type": "Limit",
      "Parallel Aware": false,
      "Async Capable": false,
      "Startup Cost": 747713.69,
      "Total Cost": 825706.62,
      "Plan Rows": 100,
      "Plan Width": 64,
      "Plans": [
        {
          "Node Type": "Aggregate",
          "Strategy": "Sorted",
          "Partial Mode": "Simple",
          "Parent Relationship": "Outer",
          "Parallel Aware": false,
          "Async Capable": false,
          "Startup Cost": 747713.69,
          "Total Cost": 2483056.39,
          "Plan Rows": 2225,
          "Plan Width": 64,
          "Group Key": [
            "customer_demographics.cd_gender",
            "customer_demographics.cd_marital_status",
            "customer_demographics.cd_education_status",
            "customer_demographics.cd_purchase_estimate",
            "customer_demographics.cd_credit_rating"
          ],
          "Plans": [
            {
              "Node Type": "Nested Loop",
              "Parent Relationship": "Outer",
              "Parallel Aware": false,
              "Async Capable": false,
              "Join Type": "Anti",
              "Startup Cost": 747713.69,
              "Total Cost": 2483000.76,
              "Plan Rows": 2225,
              "Plan Width": 40,
              "Inner Unique": false,
              "Join Filter": "(c.c_customer_sk = catalog_sales.cs_ship_customer_sk)",
              "Plans": [
                {
                  "Node Type": "Nested Loop",
                  "Parent Relationship": "Outer",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Join Type": "Anti",
                  "Startup Cost": 745029.2,
                  "Total Cost": 1291074.35,
                  "Plan Rows": 2307,
                  "Plan Width": 44,
                  "Inner Unique": false,
                  "Join Filter": "(c.c_customer_sk = web_sales.ws_bill_customer_sk)",
                  "Plans": [
                    {
                      "Node Type": "Gather Merge",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 741871.55,
                      "Total Cost": 742145.13,
                      "Plan Rows": 2349,
                      "Plan Width": 44,
                      "Workers Planned": 2,
                      "Plans": [
                        {
                          "Node Type": "Sort",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 740871.53,
                          "Total Cost": 740873.97,
                          "Plan Rows": 979,
                          "Plan Width": 44,
                          "Sort Key": [
                            "customer_demographics.cd_gender",
                            "customer_demographics.cd_marital_status",
                            "customer_demographics.cd_education_status",
                            "customer_demographics.cd_purchase_estimate",
                            "customer_demographics.cd_credit_rating"
                          ],
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 707986.23,
                              "Total Cost": 740822.89,
                              "Plan Rows": 979,
                              "Plan Width": 44,
                              "Inner Unique": false,
                              "Hash Cond": "(customer_demographics.cd_demo_sk = c.c_current_cdemo_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "customer_demographics",
                                  "Alias": "customer_demographics",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 29831.33,
                                  "Plan Rows": 800333,
                                  "Plan Width": 44,
                                  "parent": 6,
                                  "ID": 7
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 707973.57,
                                  "Total Cost": 707973.57,
                                  "Plan Rows": 1013,
                                  "Plan Width": 8,
                                  "Plans": [
                                    {
                                      "Node Type": "Hash Join",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Join Type": "Inner",
                                      "Startup Cost": 691301.61,
                                      "Total Cost": 707973.57,
                                      "Plan Rows": 1013,
                                      "Plan Width": 8,
                                      "Inner Unique": false,
                                      "Hash Cond": "(c.c_current_addr_sk = ca.ca_address_sk)",
                                      "Plans": [
                                        {
                                          "Node Type": "Hash Join",
                                          "Parent Relationship": "Outer",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Join Type": "Semi",
                                          "Startup Cost": 684337.4,
                                          "Total Cost": 700954.09,
                                          "Plan Rows": 13615,
                                          "Plan Width": 12,
                                          "Inner Unique": false,
                                          "Hash Cond": "(c.c_customer_sk = store_sales.ss_customer_sk)",
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer",
                                              "Alias": "c",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 15918.33,
                                              "Plan Rows": 208333,
                                              "Plan Width": 12,
                                              "parent": 10,
                                              "ID": 11
                                            },
                                            {
                                              "Node Type": "Hash",
                                              "Parent Relationship": "Inner",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Startup Cost": 684159.07,
                                              "Total Cost": 684159.07,
                                              "Plan Rows": 14267,
                                              "Plan Width": 4,
                                              "Plans": [
                                                {
                                                  "Node Type": "Hash Join",
                                                  "Parent Relationship": "Outer",
                                                  "Parallel Aware": true,
                                                  "Async Capable": false,
                                                  "Join Type": "Inner",
                                                  "Startup Cost": 2157.65,
                                                  "Total Cost": 684159.07,
                                                  "Plan Rows": 14267,
                                                  "Plan Width": 4,
                                                  "Inner Unique": false,
                                                  "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                  "Plans": [
                                                    {
                                                      "Node Type": "Seq Scan",
                                                      "Parent Relationship": "Outer",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Relation Name": "store_sales",
                                                      "Alias": "store_sales",
                                                      "Startup Cost": 0.0,
                                                      "Total Cost": 636914.37,
                                                      "Plan Rows": 12000637,
                                                      "Plan Width": 8,
                                                      "parent": 13,
                                                      "ID": 14
                                                    },
                                                    {
                                                      "Node Type": "Hash",
                                                      "Parent Relationship": "Inner",
                                                      "Parallel Aware": true,
                                                      "Async Capable": false,
                                                      "Startup Cost": 2156.97,
                                                      "Total Cost": 2156.97,
                                                      "Plan Rows": 54,
                                                      "Plan Width": 4,
                                                      "Plans": [
                                                        {
                                                          "Node Type": "Seq Scan",
                                                          "Parent Relationship": "Outer",
                                                          "Parallel Aware": true,
                                                          "Async Capable": false,
                                                          "Relation Name": "date_dim",
                                                          "Alias": "date_dim",
                                                          "Startup Cost": 0.0,
                                                          "Total Cost": 2156.97,
                                                          "Plan Rows": 54,
                                                          "Plan Width": 4,
                                                          "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                                          "parent": 15,
                                                          "ID": 16
                                                        }
                                                      ],
                                                      "parent": 13,
                                                      "ID": 15,
                                                      "left": 16
                                                    }
                                                  ],
                                                  "parent": 12,
                                                  "ID": 13,
                                                  "left": 14,
                                                  "right": 15
                                                }
                                              ],
                                              "parent": 10,
                                              "ID": 12,
                                              "left": 13
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 10,
                                          "left": 11,
                                          "right": 12
                                        },
                                        {
                                          "Node Type": "Hash",
                                          "Parent Relationship": "Inner",
                                          "Parallel Aware": true,
                                          "Async Capable": false,
                                          "Startup Cost": 6867.29,
                                          "Total Cost": 6867.29,
                                          "Plan Rows": 7753,
                                          "Plan Width": 4,
                                          "Plans": [
                                            {
                                              "Node Type": "Seq Scan",
                                              "Parent Relationship": "Outer",
                                              "Parallel Aware": true,
                                              "Async Capable": false,
                                              "Relation Name": "customer_address",
                                              "Alias": "ca",
                                              "Startup Cost": 0.0,
                                              "Total Cost": 6867.29,
                                              "Plan Rows": 7753,
                                              "Plan Width": 4,
                                              "Filter": "(ca_state = ANY ('{WI,NE,SD}'::bpchar[]))",
                                              "parent": 17,
                                              "ID": 18
                                            }
                                          ],
                                          "parent": 9,
                                          "ID": 17,
                                          "left": 18
                                        }
                                      ],
                                      "parent": 8,
                                      "ID": 9,
                                      "left": 10,
                                      "right": 17
                                    }
                                  ],
                                  "parent": 6,
                                  "ID": 8,
                                  "left": 9
                                }
                              ],
                              "parent": 5,
                              "ID": 6,
                              "left": 7,
                              "right": 8
                            }
                          ],
                          "parent": 4,
                          "ID": 5,
                          "left": 6
                        }
                      ],
                      "parent": 3,
                      "ID": 4,
                      "left": 5
                    },
                    {
                      "Node Type": "Materialize",
                      "Parent Relationship": "Inner",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Startup Cost": 3157.65,
                      "Total Cost": 233105.09,
                      "Plan Rows": 8964,
                      "Plan Width": 4,
                      "Plans": [
                        {
                          "Node Type": "Gather",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 3157.65,
                          "Total Cost": 233060.27,
                          "Plan Rows": 8964,
                          "Plan Width": 4,
                          "Workers Planned": 2,
                          "Single Copy": false,
                          "Plans": [
                            {
                              "Node Type": "Hash Join",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": true,
                              "Async Capable": false,
                              "Join Type": "Inner",
                              "Startup Cost": 2157.65,
                              "Total Cost": 231163.87,
                              "Plan Rows": 3735,
                              "Plan Width": 4,
                              "Inner Unique": false,
                              "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                              "Plans": [
                                {
                                  "Node Type": "Seq Scan",
                                  "Parent Relationship": "Outer",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Relation Name": "web_sales",
                                  "Alias": "web_sales",
                                  "Startup Cost": 0.0,
                                  "Total Cost": 217737.86,
                                  "Plan Rows": 2998986,
                                  "Plan Width": 8,
                                  "parent": 21,
                                  "ID": 22
                                },
                                {
                                  "Node Type": "Hash",
                                  "Parent Relationship": "Inner",
                                  "Parallel Aware": true,
                                  "Async Capable": false,
                                  "Startup Cost": 2156.97,
                                  "Total Cost": 2156.97,
                                  "Plan Rows": 54,
                                  "Plan Width": 4,
                                  "Plans": [
                                    {
                                      "Node Type": "Seq Scan",
                                      "Parent Relationship": "Outer",
                                      "Parallel Aware": true,
                                      "Async Capable": false,
                                      "Relation Name": "date_dim",
                                      "Alias": "date_dim_1",
                                      "Startup Cost": 0.0,
                                      "Total Cost": 2156.97,
                                      "Plan Rows": 54,
                                      "Plan Width": 4,
                                      "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                                      "parent": 23,
                                      "ID": 24
                                    }
                                  ],
                                  "parent": 21,
                                  "ID": 23,
                                  "left": 24
                                }
                              ],
                              "parent": 20,
                              "ID": 21,
                              "left": 22,
                              "right": 23
                            }
                          ],
                          "parent": 19,
                          "ID": 20,
                          "left": 21
                        }
                      ],
                      "parent": 3,
                      "ID": 19,
                      "left": 20
                    }
                  ],
                  "parent": 2,
                  "ID": 3,
                  "left": 4,
                  "right": 19
                },
                {
                  "Node Type": "Materialize",
                  "Parent Relationship": "Inner",
                  "Parallel Aware": false,
                  "Async Capable": false,
                  "Startup Cost": 2684.49,
                  "Total Cost": 574652.42,
                  "Plan Rows": 17839,
                  "Plan Width": 4,
                  "Plans": [
                    {
                      "Node Type": "Hash Join",
                      "Parent Relationship": "Outer",
                      "Parallel Aware": false,
                      "Async Capable": false,
                      "Join Type": "Inner",
                      "Startup Cost": 2684.49,
                      "Total Cost": 574563.22,
                      "Plan Rows": 17839,
                      "Plan Width": 4,
                      "Inner Unique": false,
                      "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)",
                      "Plans": [
                        {
                          "Node Type": "Seq Scan",
                          "Parent Relationship": "Outer",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Relation Name": "catalog_sales",
                          "Alias": "catalog_sales",
                          "Startup Cost": 0.0,
                          "Total Cost": 517695.61,
                          "Plan Rows": 14401261,
                          "Plan Width": 8,
                          "parent": 26,
                          "ID": 27
                        },
                        {
                          "Node Type": "Hash",
                          "Parent Relationship": "Inner",
                          "Parallel Aware": false,
                          "Async Capable": false,
                          "Startup Cost": 2683.36,
                          "Total Cost": 2683.36,
                          "Plan Rows": 91,
                          "Plan Width": 4,
                          "Plans": [
                            {
                              "Node Type": "Seq Scan",
                              "Parent Relationship": "Outer",
                              "Parallel Aware": false,
                              "Async Capable": false,
                              "Relation Name": "date_dim",
                              "Alias": "date_dim_2",
                              "Startup Cost": 0.0,
                              "Total Cost": 2683.36,
                              "Plan Rows": 91,
                              "Plan Width": 4,
                              "Filter": "((d_moy >= 4) AND (d_moy <= 6) AND (d_year = 2003))",
                              "parent": 28,
                              "ID": 29
                            }
                          ],
                          "parent": 26,
                          "ID": 28,
                          "left": 29
                        }
                      ],
                      "parent": 25,
                      "ID": 26,
                      "left": 27,
                      "right": 28
                    }
                  ],
                  "parent": 2,
                  "ID": 25,
                  "left": 26
                }
              ],
              "parent": 1,
              "ID": 2,
              "left": 3,
              "right": 25
            }
          ],
          "parent": 0,
          "ID": 1,
          "left": 2
        }
      ],
      "parent": null,
      "ID": 0,
      "left": 1
    },
    "feat": {
      "utility": 0.0032157580130833595,
      "query_shape": [
        [
          "Seq Scan",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Hash",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Sort",
          "Gather Merge",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Gather",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ],
        [
          "Seq Scan",
          "Hash",
          "Hash Join",
          "Materialize",
          "Nested Loop",
          "Aggregate"
        ]
      ],
      "index_shape": [
        "join"
      ],
      "physical_operator": {
        "Nested Loop": [
          0.010467220305521231
        ]
      }
    }
  }
]