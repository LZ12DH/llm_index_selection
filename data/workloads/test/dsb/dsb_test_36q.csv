Query_id,Query_text
0,"with cs_ui as (select cs_item_sk  ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number and cs_wholesale_cost BETWEEN 80 AND 100 group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM store_sales  ,store_returns  ,cs_ui  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,customer  ,customer_demographics cd1  ,customer_demographics cd2  ,promotion  ,household_demographics hd1  ,household_demographics hd2  ,customer_address ad1  ,customer_address ad2  ,income_band ib1  ,income_band ib2  ,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_current_price between 50 and 50 + 10 and p_channel_email = 'N' and p_channel_tv = 'N' and p_channel_radio = 'N' and ad2.ca_state in ('MN','OK','WV') and ss_wholesale_cost BETWEEN 80 AND 100 and cd1.cd_marital_status in ('M', 'M', 'M') and cd1.cd_education_status in ('2 yr Degree', 'Unknown', 'Advanced Degree') and cd2.cd_marital_status in ('M', 'M', 'M') and cd2.cd_education_status in ('2 yr Degree', 'Unknown', 'Advanced Degree') group by i_product_name  ,i_item_sk  ,s_store_name  ,s_zip  ,ad1.ca_street_number  ,ad1.ca_street_name  ,ad1.ca_city  ,ad1.ca_zip  ,ad2.ca_street_number  ,ad2.ca_street_name  ,ad2.ca_city  ,ad2.ca_zip  ,d1.d_year  ,d2.d_year  ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name  ,cs1.store_name  ,cs2.cnt  ,cs1.s1  ,cs2.s1  ;"
1,"with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address, item where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk and ss_item_sk = i_item_sk and i_color IN ('peru', 'violet') and i_manager_id BETWEEN 51 and 70 and ss_list_price between 55 and 69 and ca_state in ('AL','MI') group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address, item where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk and ws_item_sk = i_item_sk and i_color IN ('peru', 'violet') and i_manager_id BETWEEN 51 and 70 and ws_list_price between 55 and 69 and ca_state in ('AL','MI') group by ca_county,d_qoy, d_year) select  ss1.ca_county  ,ss1.d_year  ,ws2.web_sales/ws1.web_sales web_q1_q2_increase  ,ss2.store_sales/ss1.store_sales store_q1_q2_increase  ,ws3.web_sales/ws2.web_sales web_q2_q3_increase  ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from  ss ss1  ,ss ss2  ,ss ss3  ,ws ws1  ,ws ws2  ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end  > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end  > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year ;"
2,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and  (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and  (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1194 and 1194 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 167 and 196 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100 ;"
3,"select i_item_id,  ca_country,  ca_state,  ca_county,  avg( cast(cs_quantity as decimal(12,2))) agg1,  avg( cast(cs_list_price as decimal(12,2))) agg2,  avg( cast(cs_coupon_amt as decimal(12,2))) agg3,  avg( cast(cs_sales_price as decimal(12,2))) agg4,  avg( cast(cs_net_profit as decimal(12,2))) agg5,  avg( cast(c_birth_year as decimal(12,2))) agg6 from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Primary' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 9 and ca_state in ('AR', 'IL', 'KS') and cs_wholesale_cost BETWEEN 24 AND 29 AND i_category = 'Children' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country,  ca_state,  ca_county, i_item_id limit 100 ;"
4,"with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 2000 and i_manager_id BETWEEN 81 and 100 AND i_category IN ('Books', 'Children', 'Sports') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales  from store_sales  ,customer  ,date_dim  where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and ss_wholesale_cost BETWEEN 39 AND 49  group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1970 AND 1976 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales  from catalog_sales  ,date_dim  where d_year = 2000 and d_moy = 2 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 39 AND 49 union all select ws_quantity*ws_list_price sales  from web_sales  ,date_dim  where d_year = 2000 and d_moy = 2 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 39 AND 49) tmp2 limit 100 ;"
5,"select min(ws_quantity)  ,min(wr_refunded_cash)  ,min(wr_fee)  ,min(ws_item_sk)  ,min(wr_order_number)  ,min(cd1.cd_demo_sk) ,min(cd2.cd_demo_sk) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2002 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC', 'NE', 'SD') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('AL', 'AR', 'NH') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('AL', 'MO', 'NE') and ws_net_profit between 50 and 250 ) )  ;"
6,"with wss as (select d_week_seq,  ss_store_sk,  sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,  sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,  sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,  sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,  sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,  sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,  sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk and ss_sales_price / ss_list_price BETWEEN 80 * 0.01 AND 100 * 0.01 group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1  ,sun_sales1/sun_sales2,mon_sales1/mon_sales2  ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2  ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1  ,s_store_id s_store_id1,sun_sales sun_sales1  ,mon_sales mon_sales1,tue_sales tue_sales1  ,wed_sales wed_sales1,thu_sales thu_sales1  ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191 and 1191 + 11  and s_state in ('AL','MA','MO'   ,'MS','NC','NE','OH','VA')  ) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2  ,s_store_id s_store_id2,sun_sales sun_sales2  ,mon_sales mon_sales2,tue_sales tue_sales2  ,wed_sales wed_sales2,thu_sales thu_sales2  ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and  ss_store_sk = s_store_sk and  d_month_seq between 1191+ 12 and 1191 + 23  and s_state in ('AL','MA','MO'   ,'MS','NC','NE','OH','VA')) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100 ;"
7,"select i_item_id,  s_state, grouping(s_state) g_state,  avg(ss_quantity) agg1,  avg(ss_list_price) agg2,  avg(ss_coupon_amt) agg3,  avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'S' and cd_education_status = '2 yr Degree' and d_year = 1999 and s_state = 'KS' and i_category = 'Shoes' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
8,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IN','KS','SD') and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('W', 'U', 'W') and cd_education_status in ('2 yr Degree', '4 yr Degree') and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ss_list_price between 153 and 242 ) and (not exists (select *  from web_sales,date_dim  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and ws_list_price between 153 and 242  ) and not exists (select *  from catalog_sales,date_dim  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 2001 and  d_moy between 10 and 10+2  and cs_list_price between 153 and 242)  ) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100 ;"
9,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk  ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state = 'NY'  and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset  ,ca_location_type,ctr_total_return limit 100 ;"
10,"select cc_call_center_id Call_Center,  cc_name Call_Center_Name,  cc_manager Manager,  sum(cr_net_loss) Returns_Loss from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 1999 and d_moy  = 1 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '501-1000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ;"
11,"select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 2000  ;"
12,"select c_customer_id as customer_id  , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Oakdale' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 43147 and ib_upper_bound <= 43147 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100 ;"
13,"select min(item1.i_item_sk), min(item2.i_item_sk), min(s1.ss_ticket_number), min(s1.ss_item_sk) FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 30 and 49 and cd_marital_status = 'S' and cd_education_status = 'Unknown' and s1.ss_list_price between 206 and 220 and s2.ss_list_price between 206 and 220  ;"
14,"select min(ss_quantity)  ,min(ss_ext_sales_price)  ,min(ss_ext_wholesale_cost)  ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'NE', 'NY') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'KY', 'MO') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CA', 'OK', 'WI') and ss_net_profit between 50 and 250 ))  ;"
15,"select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Cumberland County','Lee County','Logan County','Stokes County','Wabash County') and c.c_birth_month in (5, 6) and cd_demo_sk = c.c_current_cdemo_sk and cd_marital_status in ('M', 'S', 'W') and cd_education_status in ('4 yr Degree', 'Advanced Degree', 'Unknown') and cd_gender = 'F' and exists (select * from store_sales,date_dim, item where c.c_customer_sk = ss_customer_sk and  ss_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  ss_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and ss_sales_price / ss_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  and i_manager_id BETWEEN 78 and 87  ) and (exists (select *  from web_sales,date_dim, item  where c.c_customer_sk = ws_bill_customer_sk and  ws_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 ANd 3+3 and  ws_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 78 and 87  and ws_sales_price / ws_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  ) or exists (select *  from catalog_sales,date_dim, item  where c.c_customer_sk = cs_ship_customer_sk and  cs_sold_date_sk = d_date_sk and  d_year = 1998 and  d_moy between 3 and 3+3 and  cs_item_sk = i_item_sk and  i_category in ('Books', 'Home', 'Shoes')  and i_manager_id BETWEEN 78 and 87  and cs_sales_price / cs_list_price BETWEEN 71 * 0.01 AND 81 * 0.01  )) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100 ;"
16,"select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_net_profit) as store_sales_profit ,stddev_samp(sr_net_loss) as store_returns_loss ,stddev_samp(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 7 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy  between 7 and 7 + 2 and d2.d_year  = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy  between 7 and 7 + 2 and d3.d_year  = 1998 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100 ;"
17,"with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sr_reason_sk as ctr_reason_sk ,sum(SR_RETURN_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 and sr_return_amt / sr_return_quantity between 11 and 70 group by sr_customer_sk ,sr_store_sk, sr_reason_sk) select c_customer_id from customer_total_return ctr1 ,store ,customer ,customer_demographics where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk ) and ctr1.ctr_reason_sk BETWEEN 64 AND 67 and s_store_sk = ctr1.ctr_store_sk and s_state IN ('NC', 'NJ', 'WV') and ctr1.ctr_customer_sk = c_customer_sk and c_current_cdemo_sk = cd_demo_sk and cd_marital_status IN ('W', 'W') and cd_education_status IN ('4 yr Degree', '2 yr Degree') and cd_gender = 'M' and c_birth_month = 7 and c_birth_year BETWEEN 1962 AND 1968 order by c_customer_id limit 100 ;"
18,"with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state ,wr_reason_sk as ctr_reason_sk ,sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address ,item where wr_returned_date_sk = d_date_sk and d_year =1998 and wr_returning_addr_sk = ca_address_sk and wr_item_sk = i_item_sk and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 136 and 165 group by wr_returning_customer_sk ,ca_state, wr_reason_sk) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2  where ctr1.ctr_state = ctr2.ctr_state)  and ca_address_sk = c_current_addr_sk  and ca_state in ('AL', 'IL', 'KS', 'MO')  and ctr1.ctr_customer_sk = c_customer_sk  and ctr1.ctr_reason_sk in (7, 64) and c_birth_year BETWEEN 1987 AND 1993 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address  ,c_last_review_date_sk,ctr_total_return limit 100 ;"
19,"select min(i_item_id),  min(s_state),  min(ss_quantity),  min(ss_list_price),  min(ss_coupon_amt),  min(ss_sales_price),  min(ss_item_sk),  min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and  ss_item_sk = i_item_sk and  ss_store_sk = s_store_sk and  ss_cdemo_sk = cd_demo_sk and  cd_gender = 'M' and  cd_marital_status = 'S' and  cd_education_status = '4 yr Degree' and  d_year = 1999 and  s_state = 'MO' and i_category = 'Children'  ;"
20,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('FL', 'PA', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'VA', 'WY') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'HI', 'ID') and ss_net_profit between 50 and 250 ))  ;"
21,"select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1212 and 1212 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 136 and 165 and sm_type = 'EXPRESS' and cc_class = 'small' and w_gmt_offset = -5  ;"
22,"select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Jewelry' and d_year=2002 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'AR' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 51 AND 71  ;"
23,"select item1.i_item_sk, item2.i_item_sk, count(*) as cnt FROM item AS item1, item AS item2, store_sales AS s1, store_sales AS s2, date_dim, customer, customer_address, customer_demographics WHERE item1.i_item_sk < item2.i_item_sk AND s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk AND s1.ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and c_current_cdemo_sk = cd_demo_sk AND d_year between 1998 and 1998 + 1 and d_date_sk = s1.ss_sold_date_sk and item1.i_category in ('Books', 'Home') and item2.i_manager_id between 47 and 66 and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and s1.ss_list_price between 97 and 111 and s2.ss_list_price between 97 and 111 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt  ;"
24,"with sr_items as (select i_item_id item_id,  sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and sr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and sr_return_amt / sr_return_quantity between 258 and 287 and sr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id), cr_items as (select i_item_id item_id,  sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and cr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and cr_return_amount / cr_return_quantity between 258 and 287 and cr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id), wr_items as (select i_item_id item_id,  sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_month_seq in (select d_month_seq from date_dim  where d_date in ('2001-03-11','2001-04-28','2001-09-20','2001-10-21'))) and wr_returned_date_sk = d_date_sk and i_category IN ('Home', 'Jewelry') and i_manager_id BETWEEN 91 and 100 and wr_return_amt / wr_return_quantity between 258 and 287 and wr_reason_sk in (9, 16, 18, 21, 53) group by i_item_id) select sr_items.item_id  ,sr_item_qty  ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev  ,cr_item_qty  ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev  ,wr_item_qty  ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev  ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100 ;"
25,"select count(*) from ((select distinct c_last_name, c_first_name, d_date  from store_sales, date_dim, customer  where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and ss_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and ss_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from catalog_sales, date_dim, customer  where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and cs_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and cs_wholesale_cost BETWEEN 61 AND 71 )  except (select distinct c_last_name, c_first_name, d_date  from web_sales, date_dim, customer  where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1201 and 1201+11 and ws_list_price between 185 and 214 and c_birth_year BETWEEN 1980 AND 1986 and ws_wholesale_cost BETWEEN 61 AND 71 ) ) cool_cust  ;"
26,"select min(c_customer_id), min(sr_ticket_number), min(sr_item_sk) from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city  = 'Unionville' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 1 * 10000 and ib_upper_bound <= 1 * 10000 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk  ;"
27,"with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and ws_wholesale_cost BETWEEN 80 AND 100 and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity  ,ss_list_price list_price  from store_sales  ,date_dim  where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and ss_wholesale_cost BETWEEN 80 AND 100  union all  select cs_quantity quantity  ,cs_list_price list_price  from catalog_sales  ,date_dim  where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 and cs_wholesale_cost BETWEEN 80 AND 100  union all  select ws_quantity quantity  ,ws_list_price list_price  from web_sales  ,date_dim  where ws_sold_date_sk = d_date_sk  and ws_wholesale_cost BETWEEN 80 AND 100 and d_year between 1999 and 1999 + 2) x) select this_year.channel ty_channel   ,this_year.i_brand_id ty_brand   ,this_year.i_class_id ty_class   ,this_year.i_category_id ty_category   ,this_year.sales ty_sales   ,this_year.number_sales ty_number_sales   ,last_year.channel ly_channel   ,last_year.i_brand_id ly_brand   ,last_year.i_class_id ly_class   ,last_year.i_category_id ly_category   ,last_year.sales ly_sales   ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id  ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999 + 1   and d_moy = 12   and d_dom = 5) and i_category IN ('Books', 'Music', 'Shoes') and i_manager_id BETWEEN 46 and 55 and ss_wholesale_cost BETWEEN 80 AND 100 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id  ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq  from date_dim  where d_year = 1999   and d_moy = 12   and d_dom = 5) and i_category IN ('Books', 'Music', 'Shoes') and ss_wholesale_cost BETWEEN 80 AND 100 and i_manager_id BETWEEN 46 and 55 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100 ;"
28,"select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from  (select ss_store_sk, ss_item_sk,  sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1194 and 1194+11 and ss_sales_price / ss_list_price BETWEEN 87 * 0.01 AND 97 * 0.01 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and  sc.revenue <= 0.1 * sb.ave and  s_store_sk = sc.ss_store_sk and  i_item_sk = sc.ss_item_sk  and i_manager_id BETWEEN 67 and 71  and s_state in ('AL','OK','WV') order by s_store_name, i_item_desc limit 100 ;"
29,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2000 and d_moy = 7 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'TX' and c_birth_month = 2 and ss_wholesale_cost BETWEEN 56 AND 76 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100  ;"
30,"select substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2000 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Unknown' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'W' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NE', 'PA', 'VT') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('GA', 'KY', 'TN') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('KY', 'NE', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substring(r_reason_desc,1,20)  ,avg(ws_quantity)  ,avg(wr_refunded_cash)  ,avg(wr_fee) limit 100 ;"
31,"with my_customers as ( select distinct c_customer_sk  , c_current_addr_sk from  ( select cs_sold_date_sk sold_date_sk,  cs_bill_customer_sk customer_sk,  cs_item_sk item_sk,  cs_wholesale_cost wholesale_cost from catalog_sales union all select ws_sold_date_sk sold_date_sk,  ws_bill_customer_sk customer_sk,  ws_item_sk item_sk,  ws_wholesale_cost wholesale_cost from web_sales ) cs_or_ws_sales, item, date_dim, customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Women' and i_class = 'fragrances' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2000 and wholesale_cost BETWEEN 18 AND 48 and c_birth_year BETWEEN 1937 AND 1950 ) , my_revenue as ( select c_customer_sk,  sum(ss_ext_sales_price) as revenue from my_customers,  store_sales,  customer_address,  store,  date_dim where c_current_addr_sk = ca_address_sk  and ca_county = s_county  and ca_state = s_state  and ss_sold_date_sk = d_date_sk  and c_customer_sk = ss_customer_sk  and ss_wholesale_cost BETWEEN 18 AND 48  and s_state in ('CA','IL','KS'   ,'KY','MN','MS'   ,'MT','OH','SD'   ,'VA')  and d_month_seq between (select distinct d_month_seq+1   from date_dim where d_year = 2000 and d_moy = 2)   and (select distinct d_month_seq+3   from date_dim where d_year = 2000 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100 ;"
32,"select min(i_item_id),  min(ca_country),  min(ca_state),  min(ca_county),  min(cs_quantity),  min(cs_list_price),  min(cs_coupon_amt),  min(cs_sales_price),  min(cs_net_profit),  min(c_birth_year),  min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and  cs_item_sk = i_item_sk and  cs_bill_cdemo_sk = cd_demo_sk and  cs_bill_customer_sk = c_customer_sk and  cd_gender = 'F' and  cd_education_status = '4 yr Degree' and  c_current_addr_sk = ca_address_sk and  d_year = 1999 and  c_birth_month = 9 and  ca_state in ('MO', 'NJ', 'NY')  and cs_wholesale_cost BETWEEN 5 AND 10  AND i_category = 'Shoes'  ;"
33,"with ss_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim ,customer where ss_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and ss_sold_date_sk = d_date_sk and ss_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), cs_items as (select i_item_id item_id  ,c_birth_year birth_year  ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim ,customer where cs_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and cs_sold_date_sk = d_date_sk and cs_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and cs_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year), ws_items as (select i_item_id item_id ,c_birth_year birth_year  ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim ,customer where ws_item_sk = i_item_sk and d_date in (select d_date  from date_dim  where d_month_seq = (select d_month_seq    from date_dim    where d_date = '2000-02-04')) and ws_sold_date_sk = d_date_sk and ws_list_price between 141 and 170 and i_manager_id BETWEEN 20 and 49 and ws_bill_customer_sk = c_customer_sk and c_birth_year BETWEEN 1972 AND 1978 group by i_item_id, c_birth_year) select ss_items.item_id, ss_items.birth_year  ,ss_item_rev  ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev  ,cs_item_rev  ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev  ,ws_item_rev  ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev  ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_items.birth_year = cs_items.birth_year and ss_items.birth_year = ws_items.birth_year and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id, birth_year ,ss_item_rev limit 100 ;"
34,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and ss_list_price between 29 and 88 and ss_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and cs_list_price between 29 and 88 and cs_wholesale_cost BETWEEN 80 AND 100 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1212 and 1212 + 11 and c_birth_month in (5, 6, 9, 11) and ws_list_price between 29 and 88 and ws_wholesale_cost BETWEEN 80 AND 100 ) hot_cust limit 100 ;"
35,"select min(cc_call_center_id),  min(cc_name),  min(cc_manager),  min(cr_net_loss),  min(cr_item_sk),  min(cr_order_number) from  call_center,  catalog_returns,  date_dim,  customer,  customer_address,  customer_demographics,  household_demographics where  cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk  = c_current_cdemo_sk and hd_demo_sk  = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year  = 2001 and d_moy  = 10 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')  or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -6  ;"
